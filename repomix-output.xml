This file is a merged representation of the entire client side codebase in the folder Client which is in the root folder, it excludes the assets folder, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
public/
  vite.svg
src/
  assets/
    gamesImg/
      1.svg
      2.svg
      3.svg
      4.svg
      5.svg
      a1.svg
      a2.svg
      a3.svg
      a4.svg
      a5.svg
      a6.svg
      war.svg
    bolt.svg
    click.svg
    fetch-upload.svg
    icn_hand.svg
    iFrame.svg
    moon.svg
    profile.svg
    profileModal-Img.svg
    react.svg
    session-icon.svg
    stat-img.svg
    sun.svg
    users-line.svg
    users.svg
  backend/
    __tests__/
      games.service.test.ts
    analytics.service.ts
    api.service.ts
    auth.service.ts
    category.service.ts
    configuration.service.ts
    constants.ts
    games.service.ts
    main.ts
    signup.analytics.service.ts
    teams.service.ts
    types.ts
    user.service.ts
  components/
    __tests__/
      AllGamesSection.logic.test.ts
      FormValidation.logic.test.ts
    charts/
      barChart II.tsx
      barChart.tsx
      donutChart.tsx
      LineChart.tsx
      piechart.tsx
    modals/
      AdminModals/
        AcceptInvitationModal.tsx
        ActivityLogExportModal.tsx
        CreateNewPassModal.tsx
        ExportModal.tsx
        LoginModal.tsx
        OTPModal.tsx
        ResetPasswordModal.tsx
      AdminKeepPlayingModal.tsx
      DeleteConfirmationModal.tsx
      ForgotPasswordModal.tsx
      KeepPlayingModal.tsx
      LoginModal.tsx
      OTPPlatformModal.tsx
      OTPVerificationModal.tsx
      ProfileModal.tsx
      ResetPasswordOTPModal.tsx
      SignUpModal.tsx
      StatsModal.tsx
      ToggleGameStatusModal.tsx
      WelcomeModal.tsx
    single/
      AdminNavbar.tsx
      AllGamesSection.tsx
      ChangePassword-Sheet.tsx
      CreateCategory-Sheet.tsx
      CreateGame-Sheet.tsx
      Edit-Sheet.tsx
      EditCategory-Sheet.tsx
      EditProfile-Sheet.tsx
      Filter-Sheet.tsx
      GameCreationProgress.tsx
      GameLoadingScreen.tsx
      GamesSkeleton.tsx
      Invite-Sheet.tsx
      Navbar.tsx
      NoResults.tsx
      PopularSection.tsx
      PopUp-Sheet.tsx
      Terms-Sheet.tsx
      UserMgtFilter-Sheet.tsx
    ui/
      alert-dialog.tsx
      alert.tsx
      aspect-ratio.tsx
      avatar.tsx
      badge.tsx
      breadcrumb.tsx
      button.tsx
      calendar.tsx
      card.tsx
      carousel.tsx
      chart.tsx
      checkbox.tsx
      collapsible.tsx
      command.tsx
      country-dropdown.tsx
      custom-dialog-content.tsx
      dialog.tsx
      dropdown-menu.tsx
      form.tsx
      input.tsx
      label.tsx
      pagination.tsx
      popover.tsx
      progress.tsx
      radio-group.tsx
      resizable.tsx
      scroll-area.tsx
      select.tsx
      separator.tsx
      sheet.tsx
      skeleton.tsx
      slider.tsx
      sonner.tsx
      switch.tsx
      table.tsx
      tabs.tsx
      textarea.tsx
      toggle-group.tsx
      toggle.tsx
      tooltip.tsx
  context/
    __tests__/
      AuthContext.logic.test.ts
    AuthContext.tsx
  hooks/
    useHeartbeat.ts
  layout/
    AdminLayout.tsx
    MainLayout.tsx
  lib/
    utils.ts
  pages/
    About/
      About.tsx
    Admin/
      About/
        About.tsx
      Analytics/
        Analytics.tsx
        GameActivity.tsx
        GameThumbnail.tsx
        UserActivityLog.tsx
      Category/
        GameCategories.tsx
      Configuration/
        Configuration.tsx
      Home/
        Home.tsx
        MostPlayedGames.tsx
        RecentUserActivity.tsx
        StatsCard.tsx
      Management/
        GameManagement.tsx
      Team/
        TeamManagement.tsx
      UserManagement/
        UserManagement.tsx
      Settings.tsx
      UserMgtView.tsx
      ViewGame.tsx
      ViewProfile.tsx
    Categories/
      Categories.tsx
    GamePlay/
      GamePlay.tsx
    Home/
      Home.tsx
    PrivacyPolicy/
      Privacy.tsx
    RegisterInvitation/
      index.ts
      RegisterForm.tsx
      RegisterInvitationPage.tsx
      ResetPasswordForm.tsx
    ResetPassword/
      ResetPasswordPage.tsx
    TermsOfService/
      Terms.tsx
    ErrorPage.tsx
  routing/
    __tests__/
      ProtectedRoute.logic.test.ts
    main.ts
    ProtectedRoute.tsx
    RequireAdminAuth.tsx
    routes.tsx
  store/
    index.ts
    slice.ts
  styles/
    phone-input.css
  test/
    setup.ts
  utils/
    __tests__/
      errorHandling.test.ts
      main.test.ts
    errorHandling.ts
    main.ts
    sessionUtils.ts
  validation/
    __tests__/
      password.test.ts
    password.ts
  App.css
  App.tsx
  index.css
  main.tsx
  vite-env.d.ts
.env.example
components.json
eslint.config.js
index.html
package.json
README.md
tsconfig.app.json
tsconfig.json
tsconfig.node.json
vite.config.ts
vitest.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>


<file path="src/backend/__tests__/games.service.test.ts">
import { describe, it, expect } from 'vitest'

describe('Games Service Business Logic', () => {
  describe('Game Status Toggle Logic', () => {
    it('should toggle active status to disabled', () => {
      const currentStatus: string = 'active'
      const newStatus = currentStatus === 'active' ? 'disabled' : 'active'

      expect(newStatus).toBe('disabled')
    })

    it('should toggle disabled status to active', () => {
      const currentStatus: string = 'disabled'
      const newStatus = currentStatus === 'active' ? 'disabled' : 'active'

      expect(newStatus).toBe('active')
    })

    it('should toggle inactive status to active', () => {
      const currentStatus: string = 'inactive'
      const newStatus = currentStatus === 'active' ? 'disabled' : 'active'

      expect(newStatus).toBe('active')
    })

    it('should handle various status values correctly', () => {
      const testCases = [
        { current: 'active', expected: 'disabled' },
        { current: 'disabled', expected: 'active' },
        { current: 'inactive', expected: 'active' },
        { current: 'pending', expected: 'active' },
        { current: 'draft', expected: 'active' }
      ]

      testCases.forEach(({ current, expected }) => {
        const newStatus = current === 'active' ? 'disabled' : 'active'
        expect(newStatus).toBe(expected)
      })
    })
  })

  describe('Game Query Parameters Logic', () => {
    it('should build correct query parameters for category filter', () => {
      const params = { categoryId: 'cat-1', status: 'active' as const }

      expect(params.categoryId).toBe('cat-1')
      expect(params.status).toBe('active')
    })

    it('should build correct query parameters for search', () => {
      const params = { search: 'puzzle', limit: 5 }

      expect(params.search).toBe('puzzle')
      expect(params.limit).toBe(5)
    })

    it('should build correct query parameters for popular filter', () => {
      const params = { filter: 'popular' as const }

      expect(params.filter).toBe('popular')
    })

    it('should handle multiple filter combinations', () => {
      const params = {
        categoryId: 'action',
        status: 'active' as const,
        filter: 'recommended' as const,
        search: 'adventure',
        limit: 20
      }

      expect(params.categoryId).toBe('action')
      expect(params.status).toBe('active')
      expect(params.filter).toBe('recommended')
      expect(params.search).toBe('adventure')
      expect(params.limit).toBe(20)
    })
  })

  describe('Game ID URL Building Logic', () => {
    it('should build correct game URL with ID replacement', () => {
      const gameId = 'game-123'
      const urlTemplate = '/api/games/:id'
      const gameUrl = urlTemplate.replace(':id', gameId)

      expect(gameUrl).toBe('/api/games/game-123')
    })

    it('should handle various game ID formats', () => {
      const testCases = [
        { id: 'game-123', expected: '/api/games/game-123' },
        { id: 'abc-def-456', expected: '/api/games/abc-def-456' },
        { id: '789', expected: '/api/games/789' },
        { id: 'test_game_1', expected: '/api/games/test_game_1' }
      ]

      const urlTemplate = '/api/games/:id'

      testCases.forEach(({ id, expected }) => {
        const gameUrl = urlTemplate.replace(':id', id)
        expect(gameUrl).toBe(expected)
      })
    })
  })

  describe('FormData Creation Logic', () => {
    it('should create FormData with status field', () => {
      const status = 'disabled'
      const formData = new FormData()
      formData.append('status', status)

      expect(formData.get('status')).toBe('disabled')
    })

    it('should handle different status values in FormData', () => {
      const statusValues = ['active', 'disabled', 'pending', 'draft']

      statusValues.forEach(status => {
        const formData = new FormData()
        formData.append('status', status)

        expect(formData.get('status')).toBe(status)
      })
    })
  })

  describe('Game Filter Logic', () => {
    it('should identify valid filter types', () => {
      const validFilters = ['popular', 'recommended', 'recently_added']

      validFilters.forEach(filter => {
        expect(['popular', 'recommended', 'recently_added']).toContain(filter)
      })
    })

    it('should identify valid status types', () => {
      const validStatuses = ['active', 'disabled', 'pending', 'draft']

      validStatuses.forEach(status => {
        expect(['active', 'disabled', 'pending', 'draft']).toContain(status)
      })
    })
  })
})
</file>

<file path="src/backend/analytics.service.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';

import type { Analytics, CreateAnalyticsData } from './types';

/**
 * Hook to fetch all analytics entries
 * @returns Query result with analytics data
 */
export const useAllAnalytics = () => {
  return useQuery<Analytics[]>({
    queryKey: [BackendRoute.ANALYTICS],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.ANALYTICS);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch analytics by ID
 * @param id - Analytics entry ID
 * @returns Query result with analytics data
 */
export const useAnalyticsById = (id: string) => {
  const url = BackendRoute.ANALYTICS_BY_ID.replace(':id', id);
  return useQuery<Analytics>({
    queryKey: [BackendRoute.ANALYTICS, id],
    queryFn: async () => {
      const response = await backendService.get(url);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to create a new analytics entry
 * @returns Mutation function to create analytics
 */
export const useCreateAnalytics = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (data: CreateAnalyticsData) => {
      const response = await backendService.post(BackendRoute.ANALYTICS, data);
      return response.data;
    },
    onSuccess: () => {
      // Invalidate all analytics-related queries
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ANALYTICS] });

      // Invalidate user stats
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER_STATS] });

      // Invalidate admin dashboard analytics
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_DASHBOARD] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USERS_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USER_ACTIVITY] });

      // Invalidate specific user and game analytics
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_USER_ANALYTICS],
        exact: false // Invalidate all user analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS],
        exact: false // Invalidate all game analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS_POPULARITY]
      });
    },
  });
};

/**
 * Hook to update an analytics entry
 * @returns Mutation function to update analytics
 */
export const useUpdateAnalytics = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async ({ id, ...data }: Partial<Analytics> & { id: string }) => {
      const url = BackendRoute.ANALYTICS_BY_ID.replace(':id', id);
      const response = await backendService.put(url, data);
      return response.data;
    },
    onSuccess: (_, variables) => {
      // Invalidate all analytics-related queries
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ANALYTICS, variables.id] });

      // Invalidate user stats
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER_STATS] });

      // Invalidate admin dashboard analytics
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_DASHBOARD] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USERS_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USER_ACTIVITY] });

      // Invalidate specific user and game analytics
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_USER_ANALYTICS],
        exact: false // Invalidate all user analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS],
        exact: false // Invalidate all game analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS_POPULARITY]
      });
    },
  });
};

/**
 * Hook to delete an analytics entry
 * @returns Mutation function to delete analytics
 */
export const useDeleteAnalytics = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (id: string) => {
      const url = BackendRoute.ANALYTICS_BY_ID.replace(':id', id);
      const response = await backendService.delete(url);
      return response.data;
    },
    onSuccess: () => {
      // Invalidate all analytics-related queries
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ANALYTICS] });

      // Invalidate user stats
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER_STATS] });

      // Invalidate admin dashboard analytics
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_DASHBOARD] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USERS_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USER_ACTIVITY] });

      // Invalidate specific user and game analytics
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_USER_ANALYTICS],
        exact: false // Invalidate all user analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS],
        exact: false // Invalidate all game analytics queries
      });
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS_POPULARITY]
      });
    },
  });
};

// Admin Dashboard Types
interface DashboardAnalytics {
  totalUsers: {
    current: string;
    percentageChange: number;
  };
  totalRegisteredUsers: {
    current: number;
    percentageChange: number;
  };
  activeUsers: number;
  inactiveUsers: number;
  adultsCount: number;
  minorsCount: number;
  totalGames: {
    current: number;
    percentageChange: number;
  };
  totalSessions: {
    current: number;
    percentageChange: number;
  };
  totalTimePlayed: {
    current: number;
    percentageChange: number;
  };
  mostPopularGame: {
    id: string;
    title: string;
    thumbnailUrl: string | null;
    sessionCount: number;
    percentageChange: number;
  } | null;
  avgSessionDuration: {
    current: number;
    percentageChange: number;
  };
  retentionRate: number;
}

export interface UserAnalytics {
  id: string;
  firstName: string;
  lastName: string;
  email: string;
  phoneNumber: string;
  country: string;
  isActive: boolean;
  isVerified: boolean;
  lastLoggedIn: string;
  createdAt: string;
  updatedAt: string;
  role: {
    id: string;
    name: string;
    description: string;
    createdAt: string;
    updatedAt: string;
  };
  analytics: {
    totalGamesPlayed: number;
    totalSessionCount: number;
    totalTimePlayed: number;
    mostPlayedGame: {
      gameId?: string;
      gameTitle?: string;
      sessionCount?: number;
    };
  };
}

export interface GameAnalytics {
  id: string;
  title: string;
  description?: string;
  overview?: string;
  code?: string;
  thumbnailFile?: {
    id: string;
    url: string;
    s3Url?: string;
  };
  status: 'active' | 'disabled';
  category?: {
    id: string;
    name: string;
  };
  analytics: {
    uniquePlayers: number;
    totalSessions: number;
    totalPlayTime: number;
  };
}

interface UserActivityLog {
  id: string;
  userId: string;
  username: string;
  action: string;
  timestamp: Date;
  metadata?: Record<string, string | number | boolean>;
}

/**
 * Hook to fetch dashboard analytics
 * @returns Query result with dashboard analytics data
 */
export const useDashboardAnalytics = () => {
  return useQuery<DashboardAnalytics>({
    queryKey: [BackendRoute.ADMIN_DASHBOARD],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.ADMIN_DASHBOARD);
      console.log('API Response:', response.data);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch all users with their analytics
 * @returns Query result with users analytics data
 */
export interface FilterState {
  registrationDates: {
    startDate: string;
    endDate: string;
  };
  sessionCount: string;
  timePlayed: {
    min: number;
    max: number;
  };
  gameTitle: string;
  gameCategory: string;
  sortByMaxTimePlayed: boolean;
}

export const useUsersAnalytics = (filters?: FilterState) => {
  return useQuery<UserAnalytics[]>({
    queryKey: [BackendRoute.ADMIN_USERS_ANALYTICS, filters],
    queryFn: async () => {
      const params = new URLSearchParams();
      if (filters) {
        if (filters.registrationDates.startDate) params.append('startDate', filters.registrationDates.startDate);
        if (filters.registrationDates.endDate) params.append('endDate', filters.registrationDates.endDate);
        if (filters.sessionCount) params.append('sessionCount', filters.sessionCount);
        if (filters.timePlayed.min) params.append('minTimePlayed', String(filters.timePlayed.min * 60)); // Convert to seconds
        if (filters.timePlayed.max) params.append('maxTimePlayed', String(filters.timePlayed.max * 60)); // Convert to seconds
        if (filters.gameTitle) params.append('gameTitle', filters.gameTitle);
        if (filters.gameCategory) params.append('gameCategory', filters.gameCategory);
      }
      const url = `${BackendRoute.ADMIN_USERS_ANALYTICS}${params.toString() ? `?${params.toString()}` : ''}`;
      const response = await backendService.get(url);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch analytics for a specific user
 * @param userId - User ID
 * @returns Query result with user analytics data
 */
export const useUserAnalyticsById = (userId: string) => {
  const url = BackendRoute.ADMIN_USER_ANALYTICS.replace(':id', userId);
  return useQuery<UserAnalytics>({
    queryKey: [BackendRoute.ADMIN_USER_ANALYTICS, userId],
    queryFn: async () => {
      const response = await backendService.get(url);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch all games with their analytics
 * @returns Query result with games analytics data
 */
export const useGamesAnalytics = () => {
  return useQuery<GameAnalytics[]>({
    queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.ADMIN_GAMES_ANALYTICS);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch analytics for a specific game
 * @param gameId - Game ID
 * @returns Query result with game analytics data
 */
export const useGameAnalyticsById = (gameId: string) => {
  const url = BackendRoute.ADMIN_GAME_ANALYTICS.replace(':id', gameId);
  return useQuery<GameAnalytics>({
    queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS, gameId],
    queryFn: async () => {
      const response = await backendService.get(url);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch user activity log
 * @returns Query result with user activity log data
 */
export const useUserActivityLog = () => {
  return useQuery<UserActivityLog[]>({
    queryKey: [BackendRoute.ADMIN_USER_ACTIVITY],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.ADMIN_USER_ACTIVITY);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to trigger inactive users check
 * @returns Mutation function to check inactive users
 */
export const useCheckInactiveUsers = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async () => {
      const response = await backendService.post(BackendRoute.ADMIN_CHECK_INACTIVE);
      return response.data;
    },
    onSuccess: () => {
      // Invalidate relevant queries that might be affected by the inactive users check
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_DASHBOARD] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USERS_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_USER_ACTIVITY] });
    },
  });
};

// User Stats Types
interface UserGameStats {
  gameId: string;
  title: string;
  thumbnailUrl: string;
  totalSeconds: number;
  lastPlayed: Date;
}

interface UserStats {
  totalSeconds: number;
  totalPlays: number;
  gamesPlayed: UserGameStats[];
}

/**
 * Hook to fetch current user's game statistics
 * @returns Query result with user stats data
 */
export const useCurrentUserStats = () => {
  return useQuery<UserStats>({
    queryKey: [BackendRoute.USER_STATS],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.USER_STATS);
      return response.data;
    },
    refetchOnWindowFocus: false,
  });
};
export const useGamesWithPopularity = () => {
  return useQuery({
    queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS_POPULARITY],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.ADMIN_GAMES_ANALYTICS_POPULARITY);
      return response;
    },
    refetchOnWindowFocus: false,
  });
};
</file>

<file path="src/backend/api.service.ts">
import axios from 'axios';
import type { AxiosRequestConfig, AxiosError } from 'axios';
import { BackendRoute } from './constants';
import { toast } from 'sonner';

const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL ?? 'http://localhost:5000',
  headers: {
    'Content-Type': 'application/json',
  },
});

// Add request interceptor for authentication
api.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Flag to prevent multiple refresh token requests
let isRefreshing = false;
let failedQueue: {
  resolve: (value: unknown) => void;
  reject: (reason?: unknown) => void;
}[] = [];

// Process the queue of failed requests
const processQueue = (
  error: AxiosError | null,
  token: string | null = null
) => {
  failedQueue.forEach((promise) => {
    if (error) {
      promise.reject(error);
    } else {
      promise.resolve(token);
    }
  });

  failedQueue = [];
};

// Add response interceptor for error handling and token refresh
api.interceptors.response.use(
  (response) => response.data,
  async (error) => {
    const originalRequest = error.config;

    if (error.response?.status !== 401 || originalRequest._retry) {
      if (error.response?.data?.error?.message) {
        toast.error(error.response?.data?.error?.message);
      } else if (error.message) {
        toast.error(`Error: ${error.message}`);
      } else {
        toast.error('An error occurred. Please try again.');
      }
      return Promise.reject(error);
    }

    // If we're already refreshing, queue this request
    if (isRefreshing) {
      return new Promise((resolve, reject) => {
        failedQueue.push({ resolve, reject });
      })
        .then((token) => {
          originalRequest.headers.Authorization = `Bearer ${token}`;
          return api(originalRequest);
        })
        .catch((err) => {
          return Promise.reject(err);
        });
    }

    originalRequest._retry = true;
    isRefreshing = true;

    try {
      const refreshToken = localStorage.getItem('refreshToken');

      // If no refresh token, clear auth and redirect
      if (!refreshToken) {
        localStorage.removeItem('token');
        localStorage.removeItem('refreshToken');

        if (
          window.location.pathname !== '/' &&
          !window.location.pathname.includes('/login')
        ) {
          window.location.href = '/';
        }

        return Promise.reject(error);
      }

      // Try to refresh the token
      const response = await axios.post(
        `${api.defaults.baseURL}${BackendRoute.AUTH_REFRESH_TOKEN}`,
        { refreshToken },
        { headers: { 'Content-Type': 'application/json' } }
      );

      const { accessToken, refreshToken: newRefreshToken } = response.data;

      // Store the new tokens
      localStorage.setItem('token', accessToken);
      localStorage.setItem('refreshToken', newRefreshToken);

      // Update the authorization header
      api.defaults.headers.common['Authorization'] = `Bearer ${accessToken}`;
      originalRequest.headers.Authorization = `Bearer ${accessToken}`;

      // Process the queue with the new token
      processQueue(null, accessToken);

      // Return the original request with the new token
      return api(originalRequest);
    } catch (refreshError) {
      // If refresh fails, clear auth and redirect
      localStorage.removeItem('token');
      localStorage.removeItem('refreshToken');

      // Show error toast
      toast.error('Your session has expired. Please log in again.');

      // Process the queue with the error
      processQueue(refreshError as AxiosError);

      // Redirect if not already on home or login page
      if (
        window.location.pathname !== '/' &&
        !window.location.pathname.includes('/login')
      ) {
        window.location.href = '/';
      }

      return Promise.reject(refreshError);
    } finally {
      isRefreshing = false;
    }
  }
);

/**
 * Backend service for API calls
 */
export const backendService = {
  get: (url: string, config?: AxiosRequestConfig) => api.get(url, config),
  post: (url: string, data?: any, config?: AxiosRequestConfig) =>
    api.post(url, data, config),
  put: (url: string, data?: any, config?: AxiosRequestConfig) =>
    api.put(url, data, config),
  patch: (url: string, data?: any, config?: AxiosRequestConfig) =>
    api.patch(url, data, config),
  delete: (url: string, config?: AxiosRequestConfig) => api.delete(url, config),
};
</file>

<file path="src/backend/auth.service.ts">
import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';
import type {
  User,
  LoginCredentials,
  OtpVerification,
  AuthTokens,
  RegistrationData,
  ForgotPasswordData,
} from './types';


export const useLogin = () => {
  return useMutation({
    mutationFn: async (credentials: LoginCredentials) => {
      const response = await backendService.post(BackendRoute.AUTH_LOGIN, credentials);
      return response;
    },
  });
};


export const useVerifyOtp = () => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: async (data: OtpVerification): Promise<AuthTokens> => {
      const response = await backendService.post(BackendRoute.AUTH_VERIFY_OTP, data);
      return response as unknown as AuthTokens;
    },
    onSuccess: (data) => {
      // Store tokens
      localStorage.setItem('token', data.accessToken);
      localStorage.setItem('refreshToken', data.refreshToken);

      queryClient.invalidateQueries({ queryKey: [BackendRoute.AUTH_ME] });
    },
  });
};

export const useVerifyResetOtp = () => {
  return useMutation({
    mutationFn: async ({ userId, otp }: { userId: string; otp: string }) => {
      return backendService.post(BackendRoute.AUTH_VERIFY_OTP, { userId, otp });
    },
  });
};

//Hook to request a new OTP

export const useRequestOtp = () => {
  return useMutation({
    mutationFn: async ({ userId, otpType }: { userId: string; otpType: 'SMS' | 'EMAIL' | 'BOTH' }) => {
      return backendService.post(BackendRoute.AUTH_REQUEST_OTP, { userId, otpType });
    },
  });
};


export const useCurrentUser = () => {
  return useQuery<User>({
    queryKey: [BackendRoute.AUTH_ME],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.AUTH_ME);
      return response as unknown as User;
    },
    retry: false,
    enabled: !!localStorage.getItem('token'), // Only run if token exists
  });
};


export const useRegister = () => {
  return useMutation({
    mutationFn: (userData: RegistrationData) => {
      return backendService.post(BackendRoute.AUTH_REGISTER, userData);
    },
  });
};


export const useRefreshToken = () => {
  return useMutation({
    mutationFn: async (refreshToken: string): Promise<AuthTokens> => {
      const response = await backendService.post(BackendRoute.AUTH_REFRESH_TOKEN, { refreshToken });
      return response as unknown as AuthTokens;
    },
  onSuccess: (data) => {
    localStorage.setItem('token', data.accessToken);
    localStorage.setItem('refreshToken', data.refreshToken);
  },
  });
};


export const useLogout = () => {
  const queryClient = useQueryClient();

  return () => {
    localStorage.removeItem('token');
    localStorage.removeItem('refreshToken');

    // Clear user from cache
    queryClient.invalidateQueries({ queryKey: [BackendRoute.AUTH_ME] });
  };
};


export const useForgotPassword = () => {
  return useMutation({
    mutationFn: async (email: string) => {
      const data: ForgotPasswordData = { email };
      return backendService.post(BackendRoute.AUTH_FORGOT_PASSWORD, data);
    },
  });
};

export const useForgotPasswordPhone = () => {
  return useMutation({
    mutationFn: async (phoneNumber: string) => {
      return backendService.post(BackendRoute.AUTH_FORGOT_PASSWORD + '/phone', { phoneNumber });
    },
  });
};


export const useVerifyResetToken = () => {
  return useMutation({
    mutationFn: async (token: string) => {
      try {
        const response = await backendService.get(`${BackendRoute.AUTH_RESET_PASSWORD}/${token}?_=${Date.now()}`);
        console.log("Verify token response:", response);
        return { success: true, message: "Token is valid" };
      } catch (error) {
        console.error("Error verifying token:", error);
        throw error;
      }
    },
    retry: false, // Don't retry on failure
  });
};


export const useResetPassword = () => {
  return useMutation({
    mutationFn: async ({ token, userId, password, confirmPassword }: { token?: string; userId?: string; password: string; confirmPassword: string }) => {
      if (token) {
        // Email flow - use token in URL
        return backendService.post(`${BackendRoute.AUTH_RESET_PASSWORD}/${token}`, { password, confirmPassword });
      } else {
        // Phone flow - use userId in body
        return backendService.post(BackendRoute.AUTH_RESET_PASSWORD, { userId, password, confirmPassword });
      }
    },
  });
};
</file>

<file path="src/backend/category.service.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';
import type { Category } from './types';

/**
 * Hook to fetch all categories
 * @returns Query result with categories data
 */
export const useCategories = () => {
  return useQuery<Category[]>({
    queryKey: [BackendRoute.CATEGORIES],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.CATEGORIES);
      return response.data as Category[];
    },
  });
};

/**
 * Hook to fetch a specific category by ID
 * @param id - Category ID
 * @returns Query result with category data
 */
export const useCategoryById = (id: string) => {
  return useQuery<Category>({
    queryKey: [BackendRoute.CATEGORIES, id],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.CATEGORY_BY_ID.replace(':id', id));
      return response.data as Category;
    },
  });
};

/**
 * Hook to create a new category
 * @returns Mutation function to create a category
 */
export const useCreateCategory = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (data: Omit<Category, 'id' | 'createdAt' | 'updatedAt'>) =>
      backendService.post(BackendRoute.CATEGORIES, data),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES] });
    },
  });
};

/**
 * Hook to update a category
 * @returns Mutation function to update a category
 */
export const useUpdateCategory = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: ({ id, data }: { id: string; data: Partial<Category> }) =>
      backendService.put(BackendRoute.CATEGORY_BY_ID.replace(':id', id), data),
    onSuccess: (_, { id }) => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES, id] });
    },
  });
};

/**
 * Hook to delete a category
 * @returns Mutation function to delete a category
 */
export const useDeleteCategory = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (id: string) =>
      backendService.delete(BackendRoute.CATEGORY_BY_ID.replace(':id', id)),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES] });
    },
  });
};
</file>

<file path="src/backend/configuration.service.ts">
import { useMutation, useQuery, useQueryClient } from "@tanstack/react-query";
import { backendService } from "./api.service";
import { BackendRoute } from "./constants";

// Get formatted configs (public route)
export const useFormattedSystemConfigs = () => {
  return useQuery({
    queryKey: [BackendRoute.SYSTEM_CONFIG_FORMATTED],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.SYSTEM_CONFIG_FORMATTED);
      return response.data;
    }
  });
};

// Get config by key (public route)
export const useSystemConfigByKey = (key: string) => {
  return useQuery({
    queryKey: [BackendRoute.SYSTEM_CONFIG, key],
    queryFn: async () => {
      const response = await backendService.get(
        BackendRoute.SYSTEM_CONFIG_BY_KEY.replace(':key', key)
      );
      return response.data;
    },
    retry: false, // Don't retry on 404
    enabled: true // Always enabled by default
  });
};

// Get all configs (admin route)
export const useAllSystemConfigs = () => {
  return useQuery({
    queryKey: [BackendRoute.SYSTEM_CONFIG],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.SYSTEM_CONFIG);
      return response.data;
    }
  });
};

// Create config (admin route)
export const useCreateSystemConfig = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (data: any) => {
      const headers = data instanceof FormData
        ? { 'Content-Type': 'multipart/form-data' }
        : { 'Content-Type': 'application/json' };

      const response = await backendService.post(BackendRoute.SYSTEM_CONFIG, data, { headers });
      return response.data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.SYSTEM_CONFIG] });
    }
  });
};

// Update config (admin route)
export const useUpdateSystemConfig = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async ({ key, data }: { key: string; data: any }) => {
      const response = await backendService.put(
        BackendRoute.SYSTEM_CONFIG_BY_KEY.replace(':key', key),
        data
      );
      return response.data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.SYSTEM_CONFIG] });
    }
  });
};

// Delete config (admin route)
export const useDeleteSystemConfig = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (key: string) => {
      const response = await backendService.delete(
        BackendRoute.SYSTEM_CONFIG_BY_KEY.replace(':key', key)
      );
      return response.data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.SYSTEM_CONFIG] });
    }
  });
};
</file>

<file path="src/backend/constants.ts">
/**
 * Backend API routes
 */
export const BackendRoute = {
  USER: '/api/users',
  USER_BY_ID: '/api/users/:id',
  HEALTH: '/api/health',
  AUTH_LOGIN: '/api/auth/login',
  AUTH_VERIFY_OTP: '/api/auth/verify-otp',
  AUTH_ME: '/api/auth/me',
  AUTH_CHANGE_PASSWORD: '/api/auth/me/change-password',
  AUTH_REFRESH_TOKEN: '/api/auth/refresh-token',
  AUTH_REGISTER: '/api/auth/register',
  AUTH_REQUEST_OTP: '/api/auth/request-otp',
  AUTH_FORGOT_PASSWORD: '/api/auth/forgot-password',
  AUTH_RESET_PASSWORD: '/api/auth/reset-password',
  AUTH_INVITE: '/api/auth/invite',
  AUTH_INVITATIONS: '/api/auth/invitations',
  AUTH_INVITATION_BY_ID: '/api/auth/invitations/:id',
  AUTH_VERIFY_INVITATION: '/api/auth/verify-invitation/:token',
  AUTH_REGISTER_FROM_INVITATION: '/api/auth/register/:token',
  AUTH_RESET_PASSWORD_FROM_INVITATION: '/api/auth/reset-password-from-invitation/:token',
  AUTH_REVOKE_ROLE: '/api/auth/revoke-role/:id',
  GAMES: '/api/games',
  GAME_BY_ID: '/api/games/:id',
  CATEGORIES: '/api/categories',
  CATEGORY_BY_ID: '/api/categories/:id',

  // Analytics Routes
  ANALYTICS: '/api/analytics',
  ANALYTICS_BY_ID: '/api/analytics/:id',
  ANALYTICS_END_TIME: '/api/analytics/:id/end',

  // Admin Dashboard Routes
  ADMIN_DASHBOARD: '/api/admin/dashboard',
  ADMIN_GAMES: '/api/admin/games',
  ADMIN_USERS_ANALYTICS: '/api/admin/users-analytics',
  ADMIN_USER_ANALYTICS: '/api/admin/users/:id/analytics',
  ADMIN_GAMES_ANALYTICS: '/api/admin/games-analytics',
  ADMIN_GAME_ANALYTICS: '/api/admin/games/:id/analytics',
  ADMIN_USER_ACTIVITY: '/api/admin/user-activity-log',
  ADMIN_GAMES_ANALYTICS_POPULARITY: '/api/admin/games-popularity',
  ADMIN_CHECK_INACTIVE: '/api/admin/check-inactive-users',

  // User Stats Route
  USER_STATS: '/api/users/me/stats',

  // Heartbeat Routes
  USER_HEARTBEAT: '/api/users/heartbeat',
  USER_ONLINE_STATUS: '/api/users/online-status',

  // Signup Analytics Routes
  SIGNUP_ANALYTICS_CLICK: '/api/signup-analytics/click',
  SIGNUP_ANALYTICS_DATA: '/api/signup-analytics/data',

  // System Config Routes
  SYSTEM_CONFIG: '/api/system-configs',
  SYSTEM_CONFIG_FORMATTED: '/api/system-configs/formatted',
  SYSTEM_CONFIG_BY_KEY: '/api/system-configs/:key',
} as const;
</file>

<file path="src/backend/games.service.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';
import type { GameResponse, GameStatus, PaginatedResponse } from './types';

export const useGames = (params?: {
  categoryId?: string;
  status?: GameStatus;
  filter?: 'popular' | 'recommended' | 'recently_added';
  search?: string;
  limit?: number;
}) => {
  return useQuery<PaginatedResponse<GameResponse>>({
    queryKey: [BackendRoute.GAMES, params],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.GAMES, { params });
      return response.data as PaginatedResponse<GameResponse>;
    },
  });
};

export const useGameById = (id: string) => {
  return useQuery<any>({
    queryKey: [BackendRoute.GAMES, id],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.GAME_BY_ID.replace(':id', id));
      console.log('Game API Response:', response.data);
      return response.data as GameResponse;
    },
  });
};

export const useCreateGame = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (data: FormData) =>
      backendService.post(BackendRoute.GAMES, data, {
        headers: {
          'Content-Type': 'multipart/form-data',
        },
      }),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
    },
  });
};

export const useUpdateGame = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: ({ id, data }: { id: string; data: FormData }) =>
      backendService.put(BackendRoute.GAME_BY_ID.replace(':id', id), data, {
        headers: {
          'Content-Type': 'multipart/form-data',
        },
      }),
    onSuccess: (_, { id }) => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES, id] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS, id] });
    },
  });
};

export const useToggleGameStatus = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async ({ gameId, currentStatus }: { gameId: string; currentStatus: string }) => {
      const newStatus = currentStatus === 'active' ? 'disabled' : 'active';
      const formData = new FormData();
      formData.append('status', newStatus);

      const response = await backendService.put(BackendRoute.GAME_BY_ID.replace(':id', gameId), formData, {
        headers: {
          'Content-Type': 'multipart/form-data',
        },
      });
      return response.data;
    },
    onSuccess: (_, { gameId }) => {
      // Invalidate all games queries (this will update Home and Categories pages)
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES, gameId] });
      // Invalidate admin queries
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAME_ANALYTICS, gameId] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES]});
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES]});
    },
  });
};

export const useDeleteGame = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (id: string) =>
      backendService.delete(BackendRoute.GAME_BY_ID.replace(':id', id)),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.GAMES] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS] });
    },
  });
};
</file>

<file path="src/backend/main.ts">
// Export all backend-related modules
export * from './constants';
export * from './types';
export * from './api.service';
export * from './user.service';
</file>

<file path="src/backend/signup.analytics.service.ts">
import { useQuery, useMutation } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';

interface SignupAnalyticsData {
  totalClicks: number;
  periodClicks: number;
  uniqueSessions: number;
  clicksByCountry: Array<{
    country: string;
    count: string;
  }>;
  clicksByDevice: Array<{
    deviceType: string;
    count: string;
  }>;
  clicksByDay: Array<{
    date: string;
    count: string;
  }>;
  clicksByType: Array<{
    type: string;
    count: string;
  }>;
}

/**
 * Hook to track signup button clicks
 * @returns Mutation function to track signup clicks
 */
export const useTrackSignupClick = () => {
  return useMutation({
    mutationFn: async (data: { sessionId?: string; type: string }) => {
      const response = await backendService.post(BackendRoute.SIGNUP_ANALYTICS_CLICK, data);
      return response.data;
    }
  });
};

/**
 * Hook to fetch signup analytics data
 * @param days - Number of days to include (default 30)
 * @returns Query result with signup analytics data
 */
export const useSignupAnalyticsData = (days?: number) => {
  return useQuery<SignupAnalyticsData>({
    queryKey: [BackendRoute.SIGNUP_ANALYTICS_DATA, days],
    queryFn: async () => {
      const url = days
        ? `${BackendRoute.SIGNUP_ANALYTICS_DATA}?days=${days}`
        : BackendRoute.SIGNUP_ANALYTICS_DATA;
      const response = await backendService.get(url);

      const analyticsData = response.data;
      return analyticsData;
    },
    refetchOnWindowFocus: false,
    retry: 3
  });
};
</file>

<file path="src/backend/teams.service.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';
// import type { User } from './types';

export interface InviteUserRequest {
  email: string;
  role: 'superadmin' | 'admin' | 'editor' | 'player';
}

export interface ResetPasswordFromInvitationRequest {
  password: string;
  confirmPassword: string;
}

export interface RegisterFromInvitationRequest {
  firstName: string;
  lastName: string;
  password: string;
  confirmPassword: string;
  phoneNumber: string;
  email: string;
}

// interface Invitation {
//   id: string;
//   email: string;
//   role: {
//     name: string;
//   };
//   invitedBy: {
//     firstName: string;
//     lastName: string;
//   };
//   isAccepted: boolean;
//   expiresAt: string;
//   createdAt: string;
// }

interface InviteUserResponse {
  success: boolean;
  message: string;
  data: {
    id: string;
    email: string;
    role: string;
    expiresAt: string;
  };
}

// interface InvitationsResponse {
//   success: boolean;
//   count: number;
//   data: Invitation[];
// }

interface VerifyInvitationResponse {
  success: boolean;
  message: string;
  data: {
    email: string;
    userExists: boolean;
    role: string;
  };
}

/**
 * Hook to fetch all team invitations
 * @returns Query result with invitations data
 */
export const useTeamInvitations = () => {
  return useQuery({
    queryKey: [BackendRoute.AUTH_INVITATIONS],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.AUTH_INVITATIONS);
      return response;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to invite a new team member
 * @returns Mutation function to send invitation
 */
export const useInviteTeamMember = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (data: InviteUserRequest) => {
      const response = await backendService.post(BackendRoute.AUTH_INVITE, data);
      return response.data as InviteUserResponse;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.AUTH_INVITATIONS] });
    },
  });
};

/**
 * Hook to verify an invitation token
 * @returns Query function to verify token
 */
export const useVerifyInvitation = (token: string) => {
  return useQuery<VerifyInvitationResponse>({
    queryKey: ['verifyInvitation', token],
    queryFn: async () => {
      const url = BackendRoute.AUTH_VERIFY_INVITATION.replace(':token', token);
      const response = await backendService.get(url);
      return response.data;
    },
    enabled: !!token,
    retry: 1,
    retryDelay: 1000,
    refetchOnWindowFocus: false,
    staleTime: Infinity,
    gcTime: 0
  });
};

/**
 * Hook to register from invitation
 * @returns Mutation function to register
 */
export const useRegisterFromInvitation = () => {
  return useMutation({
    mutationFn: async ({ token, data }: { token: string, data: RegisterFromInvitationRequest }) => {
      const url = BackendRoute.AUTH_REGISTER_FROM_INVITATION.replace(':token', token);
      const response = await backendService.post(url, data);
      return response.data;
    }
  });
};

/**
 * Hook to reset password from invitation
 * @returns Mutation function to reset password
 */
export const useResetPasswordFromInvitation = () => {
  return useMutation({
    mutationFn: async ({ token, data }: { token: string, data: ResetPasswordFromInvitationRequest }) => {
      const url = BackendRoute.AUTH_RESET_PASSWORD_FROM_INVITATION.replace(':token', token);
      const response = await backendService.post(url, data);
      return response.data;
    }
  });
};

export const useAllTeamMembers = () => {
  return useQuery({
    queryKey: ['allTeamMembers'],
    queryFn: async () => {
      const { data } = await backendService.get(BackendRoute.USER);
      return data;
    },
    refetchOnWindowFocus: false,
  });
};

export const useRevokeRole = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (id: string) => {
      const url = BackendRoute.AUTH_REVOKE_ROLE.replace(':id', id);
      const response = await backendService.put(url);
      return response.data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER] });
      queryClient.invalidateQueries({ queryKey: ["allTeamMembers"] });
    },
  });
};

export const useDeleteTeamInvitation = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async (id: string) => {
      const url = BackendRoute.AUTH_INVITATION_BY_ID.replace(':id', id);
      const response = await backendService.delete(url);
      return response.data;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.AUTH_INVITATIONS] });
    },
  });
};
</file>

<file path="src/backend/types.ts">
export interface Role {
  id: string;
  name: string;
  description: string;
  isActive: boolean;
  createdAt: string;
  updatedAt: string;
}

export interface Category {
  id: string;
  name: string;
  description?: string;
  games?: Game[];
  createdAt: string;
  updatedAt: string;
}

export interface FileMetadata {
  id: string;
  name: string;
  url: string;
  type: string;
  size: number;
  createdAt: string;
  updatedAt: string;
}

export type GameStatus = 'active' | 'disabled';

export interface Game {
  id: string;
  title: string;
  description?: string;
  thumbnailFileId?: string;
  thumbnailFile?: FileMetadata;
  status: GameStatus;
  gameFileId?: string;
  gameFile?: FileMetadata;
  config: number;
  categoryId?: string;
  category?: Category;
  createdById?: string;
  createdBy?: User;
  createdAt: string;
  updatedAt: string;
}

export interface CreateGameDto {
  title: string;
  description?: string;
  thumbnailFile?: File;
  gameFile?: File;
  config?: number;
  categoryId?: string;
}

export type UpdateGameDto = Partial<CreateGameDto>;

// These types represent the actual API response structure
export interface PaginatedResponse<T> {
  success: boolean;
  count: number;
  total: number;
  page: number;
  limit: number;
  totalPages: number;
  data: T[];
}

export interface GameFile {
  id: string;
  s3Key: string;
  url: string;
  type: string;
  createdAt: string;
  updatedAt: string;
}

export interface SimilarGame {
  id: string;
  title: string;
  thumbnailFile?: GameFile;
}

export interface GameData {
  id: string;
  title: string;
  description?: string;
  thumbnailFile?: GameFile;
  gameFile?: GameFile;
  status: GameStatus;
  config: number;
  categoryId?: string;
  category?: Category;
  createdById?: string;
  createdBy?: User;
  createdAt: string;
  updatedAt: string;
  similarGames?: SimilarGame[];
}

export type GameResponse = GameData;
export interface User {
  id: string;
  firstName: string;
  lastName: string;
  email: string;
  phoneNumber?: string;
  password?: string;
  isAdmin: boolean;
  isActive: boolean;
  createdAt: string;
  updatedAt: string;
  role: Role
}

export interface LoginCredentials {
  identifier: string;
  password: string;
}

export interface OtpVerification {
  userId: string;
  otp: string;
}

export interface AuthTokens {
  accessToken: string;
  refreshToken: string;
}

export type RegistrationData = Partial<User> & {
  password: string;
  hasAcceptedTerms: boolean;
  isAdult: boolean;
};

export interface ForgotPasswordData {
  email: string;
}

export interface ResetPasswordData {
  token: string;
  password: string;
  confirmPassword: string;
}

export interface ChangePasswordData {
  id: string;
  oldPassword: string;
  password: string;
}

export interface CreateAnalyticsData {
  gameId?: string;
  activityType: string;
  startTime?: Date;
  endTime?: Date;
  sessionCount?: number;
}

export interface Analytics {
  id: string;
  userId: string;
  gameId?: string;
  activityType: string;
  startTime?: Date;
  endTime?: Date;
  duration?: number;
  sessionCount?: number;
  createdAt: string;
  updatedAt: string;
}
</file>

<file path="src/backend/user.service.ts">
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { backendService } from './api.service';
import { BackendRoute } from './constants';
import type { User } from './types';

/**
 * Hook to fetch user data
 * @returns Query result with user data
 */
export const useUserData = () => {
  return useQuery<User>({
    queryKey: [BackendRoute.AUTH_ME],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.AUTH_ME);
      return response.data as unknown as User;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to fetch a specific user by ID
 * @param id - User ID
 * @returns Query result with user data
 */
export const useUserById = (id: string) => {
  const url = BackendRoute.USER_BY_ID.replace(':id', id);
  return useQuery<User>({
    queryKey: [BackendRoute.USER, id],
    queryFn: async () => {
      const response = await backendService.get(url);
      return response as unknown as User;
    },
    refetchOnWindowFocus: false,
  });
};

/**
 * Hook to update user data
 * @returns Mutation function to update user data
 */
export const useUpdateUserData = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: async ({ id, ...data }: Partial<User> & { id: string }) => {
      const url = BackendRoute.USER_BY_ID.replace(':id', id);
      const response = await backendService.put(url, data);
      return response;
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER] });
      queryClient.invalidateQueries({ queryKey: [BackendRoute.AUTH_ME] });
    },
  });
};

/**
 * Hook to create a new user
 * @returns Mutation function to create a user
 */
export const useCreateUser = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (data: {
      firstName: string;
      lastName: string;
      email: string;
      password: string;
      phoneNumber?: string;
      isAdult: boolean;
      hasAcceptedTerms: boolean;
    }) => backendService.post(BackendRoute.USER, data),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER] });
    },
  });
};

/**
 * Hook to delete a user
 * @returns Mutation function to delete a user
 */
export const useDeleteUser = () => {
  const queryClient = useQueryClient();
  return useMutation({
    mutationFn: (id: string) => {
      const url = BackendRoute.USER_BY_ID.replace(':id', id);
      return backendService.delete(url);
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER] });
    },
  });
};

/**
 * Hook to change user password
 * @returns Mutation function to change password
 */
export const useChangePassword = () => {
  return useMutation({
    mutationFn: async ({ oldPassword, password }: { oldPassword: string; password: string }) => {
      const url = BackendRoute.AUTH_CHANGE_PASSWORD;
      const response = await backendService.post(url, { oldPassword, newPassword: password });
      return response;
    }
  });
};

/**
 * Hook to send heartbeat to maintain online status
 * @returns Mutation function to send heartbeat
 */
export const useSendHeartbeat = () => {
  return useMutation({
    mutationFn: async () => {
      const response = await backendService.post(BackendRoute.USER_HEARTBEAT);
      return response;
    }
  });
};

/**
 * Hook to get current user's online status
 * @returns Query result with online status data
 */
export const useOnlineStatus = () => {
  return useQuery({
    queryKey: [BackendRoute.USER_ONLINE_STATUS],
    queryFn: async () => {
      const response = await backendService.get(BackendRoute.USER_ONLINE_STATUS);
      return response.data;
    },
    refetchOnWindowFocus: false,
    refetchInterval: 5 * 60 * 1000, // Refetch every 5 minutes
  });
};

/**
 * Function to send heartbeat (non-hook version for use in intervals)
 * @returns Promise with response
 */
export const sendHeartbeat = async () => {
  try {
    const response = await backendService.post(BackendRoute.USER_HEARTBEAT);
    return response;
  } catch (error) {
    console.error('Failed to send heartbeat:', error);
    throw error;
  }
};
</file>

<file path="src/components/__tests__/AllGamesSection.logic.test.ts">
import { describe, it, expect } from 'vitest'

describe('AllGamesSection Business Logic', () => {
  describe('Category Filtering Logic', () => {
    it('should build correct query parameters for different categories', () => {
      const testCases = [
        {
          selectedCategory: 'all',
          expected: {
            categoryId: undefined,
            filter: undefined,
            status: 'active'
          }
        },
        {
          selectedCategory: 'recent',
          expected: {
            categoryId: undefined,
            filter: 'recently_added',
            status: 'active'
          }
        },
        {
          selectedCategory: 'category-123',
          expected: {
            categoryId: 'category-123',
            filter: undefined,
            status: 'active'
          }
        }
      ]

      testCases.forEach(({ selectedCategory, expected }) => {
        const queryParams = {
          categoryId: selectedCategory === "all" ? undefined : selectedCategory === "recent" ? undefined : selectedCategory,
          filter: selectedCategory === "recent" ? "recently_added" : undefined,
          status: "active" as const
        }

        expect(queryParams.categoryId).toBe(expected.categoryId)
        expect(queryParams.filter).toBe(expected.filter)
        expect(queryParams.status).toBe(expected.status)
      })
    })

    it('should handle search query integration', () => {
      const searchQueries = ['', 'puzzle', 'action game', null, undefined]

      searchQueries.forEach(searchQuery => {
        const queryParams = {
          search: searchQuery || undefined
        }

        if (searchQuery) {
          expect(queryParams.search).toBe(searchQuery)
        } else {
          expect(queryParams.search).toBeUndefined()
        }
      })
    })
  })

  describe('Categories Data Processing Logic', () => {
    it('should combine static and dynamic categories correctly', () => {
      const mockCategoriesData = [
        { id: 'cat-1', name: 'Action' },
        { id: 'cat-2', name: 'Puzzle' }
      ]

      const allCategories = [
        { id: "all", name: "All Games", color: "#C026D3" },
        ...(mockCategoriesData?.map(cat => ({
          id: cat.id,
          name: cat.name,
          color: "#94A3B7"
        })) || []),
        { id: "recent", name: "Recently Added", color: "#94A3B7" }
      ]

      expect(allCategories).toHaveLength(4)
      expect(allCategories[0].id).toBe('all')
      expect(allCategories[1].id).toBe('cat-1')
      expect(allCategories[2].id).toBe('cat-2')
      expect(allCategories[3].id).toBe('recent')
    })

    it('should handle empty categories data', () => {
      const emptyCategoriesData = null

      const allCategories = [
        { id: "all", name: "All Games", color: "#C026D3" },
        ...((emptyCategoriesData as any)?.map((cat: any) => ({
          id: cat.id,
          name: cat.name,
          color: "#94A3B7"
        })) || []),
        { id: "recent", name: "Recently Added", color: "#94A3B7" }
      ]

      expect(allCategories).toHaveLength(2)
      expect(allCategories[0].id).toBe('all')
      expect(allCategories[1].id).toBe('recent')
    })

    it('should apply correct colors to categories', () => {
      const mockCategoriesData = [
        { id: 'cat-1', name: 'Action' }
      ]

      const processedCategories = mockCategoriesData.map(cat => ({
        id: cat.id,
        name: cat.name,
        color: "#94A3B7"
      }))

      expect(processedCategories[0].color).toBe("#94A3B7")
    })
  })

  describe('Game Display Logic', () => {
    it('should determine correct display state based on loading and data', () => {
      const scenarios = [
        {
          gamesLoading: true,
          gamesError: null,
          games: [],
          expected: 'loading'
        },
        {
          gamesLoading: false,
          gamesError: new Error('Failed to load'),
          games: [],
          expected: 'error'
        },
        {
          gamesLoading: false,
          gamesError: null,
          games: [],
          expected: 'empty'
        },
        {
          gamesLoading: false,
          gamesError: null,
          games: [{ id: '1', title: 'Game 1' }],
          expected: 'games'
        }
      ]

      scenarios.forEach(({ gamesLoading, gamesError, games, expected }) => {
        let displayState: string

        if (gamesLoading) {
          displayState = 'loading'
        } else if (gamesError) {
          displayState = 'error'
        } else if (games.length === 0) {
          displayState = 'empty'
        } else {
          displayState = 'games'
        }

        expect(displayState).toBe(expected)
      })
    })

    it('should generate correct empty state messages', () => {
      const testCases = [
        {
          selectedCategory: 'all',
          allCategories: [{ id: 'all', name: 'All Games' }],
          expected: 'No games found for all categories'
        },
        {
          selectedCategory: 'recent',
          allCategories: [{ id: 'recent', name: 'Recently Added' }],
          expected: 'No games found for recently added'
        },
        {
          selectedCategory: 'cat-1',
          allCategories: [{ id: 'cat-1', name: 'Action' }],
          expected: 'No games found for Action'
        },
        {
          selectedCategory: 'unknown',
          allCategories: [{ id: 'cat-1', name: 'Action' }],
          expected: 'No games found for this category'
        }
      ]

      testCases.forEach(({ selectedCategory, allCategories, expected }) => {
        const message = `No games found for ${
          selectedCategory === "all" ? "all categories" :
          selectedCategory === "recent" ? "recently added" :
          allCategories.find(cat => cat.id === selectedCategory)?.name || "this category"
        }`

        expect(message).toBe(expected)
      })
    })
  })

  describe('Grid Layout Logic', () => {
    it('should calculate correct row spans for games', () => {
      const spans = [1, 1.3, 1.1]
      const testGames = Array.from({ length: 6 }, (_, i) => ({ id: `game-${i}` }))

      testGames.forEach((game, index) => {
        console.log(game)
        const spanIndex = index % spans.length
        const rowSpan = spans[spanIndex]
        const calculatedSpan = Math.round(rowSpan * 2)

        expect(spanIndex).toBe(index % 3)
        expect(calculatedSpan).toBeGreaterThan(0)
      })
    })

    it('should handle different span patterns', () => {
      const spans = [1, 1.3, 1.1]
      const expectedSpans = [2, 3, 2] // Math.round(span * 2)

      spans.forEach((span, index) => {
        const calculatedSpan = Math.round(span * 2)
        expect(calculatedSpan).toBe(expectedSpans[index])
      })
    })
  })

  describe('Navigation Logic', () => {
    it('should generate correct game play URLs', () => {
      const gameIds = ['game-123', 'puzzle-456', 'action-789']

      gameIds.forEach(gameId => {
        const url = `/gameplay/${gameId}`
        expect(url).toBe(`/gameplay/${gameId}`)
        expect(url).toMatch(/^\/gameplay\/[\w-]+$/)
      })
    })

    it('should handle special characters in game IDs', () => {
      const specialGameIds = ['game_123', 'game-with-dashes', 'game123']

      specialGameIds.forEach(gameId => {
        const url = `/gameplay/${gameId}`
        expect(url).toContain(gameId)
        expect(url.startsWith('/gameplay/')).toBe(true)
      })
    })
  })

  describe('Image Handling Logic', () => {
    it('should handle game thumbnail URLs', () => {
      const mockGames = [
        { id: '1', thumbnailFile: { s3Key: 'https://example.com/thumb1.jpg' } },
        { id: '2', thumbnailFile: { s3Key: 'https://example.com/thumb2.jpg' } },
        { id: '3', thumbnailFile: null },
        { id: '4', thumbnailFile: undefined }
      ]

      mockGames.forEach(game => {
        const thumbnailUrl = game.thumbnailFile?.s3Key

        if (game.thumbnailFile) {
          expect(thumbnailUrl).toBeTruthy()
          expect(typeof thumbnailUrl).toBe('string')
        } else {
          expect(thumbnailUrl).toBeUndefined()
        }
      })
    })

    it('should validate image loading attributes', () => {
      const imageAttributes = {
        loading: 'lazy',
        alt: 'Game Title'
      }

      expect(imageAttributes.loading).toBe('lazy')
      expect(imageAttributes.alt).toBeTruthy()
    })
  })

  describe('Search Integration Logic', () => {
    it('should handle search query variations', () => {
      const searchQueries = [
        { input: '', expected: undefined },
        { input: '   ', expected: undefined }, // Whitespace only
        { input: 'puzzle', expected: 'puzzle' },
        { input: 'Action Game', expected: 'Action Game' },
        { input: null, expected: undefined },
        { input: undefined, expected: undefined }
      ]

      searchQueries.forEach(({ input, expected }) => {
        const processedSearch = input?.trim() || undefined
        const finalSearch = processedSearch || undefined

        if (expected) {
          expect(finalSearch).toBe(expected)
        } else {
          expect(finalSearch).toBeUndefined()
        }
      })
    })

    it('should combine search with category filters', () => {
      const combinations = [
        {
          selectedCategory: 'all',
          searchQuery: 'puzzle',
          expected: {
            categoryId: undefined,
            filter: undefined,
            search: 'puzzle',
            status: 'active'
          }
        },
        {
          selectedCategory: 'recent',
          searchQuery: 'action',
          expected: {
            categoryId: undefined,
            filter: 'recently_added',
            search: 'action',
            status: 'active'
          }
        },
        {
          selectedCategory: 'cat-1',
          searchQuery: '',
          expected: {
            categoryId: 'cat-1',
            filter: undefined,
            search: undefined,
            status: 'active'
          }
        }
      ]

      combinations.forEach(({ selectedCategory, searchQuery, expected }) => {
        const queryParams = {
          categoryId: selectedCategory === "all" ? undefined : selectedCategory === "recent" ? undefined : selectedCategory,
          filter: selectedCategory === "recent" ? "recently_added" : undefined,
          status: "active" as const,
          search: searchQuery || undefined
        }

        expect(queryParams).toEqual(expected)
      })
    })
  })
})
</file>

<file path="src/components/__tests__/FormValidation.logic.test.ts">
import { describe, it, expect } from 'vitest'

describe('Form Validation Business Logic', () => {
  describe('Input Validation Logic', () => {
    it('should validate email format correctly', () => {
      const emailTestCases = [
        { email: 'test@example.com', expected: true },
        { email: 'user.name@domain.co.uk', expected: true },
        { email: 'user+tag@example.org', expected: true },
        { email: 'invalid-email', expected: false },
        { email: '@example.com', expected: false },
        { email: 'test@', expected: false },
        { email: '', expected: false },
        { email: null, expected: false },
        { email: undefined, expected: false }
      ]

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/

      emailTestCases.forEach(({ email, expected }) => {
        const isValid = email ? emailRegex.test(email) : false
        expect(isValid).toBe(expected)
      })
    })

    it('should validate phone number formats', () => {
      const phoneTestCases = [
        { phone: '+1234567890', expected: true },
        { phone: '+44 20 7946 0958', expected: true },
        { phone: '(555) 123-4567', expected: true },
        { phone: '555-123-4567', expected: true },
        { phone: '5551234567', expected: true },
        { phone: '123', expected: false },
        { phone: 'abc-def-ghij', expected: false },
        { phone: '', expected: false },
        { phone: null, expected: false }
      ]

      // Basic phone validation (at least 10 digits)
      const phoneRegex = /[\d\s\-\+\(\)]{10,}/

      phoneTestCases.forEach(({ phone, expected }) => {
        const isValid = phone ? phoneRegex.test(phone) : false
        expect(isValid).toBe(expected)
      })
    })

    it('should validate required fields', () => {
      const requiredFieldTests = [
        { value: 'Valid input', expected: true },
        { value: '   Valid with spaces   ', expected: true },
        { value: '', expected: false },
        { value: '   ', expected: false }, // Only whitespace
        { value: null, expected: false },
        { value: undefined, expected: false }
      ]

      requiredFieldTests.forEach(({ value, expected }) => {
        const isValid = value ? value.trim().length > 0 : false
        expect(isValid).toBe(expected)
      })
    })
  })

  describe('Form Submission Logic', () => {
    it('should validate form completeness before submission', () => {
      const formTestCases = [
        {
          form: { email: 'test@example.com', password: 'Password123!' },
          requiredFields: ['email', 'password'],
          expected: true
        },
        {
          form: { email: 'test@example.com', password: '' },
          requiredFields: ['email', 'password'],
          expected: false
        },
        {
          form: { email: '', password: 'Password123!' },
          requiredFields: ['email', 'password'],
          expected: false
        },
        {
          form: { email: 'test@example.com' },
          requiredFields: ['email', 'password'],
          expected: false
        }
      ]

      formTestCases.forEach(({ form, requiredFields, expected }) => {
        const isFormValid = requiredFields.every(field => {
          const value = (form as any)[field]
          return value && typeof value === 'string' && value.trim().length > 0
        })

        expect(isFormValid).toBe(expected)
      })
    })

    it('should handle form data sanitization', () => {
      const formData = {
        email: '  test@example.com  ',
        name: '  John Doe  ',
        phone: '  +1234567890  '
      }

      const sanitizedData = Object.entries(formData).reduce((acc, [key, value]) => {
        acc[key] = typeof value === 'string' ? value.trim() : value
        return acc
      }, {} as Record<string, any>)

      expect(sanitizedData.email).toBe('test@example.com')
      expect(sanitizedData.name).toBe('John Doe')
      expect(sanitizedData.phone).toBe('+1234567890')
    })

    it('should determine submission readiness', () => {
      const submissionStates = [
        { isLoading: false, isValid: true, expected: true },
        { isLoading: true, isValid: true, expected: false },
        { isLoading: false, isValid: false, expected: false },
        { isLoading: true, isValid: false, expected: false }
      ]

      submissionStates.forEach(({ isLoading, isValid, expected }) => {
        const canSubmit = !isLoading && isValid
        expect(canSubmit).toBe(expected)
      })
    })
  })

  describe('Error State Management Logic', () => {
    it('should manage field-level error states', () => {
      const fieldErrors = {
        email: '',
        password: 'Password too weak',
        confirmPassword: ''
      }

      const hasErrors = Object.values(fieldErrors).some(error => error.length > 0)
      const errorCount = Object.values(fieldErrors).filter(error => error.length > 0).length

      expect(hasErrors).toBe(true)
      expect(errorCount).toBe(1)
    })

    it('should clear errors on valid input', () => {
      const initialErrors = {
        email: 'Invalid email format',
        password: 'Password required'
      }

      // Simulate clearing email error when valid input is provided
      const updatedErrors = {
        ...initialErrors,
        email: '' // Clear email error
      }

      expect(updatedErrors.email).toBe('')
      expect(updatedErrors.password).toBe('Password required')
    })

    it('should handle error message priorities', () => {
      const errorPriorities = [
        { field: 'email', errors: ['Required', 'Invalid format'], expected: 'Required' },
        { field: 'password', errors: ['Too short', 'Missing special char'], expected: 'Too short' },
        { field: 'phone', errors: [], expected: '' }
      ]

      errorPriorities.forEach(({errors, expected }) => {
        const primaryError = errors.length > 0 ? errors[0] : ''
        expect(primaryError).toBe(expected)
      })
    })
  })

  describe('Real-time Validation Logic', () => {
    it('should validate on input change', () => {
      const validationRules = {
        email: (value: string) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value),
        password: (value: string) => value.length >= 8,
        confirmPassword: (value: string, password: string) => value === password
      }

      const testInputs = [
        { field: 'email', value: 'test@example.com', expected: true },
        { field: 'email', value: 'invalid', expected: false },
        { field: 'password', value: 'Password123!', expected: true },
        { field: 'password', value: '123', expected: false }
      ]

      testInputs.forEach(({ field, value, expected }) => {
        const validator = validationRules[field as keyof typeof validationRules]
        const isValid = validator(value, 'Password123!') // Pass password for confirmPassword validation
        expect(isValid).toBe(expected)
      })
    })

    it('should debounce validation calls', () => {
      let validationCallCount = 0

      const mockValidation = () => {
        validationCallCount++
      }

      // Simulate rapid input changes
      const inputChanges = ['t', 'te', 'tes', 'test', 'test@', 'test@example.com']

      // In real implementation, only the last call should execute after debounce
      const shouldValidate = inputChanges.length > 0

      if (shouldValidate) {
        mockValidation()
      }

      expect(validationCallCount).toBe(1) // Only one validation call after debounce
    })
  })

  describe('File Upload Validation Logic', () => {
    it('should validate file types', () => {
      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif']
      const fileTests = [
        { type: 'image/jpeg', expected: true },
        { type: 'image/png', expected: true },
        { type: 'image/gif', expected: true },
        { type: 'image/webp', expected: false },
        { type: 'application/pdf', expected: false },
        { type: 'text/plain', expected: false }
      ]

      fileTests.forEach(({ type, expected }) => {
        const isValidType = allowedTypes.includes(type)
        expect(isValidType).toBe(expected)
      })
    })

    it('should validate file sizes', () => {
      const maxSizeInMB = 5
      const maxSizeInBytes = maxSizeInMB * 1024 * 1024

      const fileSizeTests = [
        { size: 1024 * 1024, expected: true }, // 1MB
        { size: 3 * 1024 * 1024, expected: true }, // 3MB
        { size: 5 * 1024 * 1024, expected: true }, // 5MB (exactly at limit)
        { size: 6 * 1024 * 1024, expected: false }, // 6MB (over limit)
        { size: 10 * 1024 * 1024, expected: false } // 10MB (way over limit)
      ]

      fileSizeTests.forEach(({ size, expected }) => {
        const isValidSize = size <= maxSizeInBytes
        expect(isValidSize).toBe(expected)
      })
    })

    it('should validate file name format', () => {
      const fileNameTests = [
        { name: 'image.jpg', expected: true },
        { name: 'my-file.png', expected: true },
        { name: 'file_name.gif', expected: true },
        { name: 'file with spaces.jpg', expected: true },
        { name: '', expected: false },
        { name: '.jpg', expected: false }, // No name, just extension
        { name: 'file', expected: false } // No extension
      ]

      fileNameTests.forEach(({ name, expected }) => {
        const hasValidName = name.length > 0 && name.includes('.') && !name.startsWith('.')
        expect(hasValidName).toBe(expected)
      })
    })
  })

  describe('Dynamic Form Logic', () => {
    it('should handle conditional field requirements', () => {
      const formStates = [
        {
          userType: 'admin',
          requiredFields: ['email', 'password', 'adminCode'],
          form: { email: 'test@example.com', password: 'Pass123!', adminCode: 'ADMIN123' },
          expected: true
        },
        {
          userType: 'player',
          requiredFields: ['email', 'password'],
          form: { email: 'test@example.com', password: 'Pass123!' },
          expected: true
        },
        {
          userType: 'admin',
          requiredFields: ['email', 'password', 'adminCode'],
          form: { email: 'test@example.com', password: 'Pass123!' }, // Missing adminCode
          expected: false
        }
      ]

      formStates.forEach(({requiredFields, form, expected }) => {
        const isFormComplete = requiredFields.every(field => {
          const value = (form as any)[field]
          return value && typeof value === 'string' && value.trim().length > 0
        })

        expect(isFormComplete).toBe(expected)
      })
    })

    it('should handle multi-step form validation', () => {
      const multiStepForm = {
        step1: { email: 'test@example.com', password: 'Pass123!' },
        step2: { firstName: 'John', lastName: 'Doe' },
        step3: { phone: '+1234567890', country: 'US' }
      }

      const stepValidations = [
        { step: 1, fields: ['email', 'password'], data: multiStepForm.step1 },
        { step: 2, fields: ['firstName', 'lastName'], data: multiStepForm.step2 },
        { step: 3, fields: ['phone', 'country'], data: multiStepForm.step3 }
      ]

      stepValidations.forEach(({ fields, data }) => {
        const isStepValid = fields.every(field => {
          const value = (data as any)[field]
          return value && typeof value === 'string' && value.trim().length > 0
        })

        expect(isStepValid).toBe(true)
      })
    })
  })
})
</file>

<file path="src/components/charts/barChart II.tsx">
import {
	Bar,
	BarChart,
	CartesianGrid,
	XAxis,
	YAxis,
	Tooltip,
	ResponsiveContainer,
	Cell,
} from "recharts";
import { Card, CardContent } from "../ui/card";

interface UserAgeBarChartProps {
	adultsCount: number;
	minorsCount: number;
}

const UserAgeBarChart = ({ adultsCount, minorsCount }: UserAgeBarChartProps) => {
	console.log('Chart Props:', { adultsCount, minorsCount });

	const data = [
		{ name: "users under 18", value: minorsCount, fill: "#F3C4FB" },
		{ name: "users 18 and over", value: adultsCount, fill: "#B86EF7" },
	];

	console.log('Chart Data:', data);

	const maxValue = Math.max(adultsCount, minorsCount);
	console.log('Max Value:', maxValue);

	return (
		<Card className="w-full p-4 bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none rounded-2xl">
			<CardContent>
				<ResponsiveContainer width="100%" height={180}>
					<BarChart layout="vertical" data={data} barGap={40} barCategoryGap={80}>
						<CartesianGrid strokeDasharray="3 3" />
						<XAxis
							type="number"
							domain={[0, maxValue > 0 ? maxValue : 100]}
							tick={{ fill: "#7B8FA1", fontSize: 14, fontFamily: "inherit" }}
							axisLine={false}
							tickLine={false}
						/>
						<YAxis
							type="category"
							dataKey="name"
							width={200}
							tick={{ fill: "#7B8FA1", fontSize: 16, fontFamily: "inherit" }}
							axisLine={false}
							tickLine={false}
						/>
						<Tooltip
							contentStyle={{
								backgroundColor: "#fff",
								border: "1px solid #e2e8f0",
								borderRadius: "0.5rem",
								padding: "0.5rem",
							}}
						/>
						<Bar
							dataKey="value"
							barSize={70}
							radius={[0, 4, 4, 0]}
						>
							{data.map((entry) => (
								<Cell key={entry.name} fill={entry.fill} />
							))}
						</Bar>
					</BarChart>
				</ResponsiveContainer>
			</CardContent>
		</Card>
	);
};

export default UserAgeBarChart;
</file>

<file path="src/components/charts/barChart.tsx">
import { Bar, BarChart, CartesianGrid, XAxis, YAxis, Tooltip, ResponsiveContainer, Cell } from "recharts";
import { Card, CardContent } from "../../components/ui/card";
import { useSignupAnalyticsData } from "../../backend/signup.analytics.service";

const clickTypeLabels: Record<string, string> = {
  "navbar": "Navigation bar sign-up button clicks",
  "signup-modal": "Form sign-up button clicks",
  "popup": "Pop-up sign-up button clicks",
};

const colors = ["#F3C4FB", "#D58DFB", "#B86EF7"];

const HorizontalBarChart = () => {
  const { data: analyticsData, isLoading, error, isError } = useSignupAnalyticsData(30); // Get last 30 days data

  console.log('Bar Chart State:', {
    analyticsData,
    isLoading,
    isError,
    error
  });

  if (isLoading) {
    return (
      <Card className="w-full p-4 bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none rounded-2xl">
        <CardContent className="flex items-center justify-center h-[300px]">
          <div className="text-gray-500">Loading chart data...</div>
        </CardContent>
      </Card>
    );
  }

  if (isError) {
    return (
      <Card className="w-full p-4 bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none rounded-2xl">
        <CardContent className="flex items-center justify-center h-[300px]">
          <div className="text-red-500">Error loading chart data: {error instanceof Error ? error.message : 'Unknown error'}</div>
        </CardContent>
      </Card>
    );
  }

  if (!analyticsData) {
    return (
      <Card className="w-full p-4 bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none rounded-2xl">
        <CardContent className="flex items-center justify-center h-[300px]">
          <div className="text-gray-500">No click data available</div>
        </CardContent>
      </Card>
    );
  }

  interface ChartDataPoint {
    name: string;
    value: number;
    fill: string;
  }

  // Ensure all click types are represented
  const allClickTypes = ["navbar", "signup-modal", "keep-playing"];
  const clicksMap = new Map(
    analyticsData.clicksByType?.map(click => [click.type, parseInt(click.count)]) || []
  );

  const data: ChartDataPoint[] = allClickTypes.map((type, index) => ({
    name: clickTypeLabels[type] || type,
    value: clicksMap.get(type) || 0,
    fill: colors[index % colors.length]
  }));


  return (
    <Card className="w-full p-4 bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none rounded-2xl">
      <CardContent>
        <ResponsiveContainer width="100%" height={300}>
          <BarChart layout="vertical" data={data}>
            <CartesianGrid strokeDasharray="3 3" />
            <XAxis
              type="number"
              domain={[0, Math.max(5, ...data.map((item: ChartDataPoint) => item.value))]}
            />
            <YAxis
              type="category"
              dataKey="name"
              width={200}
              tick={{
                fill: "#64748B",
                fontSize: 12,
                fontFamily: "inherit"
              }}
              tickLine={false}
              axisLine={false}
            />
            <Tooltip
              contentStyle={{
                backgroundColor: '#fff',
                border: '1px solid #e2e8f0',
                borderRadius: '0.5rem',
                padding: '0.5rem'
              }}
            />
            <Bar
              dataKey="value"
              barSize={60}
              fill="#F3C4FB"
              radius={[0, 4, 4, 0]}
            >
              {data.map((entry: ChartDataPoint, index: number) => (
                <Cell key={`cell-${index}`} fill={entry.fill} />
              ))}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
      </CardContent>
    </Card>
  );
};

export default HorizontalBarChart;
</file>

<file path="src/components/charts/donutChart.tsx">
import { useState } from "react";
import { Pie, PieChart, Sector, Tooltip } from "recharts";
import { useDashboardAnalytics } from "../../backend/analytics.service";

const renderActiveShape = (props: { cx: any; cy: any; innerRadius: any; outerRadius: any; startAngle: any; endAngle: any; fill: any; }) => {
  const { cx, cy, innerRadius, outerRadius, startAngle, endAngle, fill } = props;

  return (
    <g>
      <Sector
        cx={cx}
        cy={cy}
        innerRadius={innerRadius}
        outerRadius={outerRadius + 10}
        startAngle={startAngle}
        endAngle={endAngle}
        fill={fill}
      />
    </g>
  );
};

interface ChartData {
  name: string;
  value: number;
  fill: string;
}

// Custom tooltip component
const CustomTooltip = ({ active, payload, data }: { active?: boolean; payload?: any[]; data: ChartData[] }) => {
  if (active && payload && payload.length) {
    const total = data.reduce((sum: number, entry: ChartData) => sum + entry.value, 0);
    return (
      <div className="bg-white p-3 rounded-md shadow-lg border border-gray-200" style={{ position: 'absolute', zIndex: 1000, pointerEvents: 'none' }}>
        <p className="font-medium text-gray-800">{payload[0].name}</p>
        <p className="text-gray-600">Count: <span className="font-semibold">{payload[0].value}</span></p>
        <p className="text-gray-600">Percentage: <span className="font-semibold">
          {((payload[0].value / total) * 100).toFixed(1)}%
        </span></p>
      </div>
    );
  }
  return null;
};

export function DonutChart() {
  const [activeIndex, setActiveIndex] = useState(0);

  const { data: analytics, isLoading } = useDashboardAnalytics();

  const data = [
    { name: "Active users", value: analytics?.activeUsers || 0, fill: "#D946EF" },
    { name: "Non-active", value: analytics?.inactiveUsers || 0, fill: "#F5D0FE" }
  ];

  const total = analytics ? analytics.activeUsers + analytics.inactiveUsers : 0;

  if (isLoading) {
    return (
      <div className="flex justify-center items-center min-h-[300px]">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF]"></div>
      </div>
    );
  }

  return (
    <div className="flex items-start justify-between max-w-3xl mx-auto">
      {/* Left side with chart */}
      <div className="relative w-80 h-80 flex items-center justify-center">
        <PieChart width={300} height={300}>
          <Pie
            data={data}
            cx="50%"
            cy="50%"
            innerRadius={70}
            outerRadius={120}
            dataKey="value"
            stroke="none"
            startAngle={90}
            endAngle={-270}
            activeIndex={activeIndex}
            activeShape={(props: unknown) => renderActiveShape(props as { cx: any; cy: any; innerRadius: any; outerRadius: any; startAngle: any; endAngle: any; fill: any; })}
            onMouseEnter={(_, index) => setActiveIndex(index)}
          />
          <Tooltip content={<CustomTooltip data={data} />} wrapperStyle={{ zIndex: 1000 }} />
        </PieChart>
        <div className="absolute text-6xl font-black text-gray-800 dark:text-white" style={{ fontFamily: 'Impact, sans-serif', zIndex: 1 }}>
          {total}
        </div>
      </div>

      {/* Right side with legend */}
      <div className="mt-12 flex flex-col space-y-4 font-boogaloo">
        <div className="text-xl text-gray-600 font-medium dark:text-white">
          Total number of registered users = {total}
        </div>

        <div className="space-y-3">
          {data.map((_entry, index) => (
            <div
              key={`legend-${index}`}
              className="flex items-center cursor-pointer"
              onMouseEnter={() => setActiveIndex(index)}
            >
              <div className="w-5 h-5 mr-3" style={{ backgroundColor: index === 0 ? "#D946EF" : "#F5D0FE" }}></div>
              <span className="text-lg text-gray-600 dark:text-white">
                {index === 0 ? "Active users" : "Non-active"} = {_entry.value}
              </span>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/components/charts/LineChart.tsx">
// import React from "react";
import {
  LineChart as ReLineChart,
  Line,
  XAxis,
  YAxis,
  Tooltip,
  ResponsiveContainer,
//   Legend,
  CartesianGrid,
} from "recharts";

const data = [
  { time: "00-04hrs", today: 12, yesterday: 8 },
  { time: "04-08hrs", today: 7, yesterday: 14 },
  { time: "08-12hrs", today: 15, yesterday: 22 },
  { time: "12-16hrs", today: 20, yesterday: 13 },
  { time: "16-20hrs", today: 17, yesterday: 19 },
  { time: "20-24hrs", today: 21, yesterday: 28 },
];

const CustomLegend = () => (
  <div className="flex items-center gap-6 px-6 pt-6 pb-2">
    <span className="text-2xl">Peak Gaming Times</span>
    <div className="flex items-center gap-4 ml-2">
      <span className="flex items-center gap-2">
        <span className="text-2xl text-[#475568] mr-3">|</span>
        <span className="inline-block w-3 h-3 rounded-full bg-[#D946EF]" />
        <span className="font-thin text-[#475568] text-sm">Today</span>
      </span>
      <span className="flex items-center gap-2">
        <span className="inline-block w-3 h-3 rounded-full border-2 border-[#D946EF]" />
        <span className="font-thin text-[#475568] text-sm">Yesterday</span>
      </span>
    </div>
    <span className="ml-auto text-[#D946EF] font-normal">Last 24 hours </span>
  </div>
);

export default function LineChart() {
  return (
    <div className="rounded-2xl p-0 w-full h-[320px] font-thin">
      <CustomLegend />
      <ResponsiveContainer width="100%" height="80%">
        <ReLineChart data={data} margin={{ top: 10, right: 30, left: 30, bottom: 10 }}>
          <CartesianGrid vertical={false} strokeDasharray="3 3" stroke="#E5E7EB" />
          <XAxis
            dataKey="time"
            tick={{ fill: "#64748A", fontSize: 14, fontFamily: "inherit" }}
            axisLine={false}
            tickLine={false}
          />
          <YAxis
            domain={[0, 32]}
            tick={{ fill: "#64748A", fontSize: 14, fontFamily: "inherit" }}
            axisLine={false}
            tickLine={false}
            tickFormatter={(v) => `${v}K`}
            width={40}
          />
          <Tooltip
            contentStyle={{
              background: "#fff",
              borderRadius: 8,
              border: "none",
              boxShadow: "0 2px 8px #0001",
              fontFamily: "inherit",
            }}
            labelStyle={{ color: "#64748A", fontWeight: 500 }}
            formatter={(value: number) => `${value}k`}
          />
          <Line
            type="monotone"
            dataKey="today"
            stroke="#D946EF"
            strokeWidth={1}
            dot={false}
            activeDot={{ r: 6, fill: "#D946EF", stroke: "#fff", strokeWidth: 2 }}
          />
          <Line
            type="monotone"
            dataKey="yesterday"
            stroke="#D946EF"
            strokeWidth={1}
            strokeDasharray="6 6"
            dot={false}
            activeDot={{ r: 6, fill: "#fff", stroke: "#D946EF", strokeWidth: 2 }}
          />
        </ReLineChart>
      </ResponsiveContainer>
    </div>
  );
}
</file>

<file path="src/components/charts/piechart.tsx">
"use client"

import { Pie, PieChart, Tooltip } from "recharts"

import {
  Card,
  CardContent,
//   CardDescription,
  CardHeader,
//   CardTitle,
} from "../ui/card"
// import {
//   type ChartConfig,
//   ChartContainer,
//   ChartLegend,
//   ChartLegendContent,
// } from "./chart"
interface ChartData {
  name: string;
  value: number;
  fill: string;
}

interface PieChartProps {
  data: ChartData[];
}

export default function Component({ data }: PieChartProps) {
  const totalClicks = data.reduce((sum, entry) => sum + entry.value, 0);
  return (
    <Card className="flex flex-col shadow-none border border-none bg-[#F8FAFC] dark:bg-[#0F1221]">
      <CardHeader className="items-center pb-0">
      </CardHeader>
      <CardContent className="flex-1 pb-0 flex flex-col items-center">
        <PieChart width={250} height={250}>
          <Pie
            data={data}
            dataKey="value"
            nameKey="name"
            cx="50%"
            cy="50%"
            outerRadius={100}
            paddingAngle={0}
            stroke="none"
            label={false}
            // No activeShape, no onClick, no activeIndex
          />
          <Tooltip
            contentStyle={{ background: "#fff", border: "none", borderRadius: 8, boxShadow: "0 2px 8px rgba(0,0,0,0.08)" }}
            itemStyle={{ color: "#5B6B7A", fontSize: 16 }}
            formatter={(value: number, name: string) => [`${value}`, name]}
          />
        </PieChart>
        <div className="text-center font-bold text-2xl mt-2 dark:text-white text-[#5B6B7A] tracking-wider">
          Total Clicks = {totalClicks}
        </div>
        <div className="flex justify-center gap-8 mt-4">
          {data.map((item, index) => (
            <div key={index} className="flex items-center gap-2">
              <span style={{
                display: "inline-block",
                width: 20,
                height: 20,
                background: item.fill,
                borderRadius: 4,
              }} />
              <span className="text-[#5B6B7A] dark:text-white text-[18px]">
                {item.name} = {item.value}
              </span>
            </div>
          ))}
        </div>
      </CardContent>
    </Card>
  )
}
</file>

<file path="src/components/modals/AdminModals/AcceptInvitationModal.tsx">
import React, { useState } from "react";
import { FaEye, FaEyeSlash } from 'react-icons/fa';

interface AcceptInvitationModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  isExistingUser: boolean;
}

export const AcceptInvitationModal: React.FC<AcceptInvitationModalProps> = ({
  open,
  onOpenChange,
  isExistingUser,
}) => {
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  if (!open) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/50">
      <div className="bg-[#F1F5F9] rounded-2xl p-4 sm:p-6 md:p-8 w-[90%] sm:w-[420px] md:w-[450px] lg:w-[480px] max-w-[90vw] shadow-xl border border-[#E2E8F0] flex flex-col items-center mx-4">
        <h2 className="text-2xl sm:text-3xl font-bold text-[#D946EF] mb-4 sm:mb-6 underline underline-offset-4 text-center font-boogaloo">
          Accept Invitation
        </h2>
        <form className="w-full flex flex-col gap-4">
          {isExistingUser ? (
            <>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Email</label>
                <input
                  type="email"
                  className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 text-gr text-xl tracking-wider"
                  placeholder="user@email.com"
                  disabled
                />
              </div>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Reset Password</label>
                <div className="relative">
                  <input
                    type={showPassword ? "text" : "password"}
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="New password"
                  />
                  <span
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                    onClick={() => setShowPassword((prev) => !prev)}
                  >
                    {showPassword ? <FaEye size={15} /> : <FaEyeSlash size={15} />}
                  </span>
                </div>
              </div>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Confirm New Password</label>
                <div className="relative">
                  <input
                    type={showConfirmPassword ? "text" : "password"}
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="Confirm password"
                  />
                  <span
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                    onClick={() => setShowConfirmPassword((prev) => !prev)}
                  >
                    {showConfirmPassword ? <FaEye size={15} /> : <FaEyeSlash size={15} />}
                  </span>
                </div>
              </div>
              <button
                type="submit"
                className="w-full mt-4 bg-[#D946EF] text-white font-bold py-2 sm:py-3 rounded-lg text-base sm:text-lg tracking-wider"
              >
                Login
              </button>
            </>
          ) : (
            <>
              <div className="flex gap-4">
                <div className="flex-1">
                  <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">First Name</label>
                  <input
                    type="text"
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="First name"
                  />
                </div>
                <div className="flex-1">
                  <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Last Name</label>
                  <input
                    type="text"
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="Last Name"
                  />
                </div>
              </div>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Phone Number</label>
                <input
                  type="tel"
                  className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                  placeholder="Number"
                />
              </div>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Reset Password</label>
                <div className="relative">
                  <input
                    type={showPassword ? "text" : "password"}
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="New password"
                  />
                  <span
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                    onClick={() => setShowPassword((prev) => !prev)}
                  >
                    {showPassword ? <FaEye size={15} /> : <FaEyeSlash size={15} />}
                  </span>
                </div>
              </div>
              <div>
                <label className="block font-bold text-base sm:text-lg mb-1 font-boogaloo tracking-wider">Confirm New Password</label>
                <div className="relative">
                  <input
                    type={showConfirmPassword ? "text" : "password"}
                    className="w-full rounded-lg bg-gray-200 px-3 sm:px-4 py-2 sm:py-3 font-pincuk text-xl tracking-wider"
                    placeholder="Confirm password"
                  />
                  <span
                    className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                    onClick={() => setShowConfirmPassword((prev) => !prev)}
                  >
                    {showConfirmPassword ? <FaEye size={15} /> : <FaEyeSlash size={15} />}
                  </span>
                </div>
              </div>
              <button
                type="submit"
                className="w-full mt-4 bg-[#D946EF] text-white font-bold py-2 sm:py-3 rounded-lg text-base sm:text-lg tracking-wider"
              >
                Sign Up
              </button>
            </>
          )}
        </form>
        <button
          className="absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
        >
          &times;
        </button>
      </div>
    </div>
  );
};
</file>

<file path="src/components/modals/AdminModals/ActivityLogExportModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
import { useState } from "react";
import { Button } from "../../ui/button";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from "../../ui/dialog";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "../../ui/tabs";
import { Card } from "../../ui/card";
import { Download, FileSpreadsheet, FileJson, File } from "lucide-react";
import * as XLSX from "xlsx";
import { format } from "date-fns";
import { toast } from "sonner";
import type { TDocumentDefinitions } from "pdfmake/interfaces";

// We'll load pdfMake dynamically to avoid font loading issues
let pdfMake: any;

interface ActivityLogData {
  name?: string;
  userStatus?: string;
  activity?: string;
  lastGamePlayed?: string;
  startTime?: Date;
  endTime?: Date;
  // Allow for any additional properties from the API
  [key: string]: any;
}

interface ActivityLogExportModalProps {
  data: ActivityLogData[];
  title?: string;
  description?: string;
}

const ActivityLogExportModal = ({
  data,
  title = "Export Activity Log",
  description = "Choose the format you'd like to export your activity log data"
}: ActivityLogExportModalProps) => {
  const [open, setOpen] = useState(false);

  const formatActivityDataForExport = (activities: ActivityLogData[]) => {
    return activities.map(activity => ({
      Name: activity.name?.trim() || "-",
      "User Status": activity.userStatus || "Offline",
      Activity: activity.activity || "-",
      "Last Game Played": activity.lastGamePlayed || "-",
      "Start Time": activity.startTime ? format(new Date(activity.startTime), "HH:mm") : "-",
      "End Time": activity.endTime ? format(new Date(activity.endTime), "HH:mm") : "-",
      "Start Date": activity.startTime ? format(new Date(activity.startTime), "yyyy-MM-dd") : "-",
      "End Date": activity.endTime ? format(new Date(activity.endTime), "yyyy-MM-dd") : "-"
    }));
  };

  const handleExportCSV = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No activity log data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting activity log as CSV...");

      const formattedData = formatActivityDataForExport(data);
      const worksheet = XLSX.utils.json_to_sheet(formattedData);
      const csvData = XLSX.utils.sheet_to_csv(worksheet);
      const blob = new Blob([csvData], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = `user_activity_log_${format(new Date(), "yyyy-MM-dd_HH-mm")}.csv`;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("CSV file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export CSV file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportXLS = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No activity log data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting activity log as XLS...");

      const filename = `user_activity_log_${format(new Date(), "yyyy-MM-dd_HH-mm")}.xlsx`;
      const formattedData = formatActivityDataForExport(data);
      const workbook = XLSX.utils.book_new();
      const worksheet = XLSX.utils.json_to_sheet(formattedData);
      XLSX.utils.book_append_sheet(workbook, worksheet, "Activity Log");

      const xlsData = XLSX.write(workbook, { bookType: "xlsx", type: "array" });
      const blob = new Blob([xlsData], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
      });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");

      link.href = url;
      link.download = filename;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("XLS file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export XLS file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportJSON = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No activity log data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting activity log as JSON...");

      const filename = `user_activity_log_${format(new Date(), "yyyy-MM-dd_HH-mm")}.json`;
      const formattedData = formatActivityDataForExport(data);
      const jsonString = JSON.stringify(formattedData, null, 2);
      const blob = new Blob([jsonString], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");

      link.href = url;
      link.download = filename;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("JSON file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export JSON file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportPDF = async () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No activity log data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Generating activity log PDF report...");

      // Dynamically import pdfMake and fonts
      if (!pdfMake) {
        pdfMake = (await import("pdfmake/build/pdfmake")).default;
        const pdfFonts = await import("pdfmake/build/vfs_fonts");
        pdfMake.vfs = (pdfFonts as any).vfs;
      }

      // Transform data for the table
      const tableBody = data.map(activity => [
        { text: activity.name?.trim() || "-", alignment: 'left', margin: [8, 4] },
        {
          text: activity.userStatus || "Offline",
          alignment: 'center',
          margin: [8, 4],
          color: activity.userStatus === "Online" ? '#4BA366' : '#E74C3C'
        },
        { text: activity.activity || "-", alignment: 'left', margin: [8, 4] },
        { text: activity.lastGamePlayed || "-", alignment: 'left', margin: [8, 4] },
        {
          text: activity.startTime ? format(new Date(activity.startTime), "HH:mm") : "-",
          alignment: 'center',
          margin: [8, 4]
        },
        {
          text: activity.endTime ? format(new Date(activity.endTime), "HH:mm") : "-",
          alignment: 'center',
          margin: [8, 4]
        }
      ]);

      // Calculate summary statistics
      const totalActivities = data.length;
      const onlineUsers = data.filter(activity => activity.userStatus === "Online").length;
      const offlineUsers = totalActivities - onlineUsers;
      const activitiesWithGames = data.filter(activity => activity.lastGamePlayed && activity.lastGamePlayed !== "-").length;
      const activitiesWithStartTime = data.filter(activity => activity.startTime).length;
      const activitiesWithEndTime = data.filter(activity => activity.endTime).length;

      const docDefinition: TDocumentDefinitions = {
        pageSize: { width: 842, height: 595 },
        pageMargins: [40, 40, 40, 40],
        pageOrientation: 'landscape',
        content: [
          {
            text: 'User Activity Log Report',
            style: 'header',
            alignment: 'center',
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: `Generated on ${format(new Date(), "MMMM dd, yyyy 'at' HH:mm")}`,
            alignment: 'center',
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: 'Activity Summary',
            style: 'subheader',
            margin: [0, 0, 0, 10] as [number, number, number, number]
          },
          {
            columns: [
              {
                width: 'auto',
                text: [
                  { text: 'Total Activities: ', bold: true }, `${totalActivities}\n`,
                  { text: 'Online Users: ', bold: true }, `${onlineUsers}\n`,
                  { text: 'Offline Users: ', bold: true }, `${offlineUsers}\n`,
                ]
              },
              {
                width: 'auto',
                text: [
                  { text: 'Activities with Games: ', bold: true }, `${activitiesWithGames}\n`,
                  { text: 'Activities with Start Time: ', bold: true }, `${activitiesWithStartTime}\n`,
                  { text: 'Activities with End Time: ', bold: true }, `${activitiesWithEndTime}\n`,
                ]
              }
            ],
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: 'Detailed Activity Log',
            style: 'subheader',
            margin: [0, 0, 0, 10] as [number, number, number, number]
          },
          {
            table: {
              headerRows: 1,
              widths: [120, 80, 150, 150, 80, 80] as number[],
              body: [
                [
                  { text: 'Name', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Status', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'Activity', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Last Game Played', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Start Time', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'End Time', style: 'tableHeader', alignment: 'center', margin: [8, 4] }
                ],
                ...tableBody
              ]
            }
          }
        ],
        styles: {
          header: {
            fontSize: 18,
            bold: true,
            color: '#D946EF'
          },
          subheader: {
            fontSize: 14,
            bold: true,
            margin: [0, 10, 0, 5] as [number, number, number, number]
          },
          tableHeader: {
            bold: true,
            fillColor: '#F3F4F6',
            fontSize: 11
          }
        },
        defaultStyle: {
          fontSize: 10,
          lineHeight: 1.4
        }
      };

      const pdfDoc = pdfMake.createPdf(docDefinition);

      // Get the PDF as a blob
      pdfDoc.getBlob((blob: any) => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = `user_activity_log_${format(new Date(), "yyyy-MM-dd_HH-mm")}.pdf`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);

        // toast.dismiss(loadingToast);
        // toast.success("PDF report generated successfully");
        setOpen(false);
      });
    } catch (error) {
      toast.error(`Failed to generate PDF report: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button className="bg-[#D946EF] text-white hover:bg-[#c026d3] tracking-wider py-2">
          <Download size={16} className="mr-2" />
          Export
        </Button>
      </DialogTrigger>
      <DialogContent className="sm:max-w-md dark:bg-[#18192b]">
        <DialogHeader>
          <DialogTitle>{title}</DialogTitle>
          <DialogDescription>{description}</DialogDescription>
        </DialogHeader>

        <Tabs defaultValue="data" className="w-full">
          <TabsList className="grid w-full grid-cols-2 dark:bg-[#121C2D]">
            <TabsTrigger value="data">Activity Data</TabsTrigger>
            <TabsTrigger value="statistics">Statistics</TabsTrigger>
          </TabsList>

          <TabsContent value="data" className="mt-4">
            <div className="grid grid-cols-3 gap-4">
              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer dark:bg-[#121C2D] transition-colors shadow-sm">
                <button
                  onClick={handleExportCSV}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileSpreadsheet className="h-12 w-12 text-green-600 mb-2" />
                  <span className="text-sm font-medium">CSV</span>
                </button>
              </Card>

              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm dark:bg-[#121C2D]">
                <button
                  onClick={handleExportXLS}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileSpreadsheet className="h-12 w-12 text-blue-600 mb-2" />
                  <span className="text-sm font-medium">XLS</span>
                </button>
              </Card>

              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm dark:bg-[#121C2D]">
                <button
                  onClick={handleExportJSON}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileJson className="h-12 w-12 text-amber-600 mb-2" />
                  <span className="text-sm font-medium">JSON</span>
                </button>
              </Card>
            </div>
          </TabsContent>

          <TabsContent value="statistics" className="mt-4">
            <Card className="flex items-center p-6 hover:bg-gray-50 cursor-pointer transition-colors dark:bg-[#121C2D]">
              <button
                onClick={handleExportPDF}
                className="w-full flex items-center gap-4 justify-center"
              >
                <File className="h-12 w-12 text-red-600" />
                <div className="text-left">
                  <h3 className="font-medium">Download Activity Report</h3>
                  <p className="text-sm text-gray-500">
                    Get a PDF report with activity statistics
                  </p>
                </div>
              </button>
            </Card>
          </TabsContent>
        </Tabs>

        <DialogFooter className="sm:justify-start">
          <Button variant="outline" onClick={() => setOpen(false)}>
            Cancel
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
};

export default ActivityLogExportModal;
</file>

<file path="src/components/modals/AdminModals/CreateNewPassModal.tsx">
import React, { useState } from 'react';
import { Button } from '../../ui/button';
import { IoIosArrowBack } from "react-icons/io";
// import { OTPModal } from './OTPModal';
import { FaEye, FaEyeSlash } from 'react-icons/fa';

interface ResetPasswordModalProps {
  open: boolean;
  onClose: () => void;
}

export default function CreateNewPassModal({ open, onClose }: ResetPasswordModalProps) {
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  if (!open) return null;

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // TODO: Implement send reset email logic
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-white">
      {/* Back Button (Top Left of Fullscreen Modal) */}
      <Button
        className="absolute top-4 left-4 text-black hover:bg-transparent px-3 py-2 flex items-center gap-2 border border-gray-400 bg-transparent"
        onClick={onClose}
      >
        <IoIosArrowBack /> Back
      </Button>

      <div className="bg-[#F1F5F9] rounded-2xl p-10 w-[500px] max-w-full shadow-none border border-[#E2E8F0] flex flex-col items-center relative">
        <h2 className="text-3xl font-bold text-[#D946EF] mb-8 underline underline-offset-4 text-center font-boogaloo tracking-wider">
          Create New Password
        </h2>
        <form className="w-full flex flex-col gap-6" onSubmit={handleSubmit}>
          <div>
            <label className="block font-bold text-2xl mb-2 font-boogaloo tracking-wider">Set New Password</label>
            <div className="relative">
              <input
                type={showPassword ? "text" : "password"}
                className="w-full rounded-lg bg-gray-200 px-4 py-3 font-pincuk text-xl tracking-wider"
                placeholder="New password"
              />
              <span
                className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                onClick={() => setShowPassword((prev) => !prev)}
              >
                {showPassword ? <FaEye size={15} className='text-white' /> : <FaEyeSlash size={15} className='text-white' />}
              </span>
            </div>
          </div>
          <div>
            <label className="block font-bold text-lg mb-1 font-boogaloo tracking-wider">Confirm New Password</label>
            <div className="relative">
              <input
                type={showConfirmPassword ? "text" : "password"}
                className="w-full rounded-lg bg-gray-200 px-4 py-3 font-pincuk text-xl tracking-wider"
                placeholder="Confirm password"
              />
              <span
                className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                onClick={() => setShowConfirmPassword((prev) => !prev)}
              >
                {showConfirmPassword ? <FaEye size={15} className='text-white' /> : <FaEyeSlash size={15} className='text-white' />}
              </span>
            </div>
          </div>
          <button
            type="submit"
            className="w-full mt-4 bg-[#D946EF] text-white font-bold py-3 rounded-lg text-lg tracking-wider"
          >
            Login
          </button>
        </form>
      </div>
    </div>
  );
}
</file>

<file path="src/components/modals/AdminModals/ExportModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
import { useState } from "react";
import { Button } from "../../ui/button";
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from "../../ui/dialog";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "../../ui/tabs";
import { Card } from "../../ui/card";
import { Download, FileSpreadsheet, FileJson, File } from "lucide-react";
import * as XLSX from "xlsx";
import { format } from "date-fns";
import { toast } from "sonner";
import type { TDocumentDefinitions } from "pdfmake/interfaces";

// We'll load pdfMake dynamically to avoid font loading issues
let pdfMake: any;

interface ExportModalProps {
  data: any[];
  title?: string;
  description?: string;
}

const ExportModal = ({
  data,
  title = "Export Data",
  description = "Choose the format you'd like to export your data"
}: ExportModalProps) => {
  const [open, setOpen] = useState(false);

  const handleExportCSV = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting data as CSV...");

      const worksheet = XLSX.utils.json_to_sheet(data);
      const csvData = XLSX.utils.sheet_to_csv(worksheet);
      const blob = new Blob([csvData], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = `user_management_${format(new Date(), "yyyy-MM-dd_HH-mm")}.csv`;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("CSV file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export CSV file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportXLS = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting data as XLS...");

      const filename = `user_management_${format(new Date(), "yyyy-MM-dd_HH-mm")}.xlsx`;
      const workbook = XLSX.utils.book_new();
      const worksheet = XLSX.utils.json_to_sheet(data);
      XLSX.utils.book_append_sheet(workbook, worksheet, "Sheet1");

      const xlsData = XLSX.write(workbook, { bookType: "xlsx", type: "array" });
      const blob = new Blob([xlsData], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
      });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");

      link.href = url;
      link.download = filename;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("XLS file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export XLS file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportJSON = () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Exporting data as JSON...");

      const filename = `user_management_${format(new Date(), "yyyy-MM-dd_HH-mm")}.json`;
      const jsonString = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonString], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");

      link.href = url;
      link.download = filename;

      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      // toast.dismiss(loadingToast);
      // toast.success("JSON file exported successfully");
      setOpen(false);
    } catch (error) {
      toast.error(`Failed to export JSON file: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  const handleExportPDF = async () => {
    try {
      if (!data || data.length === 0) {
        toast.info("No data available to export.");
        return;
      }

      // const loadingToast = toast.loading("Generating PDF report...");

      // Dynamically import pdfMake and fonts
      if (!pdfMake) {
        pdfMake = (await import("pdfmake/build/pdfmake")).default;
        const pdfFonts = await import("pdfmake/build/vfs_fonts");
        pdfMake.vfs = (pdfFonts as any).vfs;
      }

      // Transform data for the table
      const tableBody = data.map(user => [
        { text: `${user.firstName || ""} ${user.lastName || ""}`, alignment: 'left', margin: [8, 4] },
        { text: user.email || "-", alignment: 'left', margin: [8, 4] },
        { text: user.phoneNumber || "-", alignment: 'left', margin: [8, 4] },
        { text: format(new Date(user.createdAt), "dd/MM/yy"), alignment: 'center', margin: [8, 4] },
        { text: user.analytics?.totalGamesPlayed || 0, alignment: 'center', margin: [8, 4] },
        { text: user.analytics?.totalTimePlayed ? Math.floor(user.analytics.totalTimePlayed / 60) + " minutes" : "0 minutes", alignment: 'center', margin: [8, 4] },
        { text: user.analytics?.totalSessionCount || 0, alignment: 'center', margin: [8, 4] },
        { text: user.lastLoggedIn ? format(new Date(user.lastLoggedIn), "dd/MM/yy HH:mm") : "Never logged in", alignment: 'center', margin: [8, 4] }
      ]);

      // Calculate summary statistics
      const totalUsers = data.length;
      const activeUsers = data.filter(user => user.isActive).length;
      const totalSessions = data.reduce((sum, user) => sum + (user.analytics?.totalSessionCount || 0), 0);
      const totalGamesPlayed = data.reduce((sum, user) => sum + (user.analytics?.totalGamesPlayed || 0), 0);
      const avgSessionsPerUser = totalUsers ? (totalSessions / totalUsers).toFixed(2) : 0;

      const docDefinition: TDocumentDefinitions = {
        pageSize: { width: 842, height: 595 },
        pageMargins: [40, 40, 40, 40],
        pageOrientation: 'landscape',
        content: [
          {
            text: 'User Management Statistics Report',
            style: 'header',
            alignment: 'center',
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: `Generated on ${format(new Date(), "MMMM dd, yyyy 'at' HH:mm")}`,
            alignment: 'center',
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: 'Summary Statistics',
            style: 'subheader',
            margin: [0, 0, 0, 10] as [number, number, number, number]
          },
          {
            columns: [
              {
                width: 'auto',
                text: [
                  { text: 'Total Users: ', bold: true }, `${totalUsers}\n`,
                  { text: 'Active Users: ', bold: true }, `${activeUsers}\n`,
                  { text: 'Total Sessions: ', bold: true }, `${totalSessions}\n`,
                ]
              },
              {
                width: 'auto',
                text: [
                  { text: 'Total Games Played: ', bold: true }, `${totalGamesPlayed}\n`,
                  { text: 'Avg Sessions/User: ', bold: true }, `${avgSessionsPerUser}\n`,
                ]
              }
            ],
            margin: [0, 0, 0, 20] as [number, number, number, number]
          },
          {
            text: 'Detailed User Data',
            style: 'subheader',
            margin: [0, 0, 0, 10] as [number, number, number, number]
          },
          {
            table: {
              headerRows: 1,
              widths: [110, 140, 80, 80, 50, 70, 50, 120] as number[],
              body: [
                [
                  { text: 'Name', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Email', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Phone', style: 'tableHeader', alignment: 'left', margin: [8, 4] },
                  { text: 'Registration Date', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'Games Played', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'Time Played', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'Sessions', style: 'tableHeader', alignment: 'center', margin: [8, 4] },
                  { text: 'Last Login', style: 'tableHeader', alignment: 'center', margin: [8, 4] }
                ],
                ...tableBody
              ]
            }
          }
        ],
        styles: {
          header: {
            fontSize: 18,
            bold: true,
            color: '#D946EF'
          },
          subheader: {
            fontSize: 14,
            bold: true,
            margin: [0, 10, 0, 5] as [number, number, number, number]
          },
          tableHeader: {
            bold: true,
            fillColor: '#F3F4F6',
            fontSize: 11
          }
        },
          defaultStyle: {
            fontSize: 10,
            lineHeight: 1.4
        }
      };

      const pdfDoc = pdfMake.createPdf(docDefinition);

      // Get the PDF as a blob
      pdfDoc.getBlob((blob: any) => {
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = `user_management_${format(new Date(), "yyyy-MM-dd_HH-mm")}.pdf`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);

        // toast.dismiss(loadingToast);
        // toast.success("PDF report generated successfully");
        setOpen(false);
      });
    } catch (error) {
      toast.error(`Failed to generate PDF report: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button variant="outline" className="border-[#475568] text-[#475568] flex items-center gap-2 dark:text-white py-5">
          <Download size={16} />
          Export Data
        </Button>
      </DialogTrigger>
      <DialogContent className="sm:max-w-md dark:bg-[#18192b]">
        <DialogHeader>
          <DialogTitle>{title}</DialogTitle>
          <DialogDescription>{description}</DialogDescription>
        </DialogHeader>

        <Tabs defaultValue="data" className="w-full">
          <TabsList className="grid w-full grid-cols-2 dark:bg-[#121C2D]">
            <TabsTrigger value="data">User Data</TabsTrigger>
            <TabsTrigger value="statistics">Statistics</TabsTrigger>
          </TabsList>

          <TabsContent value="data" className="mt-4">
            <div className="grid grid-cols-3 gap-4">
              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer dark:bg-[#121C2D] transition-colors shadow-sm">
                <button
                  onClick={handleExportCSV}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileSpreadsheet className="h-12 w-12 text-green-600 mb-2" />
                  <span className="text-sm font-medium">CSV</span>
                </button>
              </Card>

              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm dark:bg-[#121C2D]">
                <button
                  onClick={handleExportXLS}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileSpreadsheet className="h-12 w-12 text-blue-600 mb-2" />
                  <span className="text-sm font-medium">XLS</span>
                </button>
              </Card>

              <Card className="flex flex-col items-center p-4 hover:bg-gray-50 cursor-pointer transition-colors shadow-sm dark:bg-[#121C2D]">
                <button
                  onClick={handleExportJSON}
                  className="w-full h-full flex flex-col items-center"
                >
                  <FileJson className="h-12 w-12 text-amber-600 mb-2" />
                  <span className="text-sm font-medium">JSON</span>
                </button>
              </Card>
            </div>
          </TabsContent>

          <TabsContent value="statistics" className="mt-4">
            <Card className="flex items-center p-6 hover:bg-gray-50 cursor-pointer transition-colors dark:bg-[#121C2D]">
              <button
                onClick={handleExportPDF}
                className="w-full flex items-center gap-4 justify-center"
              >
                <File className="h-12 w-12 text-red-600" />
                <div className="text-left">
                  <h3 className="font-medium">Download Statistics</h3>
                  <p className="text-sm text-gray-500">
                    Get a PDF report with all statistics
                  </p>
                </div>
              </button>
            </Card>
          </TabsContent>
        </Tabs>

        <DialogFooter className="sm:justify-start">
          <Button variant="outline" onClick={() => setOpen(false)}>
            Cancel
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
};

export default ExportModal;
</file>

<file path="src/components/modals/AdminModals/LoginModal.tsx">
import React, { useState } from 'react';

import { LuEye } from "react-icons/lu";
import { LuEyeOff } from "react-icons/lu";

import ResetPasswordModal from './ResetPasswordModal';
import { useNavigate } from 'react-router-dom';

interface AdminLoginModalProps {
  open: boolean;
  onClose: () => void;
  email?: string;
}

export default function LoginModal({ open, email }: AdminLoginModalProps) {
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [resetOpen, setResetOpen] = useState(false);

  const navigate = useNavigate();


  if (!open) return null;

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // TODO: Implement password reset logic
  };

  const handleHome = () => {
    // TODO: Implement home logic
    navigate("/admin")
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-white">
      <div className="bg-[#F1F5F9] rounded-2xl p-10 w-[420px] max-w-full shadow-none border border-[#E2E8F0] flex flex-col items-center relative">
        <h2 className="text-3xl font-bold text-[#D946EF] mb-6 underline underline-offset-4 text-center font-boogaloo tracking-wider">
          Login
        </h2>
        <form className="w-full flex flex-col gap-4" onSubmit={handleSubmit}>
          <div>
            <label className="block font-bold text-lg mb-1 font-boogaloo tracking-wider">Email</label>
            <input
              type="email"
              className="w-full rounded-lg bg-[#E2E8F0] px-4 py-3 text-gray-500 font-pincuk text-xl tracking-wider border border-[#CBD5E0]"
              placeholder="Email.com"
              value={email || ''}
              disabled
            />
          </div>
          <div>
            <label className="block font-bold text-lg mb-1 font-boogaloo tracking-wider">Password</label>
            <div className="relative">
              <input
                type={showPassword ? "text" : "password"}
                className="w-full rounded-lg bg-[#E2E8F0] px-4 py-3 font-pincuk text-xl tracking-wider border border-[#CBD5E0]"
                placeholder="password"
                value={password}
                onChange={e => setPassword(e.target.value)}
              />
              <span
                className="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer"
                onClick={() => setShowPassword(v => !v)}
                aria-label={showPassword ? "Hide password" : "Show password"}
              >
                {showPassword ? (
                  // Eye closed icon
                  <LuEyeOff className='w-6 h-6' />
                ) : (
                  // Eye open icon
                  <LuEye className='w-6 h-6' />
                )}
              </span>
            </div>
          </div>
          <button
            type="submit"
            className="w-full mt-4 bg-[#D946EF] text-white font-bold py-3 rounded-lg text-lg tracking-wider"
            onClick={handleHome}
          >
            Login
          </button>
          <div className='mt-2 text-[#D946EF]'>
            <p
              className='text-2xl hover:underline cursor-pointer'
              onClick={() => setResetOpen(true)}
            >
              Reset Password
            </p>
          </div>
        </form>
      </div>
      <ResetPasswordModal open={resetOpen} onClose={() => setResetOpen(false)} />
    </div>
  );
}
</file>

<file path="src/components/modals/AdminModals/OTPModal.tsx">
import React, { useState } from "react";
import { Button } from "../../ui/button";
import { IoIosArrowBack } from "react-icons/io";
import OTPInput from "react-otp-input";
import CreateNewPassModal from "./CreateNewPassModal";

interface OTPModalProps {
  open: boolean;
  onClose: () => void;
}

export function OTPModal({ open, onClose }: OTPModalProps) {
  const [otp, setOtp] = useState("235");
    const [newPassOpen, setNewPassOpen] = useState(false);

  if (!open) return null;

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // TODO: Implement send reset email logic
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-white">
      {/* Back Button (Top Left of Fullscreen Modal) */}
      <Button
        className="absolute top-4 left-4 text-black hover:bg-transparent px-3 py-2 flex items-center gap-2 border border-gray-400 bg-transparent"
        onClick={onClose}
      >
        <IoIosArrowBack /> Back
      </Button>

      <div className="bg-white rounded-2xl p-10 w-[500px] max-w-full shadow-none border border-none flex flex-col items-center relative">
        <form className="w-full flex flex-col gap-6 justify-start" onSubmit={handleSubmit}>
          <div>
            <label className="block text-4xl mb-2 font-boogaloo tracking-wider">
              Verify Account
            </label>
            <p className="font-pincuk text-xl tracking-wider mb-8">
              Enter the verification code we just sent via email
            </p>
            <div className="flex justify-start">
              <OTPInput
                value={otp}
                onChange={setOtp}
                numInputs={6}
                renderInput={(props, idx) => {
                  const isFilled = !!otp[idx];
                  return (
                    <div className="px-2 py-0 border-1 border-[#E328AF] mx-4 rounded">
                      <input
                        {...props}
                        readOnly={isFilled}
                        className="w-12 h-12 text-center bg-transparent rounded-none dark:text-white text-black font-boogaloo text-2xl font-bold mx-1 focus:outline-none focus:ring-0"
                      />
                    </div>
                  );
                }}
                inputType="tel"
                shouldAutoFocus
                placeholder=""
              />
            </div>
          </div>
          <button
            type="submit"
            className="w-full mt-2 bg-[#D946EF] text-white py-3 rounded-xl text-lg tracking-wider"
            onClick={() => setNewPassOpen(true)}
          >
            Verify
          </button>
        </form>
        <div className="flex mt-4 items-center gap-2">
        <p className="font-pincuk text-xl tracking-wider">Didn't recieve a code?</p>
        <p className="text-[#D946EF] hover:underline">Resend</p>
        </div>
      </div>
      <CreateNewPassModal open={newPassOpen} onClose={() => setNewPassOpen(false)} />
    </div>
  );
}
</file>

<file path="src/components/modals/AdminModals/ResetPasswordModal.tsx">
import React, { useState } from 'react';
import { Button } from '../../ui/button';
import { IoIosArrowBack } from "react-icons/io";
import { OTPModal } from './OTPModal';

interface ResetPasswordModalProps {
  open: boolean;
  onClose: () => void;
}

export default function ResetPasswordModal({ open, onClose }: ResetPasswordModalProps) {
  const [email, setEmail] = useState('');
  const [oTPOpen, setOTPOpen] = useState(false);

  if (!open) return null;

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // TODO: Implement send reset email logic
  };

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center bg-white">
      {/* Back Button (Top Left of Fullscreen Modal) */}
      <Button
        className="absolute top-4 left-4 text-black hover:bg-transparent px-3 py-2 flex items-center gap-2 border border-gray-400 bg-transparent"
        onClick={onClose}
      >
        <IoIosArrowBack /> Back
      </Button>

      <div className="bg-[#F1F5F9] rounded-2xl p-10 w-[500px] max-w-full shadow-none border border-[#E2E8F0] flex flex-col items-center relative">
        <h2 className="text-3xl font-bold text-[#D946EF] mb-8 underline underline-offset-4 text-center font-boogaloo tracking-wider">
          Reset Password
        </h2>
        <form className="w-full flex flex-col gap-6" onSubmit={handleSubmit}>
          <div>
            <label className="block font-bold text-2xl mb-2 font-boogaloo tracking-wider">Email</label>
            <input
              type="email"
              className="w-full rounded-lg bg-[#E2E8F0] px-4 py-3 text-gray-500 font-pincuk text-xl tracking-wider  border border-[#CBD5E0]"
              placeholder="Email"
              value={email}
              onChange={e => setEmail(e.target.value)}
              required
            />
          </div>
          <button
            type="submit"
            className="w-full mt-2 bg-[#D946EF] text-white py-3 rounded-xl text-lg tracking-wider"
            onClick={() => setOTPOpen(true)}
          >
            Send email
          </button>
        </form>
      </div>
      <OTPModal open={oTPOpen} onClose={() => setOTPOpen(false)} />
    </div>
  );
}
</file>

<file path="src/components/modals/AdminKeepPlayingModal.tsx">
import { useEffect } from 'react';
import { useSystemConfigByKey } from '../../backend/configuration.service';

interface AdminKeepPlayingModalProps {
  open: boolean;
  onClose: () => void;
  isGameLoading?: boolean;
}

export default function AdminKeepPlayingModal({ open, onClose, isGameLoading }: AdminKeepPlayingModalProps) {
  const { data: popupConfig } = useSystemConfigByKey('popup');

  // Handle escape key press
  useEffect(() => {
    const handleEscape = (event: KeyboardEvent) => {
      if (event.key === 'Escape' && open) {
        onClose();
      }
    };

    if (open) {
      document.addEventListener('keydown', handleEscape);
    }

    return () => {
      document.removeEventListener('keydown', handleEscape);
    };
  }, [open, onClose]);

  if (!open || isGameLoading) return null;

  const title = popupConfig?.value?.title || "Time's Up!";
  const subtitle = popupConfig?.value?.subtitle || "Sign up to keep playing this game and unlock unlimited access to all games!";

  // Handle backdrop click
  const handleBackdropClick = (e: React.MouseEvent) => {
    if (e.target === e.currentTarget) {
      onClose();
    }
  };

  return (
    <div
      className="fixed inset-0 z-[70] flex items-center justify-center bg-black/50"
      onClick={handleBackdropClick}
    >
      <div className="relative bg-white dark:bg-[#475568] rounded-2xl shadow-xl p-4 sm:p-6 md:p-8 w-[90%] sm:w-[450px] md:w-[500px] lg:w-[550px] max-w-[90vw] border-4 border-[#C026D3]">
        {/* Custom Close Button - Same style as LoginModal */}
        <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={onClose}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>

        <div className="flex flex-col items-center max-w-[90%] mx-auto">
          <h1 className="text-2xl sm:text-3xl lg:text-4xl tracking-wide font-extrabold mb-3 sm:mb-4 text-[#18181b] dark:text-white text-center">{title}</h1>
          <p className="text-base sm:text-lg lg:text-xl text-center mb-4 sm:mb-6 text-gray-600 dark:text-gray-300">{subtitle}</p>
          <div className='flex items-center justify-center'>
            <button
              onClick={onClose}
              className='bg-[#C026D3] hover:bg-[#a21caf] text-white text-base sm:text-lg lg:text-xl font-bold py-2 sm:py-3 px-4 sm:px-6 rounded-xl transition-colors'
            >
              Close Preview
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/components/modals/DeleteConfirmationModal.tsx">
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogClose } from "../ui/dialog";
import { Button } from "../ui/button";
import { XIcon } from "lucide-react";

interface DeleteConfirmationModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onConfirm: () => void;
  isDeleting?: boolean;
  title?: string;
  description?: string;
  confirmButtonText?: string;
  loadingText?: string;
}

export function DeleteConfirmationModal({
  open,
  onOpenChange,
  onConfirm,
  isDeleting = false,
  title = "Are you sure you want to delete?",
  description = "This action cannot be reversed",
  confirmButtonText = "Delete",
  loadingText = "Deleting..."
}: DeleteConfirmationModalProps) {
  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent
        className="rounded-2xl border-0 shadow-sm p-8 max-w-lg font-boogaloo tracking-wide dark:bg-[#334154]"
        style={{ boxShadow: "0 2px 4px 2px #e879f9" }}
        hideClose
      >
        <DialogHeader>
          <DialogTitle className="text-2xl tracking-wider mb-2">{title}</DialogTitle>
        </DialogHeader>
        <div className="mb-8 text-[#22223B] text-xl tracking-wider dark:text-white">{description}</div>
        <DialogFooter className="flex justify-end gap-4">
          <DialogClose asChild>
            <Button variant="outline" className="w-20 h-12 text-lg rounded-lg dark:bg-white dark:text-black">
              Cancel
            </Button>
          </DialogClose>
          <Button
            variant="destructive"
            className="w-20 h-12 text-lg rounded-lg dark:bg-[#EF4444]"
            onClick={onConfirm}
            disabled={isDeleting}
          >
            {isDeleting ? loadingText : confirmButtonText}
          </Button>
        </DialogFooter>
        <DialogClose asChild>
          <button className="absolute -top-4 -right-4 rounded-full bg-[#C026D3] w-10 h-10 flex items-center justify-center text-white">
            <XIcon className="w-6 h-6" />
          </button>
        </DialogClose>
      </DialogContent>
    </Dialog>
  );
}
</file>

<file path="src/components/modals/ForgotPasswordModal.tsx">
/* eslint-disable @typescript-eslint/no-unused-vars */
import { useState } from "react";
import { useNavigate } from "react-router-dom";
import { Formik, Form, Field, ErrorMessage } from "formik";
import type { FieldProps, FormikHelpers } from "formik";
import * as Yup from "yup";
import { useForgotPassword, useForgotPasswordPhone } from "../../backend/auth.service";
import { toast } from "sonner";
import {
  Dialog,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "../../components/ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { Button } from "../../components/ui/button";
import { Input } from "../../components/ui/input";
import { Label } from "../../components/ui/label";
import { AiOutlineMail } from "react-icons/ai";
import PhoneInput from "react-phone-input-2";
import "react-phone-input-2/lib/style.css";
import "../../styles/phone-input.css";
import { ResetPasswordOTPModal } from "./ResetPasswordOTPModal";

interface ForgotPasswordModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  openLoginModal: () => void;
}

// Validation schemas
const emailValidationSchema = Yup.object({
  email: Yup.string()
    .email("Invalid email address")
    .required("Email is required"),
});

const phoneValidationSchema = Yup.object({
  phoneNumber: Yup.string()
    .required("Phone number is required"),
});

interface FormValues {
  email: string | undefined;
  phoneNumber: string | undefined;
}

// Initial values
const getInitialValues = (isEmailTab = true): FormValues => ({
  email: isEmailTab ? "" : undefined,
  phoneNumber: isEmailTab ? undefined : "",
});

export function ForgotPasswordModal({
  open,
  onOpenChange,
  openLoginModal,
}: ForgotPasswordModalProps) {
  const [activeTab, setActiveTab] = useState<"email" | "phone">("email");
  const [isSubmitted, setIsSubmitted] = useState(false);
  const [submittedContact, setSubmittedContact] = useState("");
  const [isOTPVerificationModalOpen, setIsOTPVerificationModalOpen] = useState(false);
  const [userId, setUserId] = useState("");
  const forgotPassword = useForgotPassword();
  const forgotPasswordPhone = useForgotPasswordPhone();

  const handleSubmit = async (
    values: FormValues,
    actions: FormikHelpers<FormValues>
  ) => {
    try {
      if (activeTab === "email") {
        try {
          await forgotPassword.mutateAsync(values.email!);
        } catch (error) {
          console.log(error)
        }
        setSubmittedContact(values.email!);
        setIsSubmitted(true);
        toast.success("If your email exists in our system, you will receive password reset instructions");
      } else {
        try {
          const response = await forgotPasswordPhone.mutateAsync(values.phoneNumber!);
          setSubmittedContact(values.phoneNumber!);

          if (response.data?.userId) {
            // Valid phone number - show OTP verification
            setUserId(response.data.userId);
            onOpenChange(false)
            setIsOTPVerificationModalOpen(true);
            setIsSubmitted(false); // Ensure submitted state is false to show the form
            toast.success("Reset code sent to your phone number");
          } else {
            // Invalid phone number - show generic message
            setIsSubmitted(true);
            toast.success("If your phone number exists in our system, you will receive a reset code shortly");
          }
        } catch (error) {
          toast.error("An error occurred. Please try again later.");
          setIsSubmitted(true); // Show the error state
        }
      }
    } finally {
      actions.setSubmitting(false);
    }
  };

  const navigate = useNavigate();

  const handleVerificationSuccess = () => {
    setIsOTPVerificationModalOpen(false);
    onOpenChange(false);
    navigate(`/reset-password/phone/${userId}`);
    toast.success("OTP verified successfully. You can now reset your password.");
  };

  const handleBackToLogin = () => {
    onOpenChange(false);
    openLoginModal();
  };

  const resetForm = () => {
    setIsSubmitted(false);
    setSubmittedContact("");
    setUserId("");
  };

  return (
    <Dialog
      open={open}
      onOpenChange={(newOpen) => {
        if (!newOpen) {
          resetForm();
        }
        onOpenChange(newOpen);
      }}
    >
      <CustomDialogContent className="sm:max-w-[425px] dark:bg-[#0F1221]">
        <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>
        <DialogHeader>
          <DialogTitle className="text-2xl font-bold text-[#E328AF] text-center font-boogaloo">
            {isSubmitted ? (activeTab === "email" ? "Check Your Email" : "Password Reset") : "Forgot Password"}
          </DialogTitle>
          <div className="flex font-boogaloo text-xl tracking-wide">
            <div className="px-6 flex w-full border-b">
              <button
                className={`flex-1 py-2 font-semibold ${
                  activeTab === "email"
                    ? "text-[#E328AF] border-b-2 border-[#E328AF]"
                    : "text-gray-500"
                }`}
                onClick={() => setActiveTab("email")}
              >
                Email
              </button>
              <button
                className={`flex-1 py-2 font-semibold ${
                  activeTab === "phone"
                    ? "text-[#E328AF] border-b-2 border-[#E328AF]"
                    : "text-gray-500"
                }`}
                onClick={() => setActiveTab("phone")}
              >
                Phone Number
              </button>
            </div>
          </div>
          <DialogDescription className="text-center">
            {(isSubmitted && !isOTPVerificationModalOpen) || (activeTab === "email" && isSubmitted) ? (
              <div className="space-y-4">
                <p className=" text-center text-black dark:text-white font-pincuk text-xl tracking-wider">
                  We've sent {activeTab === "email" ? "password reset instructions" : "a reset code"} to:
                  <p className="text-md font-semibold text-center text-black dark:text-white mt-2">
                    {submittedContact}
                  </p>
                  <p className=" text-center text-black dark:text-white font-pincuk text-xl tracking-wider mt-2">
                    {activeTab === "email"
                      ? "Please check your email and follow the instructions to reset your password."
                      : "If this phone number exists in our system, you will receive a reset code shortly."}
                  </p>
                </p>
                <div className="flex flex-col space-y-2 mt-4">
                  <Button
                    type="button"
                    onClick={resetForm}
                    className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
                  >
                    {activeTab === "email" ? "Try Another Email" : "Try Another Number"}
                  </Button>
                  <Button
                    type="button"
                    onClick={handleBackToLogin}
                    className="w-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-700 font-boogaloo"
                  >
                    Back to Login
                  </Button>
                </div>
              </div>
            ) : (
              <Formik
                initialValues={getInitialValues(activeTab === "email")}
                validationSchema={activeTab === "email" ? emailValidationSchema : phoneValidationSchema}
                onSubmit={handleSubmit}
                enableReinitialize
              >
                {({ isSubmitting }) => (
                  <Form className="space-y-4">
                    <p className="text-center text-black dark:text-white font-pincuk text-xl tracking-wider mb-4">
                      {activeTab === "email"
                        ? "Enter your email address and we'll send you instructions to reset your password."
                        : "Enter your phone number and we'll send you a code to reset your password."}
                    </p>
                    <div className="relative">
                      <Label
                        htmlFor={activeTab === "email" ? "email" : "phoneNumber"}
                        className="font-boogaloo text-base text-black dark:text-white"
                      >
                        {activeTab === "email" ? "Email" : "Phone Number"}
                      </Label>
                      <div className="relative">
                        {activeTab === "email" ? (
                          <>
                            <AiOutlineMail
                              size={15}
                              className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                            />
                            <Field
                              as={Input}
                              id="email"
                              name="email"
                              placeholder="email"
                              className="mt-1 bg-[#E2E8F0] dark:bg-[#191c2b] border-0 pl-10 font-pincuk text-xl tracking-wider text-[11px] font-normal h-[48px]"
                            />
                          </>
                        ) : (
                          <Field name="phoneNumber">
                            {({ field, form }: FieldProps) => (
                              <PhoneInput
                                country={"us"}
                                value={field.value}
                                onChange={(value) =>
                                  form.setFieldValue("phoneNumber", `+${value}`)
                                }
                                inputStyle={{
                                  width: "100%",
                                  height: "48px",
                                  backgroundColor: "#E2E8F0",
                                  border: "0",
                                  borderRadius: "0.375rem",
                                  fontFamily: "pincuk",
                                  fontSize: "11px",
                                }}
                                containerClass="dark:bg-[#191c2b]"
                                buttonStyle={{
                                  backgroundColor: "#E2E8F0",
                                  border: "0",
                                  borderRadius: "0.375rem 0 0 0.375rem",
                                }}
                                dropdownStyle={{
                                  backgroundColor: "#E2E8F0",
                                  color: "#000",
                                }}
                                searchStyle={{
                                  backgroundColor: "#E2E8F0",
                                  color: "#000",
                                }}
                                enableAreaCodeStretch
                                autoFormat
                                enableSearch
                                disableSearchIcon
                                autocompleteSearch
                                countryCodeEditable={false}
                              />
                            )}
                          </Field>
                        )}
                      </div>
                      <ErrorMessage
                        name={activeTab === "email" ? "email" : "phoneNumber"}
                        component="div"
                        className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                      />
                    </div>
                    <Button
                      type="submit"
                      disabled={isSubmitting}
                      className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
                    >
                      {isSubmitting ? "Sending..." : "Send Reset Instructions"}
                    </Button>
                    <Button
                      type="button"
                      onClick={handleBackToLogin}
                      className="w-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-700 font-boogaloo"
                    >
                      Back to Login
                    </Button>
                  </Form>
                )}
              </Formik>
            )}
          </DialogDescription>
        </DialogHeader>
      </CustomDialogContent>

      <ResetPasswordOTPModal
        open={isOTPVerificationModalOpen}
        onOpenChange={setIsOTPVerificationModalOpen}
        userId={userId}
        contactMethod={submittedContact}
        onVerificationSuccess={handleVerificationSuccess}
      />
    </Dialog>
  );
}
</file>

<file path="src/components/modals/KeepPlayingModal.tsx">
import { useTrackSignupClick } from '../../backend/signup.analytics.service';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';
import { useSystemConfigByKey } from '../../backend/configuration.service';
import { getVisitorSessionId } from '../../utils/sessionUtils';

interface KeepPlayingModalProps {
  open: boolean;
  openSignUpModal: () => void;
  isGameLoading?: boolean;
}

export default function KeepPlayingModal({ open, isGameLoading }: KeepPlayingModalProps) {
  const { mutate: trackSignup } = useTrackSignupClick();
  const navigate = useNavigate();
  const { setKeepPlayingRedirect } = useAuth();

  const handleSignupClick = () => {
    trackSignup({
      sessionId: getVisitorSessionId(),
      type: 'keep-playing'
    });
    setKeepPlayingRedirect(true);
    navigate('/');
  };

  const { data: popupConfig } = useSystemConfigByKey('popup');

  if (!open || isGameLoading) return null;

  const title = popupConfig?.value?.title || "Time's Up!";
  const subtitle = popupConfig?.value?.subtitle || "Sign up to keep playing this game and unlock unlimited access to all games!";

  return (
    <div className="fixed inset-0 z-[70] flex items-center justify-center bg-black/50">
      <div className="relative bg-white dark:bg-[#475568] rounded-2xl shadow-xl p-4 sm:p-6 md:p-8 w-[90%] sm:w-[450px] md:w-[500px] lg:w-[550px] max-w-[90vw] border-4 border-[#C026D3]">
        <div className="flex flex-col items-center max-w-[90%] mx-auto">
          <h1 className="text-2xl sm:text-3xl lg:text-4xl tracking-wide font-extrabold mb-3 sm:mb-4 text-[#18181b] dark:text-white text-center">{title}</h1>
          <p className="text-base sm:text-lg lg:text-xl text-center mb-4 sm:mb-6 text-gray-600 dark:text-gray-300">{subtitle}</p>
          <div className='flex items-center justify-center'>
            <button
              onClick={handleSignupClick}
              className='bg-[#C026D3] hover:bg-[#a21caf] text-white text-base sm:text-lg lg:text-xl font-bold py-2 sm:py-3 px-4 sm:px-6 rounded-xl transition-colors'
            >
              Sign Up Now
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/components/modals/LoginModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
import { useState, useEffect } from "react";
import { Formik, Form, Field, ErrorMessage } from "formik";
import type { FieldProps, FormikHelpers } from "formik";
import type { LoginCredentials } from "../../backend/types";
import * as Yup from "yup";
import { useAuth } from "../../context/AuthContext";
import { toast } from "sonner";
import { ForgotPasswordModal } from "./ForgotPasswordModal";
import { Dialog, DialogHeader, DialogTitle } from "../../components/ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { Button } from "../../components/ui/button";
import { Input } from "../../components/ui/input";
import { Label } from "../../components/ui/label";
import { FaEye, FaEyeSlash } from "react-icons/fa";
import { AiOutlineMail } from "react-icons/ai";
import { OTPVerificationModal } from "./OTPVerificationModal";
import PhoneInput from "react-phone-input-2";
import "react-phone-input-2/lib/style.css";
import "../../styles/phone-input.css";
import { useNavigate } from "react-router-dom";
import { isValidRole } from "../../utils/main";

interface LoginDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  openSignUpModal: () => void;
  defaultEmail?: string;
  hideSignUpLink?: boolean;
}

interface LoginFormValues {
  email?: string;
  phoneNumber?: string;
  password: string;
}

interface LoginResponse {
  userId: string;
  hasEmail: boolean;
  hasPhone: boolean;
  phoneNumber?: string;
  email?: string;
  requiresOtp: boolean;
  role: string;
  otpType?: "EMAIL" | "SMS" | "BOTH";
  message: string;
  tokens?: {
    accessToken: string;
    refreshToken: string;
  };
}

const emailValidationSchema = Yup.object({
  email: Yup.string()
    .email("Invalid email address")
    .required("Email is required"),
  password: Yup.string().required("Password is required"),
});

const phoneValidationSchema = Yup.object({
  phoneNumber: Yup.string().required("Phone number is required"),
  password: Yup.string().required("Password is required"),
});

const getInitialValues = (
  defaultEmail?: string,
  isEmailTab = true
): LoginFormValues => ({
  email: isEmailTab ? defaultEmail || "" : undefined,
  phoneNumber: isEmailTab ? undefined : "",
  password: "",
});

export function LoginModal({
  open,
  onOpenChange,
  openSignUpModal,
  defaultEmail,
  hideSignUpLink = false,
}: LoginDialogProps) {
  const [showPassword, setShowPassword] = useState(false);
  const [loginResponse, setLoginResponse] = useState<LoginResponse | null>(null);
  const [isOTPVerificationModalOpen, setIsOTPVerificationModalOpen] = useState(false);
  const [loginError, setLoginError] = useState("");
  const [isForgotPasswordModalOpen, setIsForgotPasswordModalOpen] = useState(false);
  const [activeTab, setActiveTab] = useState<"email" | "phone">("email");
  const [isLoggingIn, setIsLoggingIn] = useState(false);
  const { login } = useAuth();
  const navigate = useNavigate();
  const togglePasswordVisibility = () => setShowPassword(!showPassword);

  // Clear error message when switching tabs
  useEffect(() => {
    setLoginError("");
  }, [activeTab]);

  // Clear error message when modal is opened/closed
  useEffect(() => {
    if (!open) {
      setLoginError("");
    }
  }, [open]);

  const handleLogin = async (
    values: LoginFormValues,
    actions: FormikHelpers<LoginFormValues>
  ) => {
    try {
      setLoginError("");
      setIsLoggingIn(true);
      const credentials: LoginCredentials = {
        identifier: activeTab === "email" ? values.email! : values.phoneNumber!,
        password: values.password,
      };

      const response: LoginResponse = await login(credentials);
      setLoginResponse(response);
      setLoginError("");

      if (response.requiresOtp) {
        // Show OTP verification modal and info message
        setIsOTPVerificationModalOpen(true);
        onOpenChange(false);
        toast.info(response.message);
        setIsLoggingIn(false);
      } else {
        // No OTP required, show success and redirect
        toast.success(response.message);
        if (isValidRole(response.role)) {
          navigate("/admin");
        } else {
          navigate("/");
        }
        onOpenChange(false);
        setIsLoggingIn(false);
      }
    } catch (error: any) {
      setIsLoggingIn(false);
      if (error.response?.data?.message) {
        setLoginError(error.response.data.message);
        toast.error(error.response.data.message);
      } else {
        const errorMsg =
          activeTab === "phone"
            ? "Invalid phone number or password. Please try again."
            : "Invalid email or password. Please try again.";
        setLoginError(errorMsg);
        toast.error(errorMsg);
      }
    } finally {
      actions.setSubmitting(false);
    }
  };

  return (
    <Dialog
      open={open && !isLoggingIn}
      onOpenChange={isLoggingIn ? () => {} : onOpenChange}
    >
      <CustomDialogContent className="sm:max-w-[425px] dark:bg-[#0F1221] p-0">
        {/* Custom Close Button */}
        <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>
        <DialogHeader className="mb-4">
          <DialogTitle className="text-3xl font-bold text-[#E328AF] text-center font-boogaloo py-4">
            Login
          </DialogTitle>
          <div className="flex font-boogaloo text-xl tracking-wide">
            <div className="px-6 flex w-full border-b">
              <button
                className={`flex-1 py-2 font-semibold ${activeTab === "email"
                    ? "text-[#E328AF] border-b-2 border-[#E328AF]"
                    : "text-gray-500"
                  }`}
                onClick={() => setActiveTab("email")}
              >
                Email
              </button>
              <button
                className={`flex-1 py-2 font-semibold ${activeTab === "phone"
                    ? "text-[#E328AF] border-b-2 border-[#E328AF]"
                    : "text-gray-500"
                  }`}
                onClick={() => setActiveTab("phone")}
              >
                Phone Number
              </button>
            </div>
          </div>
        </DialogHeader>

        <div className="px-6 pb-6">
          <Formik
            initialValues={getInitialValues(
              defaultEmail,
              activeTab === "email"
            )}
            validationSchema={
              activeTab === "email"
                ? emailValidationSchema
                : phoneValidationSchema
            }
            onSubmit={handleLogin}
            enableReinitialize
          >
            {({ isSubmitting }) => (
              <Form className="space-y-4">
                <div className="space-y-1">
                  <Label
                    htmlFor={activeTab === "email" ? "email" : "phoneNumber"}
                    className="font-boogaloo text-base text-black dark:text-white"
                  >
                    {activeTab === "email" ? "Email" : "Phone Number"}
                  </Label>
                  <div className="relative">
                    {activeTab === "email" && (
                      <AiOutlineMail
                        size={15}
                        className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                      />
                    )}
                    {activeTab === "phone" ? (
                      <Field name="phoneNumber">
                        {({ field, form }: FieldProps) => (
                          <PhoneInput
                            country={"us"}
                            value={field.value}
                            onChange={(value) =>
                              form.setFieldValue("phoneNumber", `+${value}`)
                            }
                            inputProps={
                              {
                                // className: 'w-full rounded-md',
                              }
                            }
                            inputStyle={{
                              width: "100%",
                              height: "48px",
                              backgroundColor: "#E2E8F0",
                              border: "0",
                              borderRadius: "0.375rem",
                              fontFamily: "boogaloo",
                              fontSize: "11px",
                            }}
                            containerClass="dark:bg-[#191c2b]"
                            buttonStyle={{
                              backgroundColor: "#E2E8F0",
                              border: "0",
                              borderRadius: "0.375rem 0 0 0.375rem",
                            }}
                            dropdownStyle={{
                              backgroundColor: "#E2E8F0",
                              color: "#000",
                            }}
                            searchStyle={{
                              backgroundColor: "#E2E8F0",
                              color: "#000",
                            }}
                            enableAreaCodeStretch
                            autoFormat
                            enableSearch
                            disableSearchIcon
                            autocompleteSearch
                            countryCodeEditable={false}
                          />
                        )}
                      </Field>
                    ) : (
                      <Field
                        as={Input}
                        id={activeTab === "email" ? "email" : "phoneNumber"}
                        name={activeTab === "email" ? "email" : "phoneNumber"}
                        placeholder={
                          activeTab === "email"
                            ? "Enter your email"
                            : "Enter your phone number"
                        }
                        className={`mt-1 bg-[#E2E8F0] border-0 pl-10 font-boogaloo text-xl tracking-wider font-normal h-[48px] ${activeTab === "email" ? "pl-10" : ""
                          }`}
                      />
                    )}
                  </div>
                  <ErrorMessage
                    name={activeTab === "email" ? "email" : "phoneNumber"}
                    component="div"
                    className="text-red-500 mt-1 font-boogaloo text-sm tracking-wider"
                  />
                </div>
                <div className="relative">
                  <Label
                    htmlFor="password"
                    className="font-boogaloo text-base text-black dark:text-white"
                  >
                    Password
                  </Label>
                  <div className="relative">
                    <button
                      type="button"
                      onClick={togglePasswordVisibility}
                      className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                      aria-label={
                        showPassword ? "Hide password" : "Show password"
                      }
                    >
                      {showPassword ? (
                        <FaEyeSlash size={15} />
                      ) : (
                        <FaEye size={15} />
                      )}
                    </button>
                    <Field
                      as={Input}
                      id="password"
                      name="password"
                      type={showPassword ? "text" : "password"}
                      placeholder="password"
                      className="mt-1 bg-[#E2E8F0] border-0 pl-10 font-boogaloo text-xl tracking-wider font-normal h-[48px]"
                    />
                  </div>
                  <ErrorMessage
                    name="password"
                    component="div"
                    className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                  />
                </div>
                {loginError && (
                  <div className="text-red-500 font-boogaloo text-sm tracking-wider text-center">
                    {loginError}
                  </div>
                )}
                <div className="text-right">
                  <span
                    className="text-[#C026D3] cursor-pointer font-boogaloo text-lg hover:underline"
                    onClick={() => {
                      onOpenChange(false);
                      setIsForgotPasswordModalOpen(true);
                    }}
                    data-forgot-password-trigger
                  >
                    Forgot Password?
                  </span>
                </div>
                <Button
                  type="submit"
                  disabled={isSubmitting}
                  className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
                >
                  Login
                </Button>
                {!hideSignUpLink && (
                  <p className=" text-center text-black dark:text-white font-boogaloo text-md tracking-wider">
                    Don't have an account?{" "}
                    <span
                      className="text-[#C026D3] cursor-pointer hover:underline text-xl font-boogaloo"
                      onClick={openSignUpModal}
                    >
                      Sign Up
                    </span>
                  </p>
                )}
              </Form>
            )}
          </Formik>
        </div>
      </CustomDialogContent>
      <OTPVerificationModal
        open={isOTPVerificationModalOpen}
        onOpenChange={setIsOTPVerificationModalOpen}
        userId={loginResponse?.userId || ""}
        contactMethod={
          loginResponse?.otpType === "BOTH" && loginResponse?.email && loginResponse?.phoneNumber
            ? `${loginResponse.email} and ${loginResponse.phoneNumber}`
            : loginResponse?.email || loginResponse?.phoneNumber || ""
        }
        otpType={loginResponse?.otpType}
      />

      <ForgotPasswordModal
        open={isForgotPasswordModalOpen}
        onOpenChange={setIsForgotPasswordModalOpen}
        openLoginModal={() => {
          setIsForgotPasswordModalOpen(false);
          onOpenChange(true);
        }}
      />
    </Dialog>
  );
}
</file>

<file path="src/components/modals/OTPPlatformModal.tsx">
import {
    AlertDialog,
    AlertDialogContent,
    AlertDialogDescription,
    AlertDialogHeader,
    AlertDialogTitle,
} from "../../components/ui/alert-dialog";
import { RadioGroup, RadioGroupItem } from "../../components/ui/radio-group";
import { Label } from "../../components/ui/label";
import { OTPVerificationModal } from "./OTPVerificationModal";
import { Button } from "../ui/button";
import { useState } from "react";
import { useRequestOtp } from "../../backend/auth.service";
import { toast } from "sonner";

interface OTPPlatformDialogProps {
    open: boolean;
    onOpenChange: (open: boolean) => void;
    userId: string;
    email?: string;
    phone?: string;
}

export function OTPPlatformModal({
    open,
    onOpenChange,
    userId,
    email = "your email",
    phone = "your phone"
}: OTPPlatformDialogProps) {
    const [isOTPVerificationOpen, setIsOTPVerificationOpen] = useState(false);
    const [selectedOtpType, setSelectedOtpType] = useState<'EMAIL' | 'SMS'>('EMAIL');
    const [error, setError] = useState('');
    const requestOtp = useRequestOtp();

    const handleSendOTP = async () => {
        try {
            setError('');
            await requestOtp.mutateAsync({ userId, otpType: selectedOtpType });
            setIsOTPVerificationOpen(true);
            onOpenChange(false);
        } catch (error) {
            console.error("Error requesting OTP:", error);
            setError('Failed to send OTP. Please try again.');
            toast.error('Failed to send OTP. Please try again.');
        }
    }

    return (
        <AlertDialog open={open} onOpenChange={onOpenChange}>
            <AlertDialogContent className="sm:max-w-[425px] dark:bg-[#0F1221] rounded-lg p-6">
                <AlertDialogHeader>
                    <AlertDialogTitle className="text-2xl font-bold dark:text-white text-black font-boogaloo">
                        OTP Verification
                    </AlertDialogTitle>
                    <AlertDialogDescription className=" dark:text-white text-black font-pincuk text-xl tracking-wider mt-1">
                        Select platform where you want to receive OTP
                    </AlertDialogDescription>
                </AlertDialogHeader>
                <div className="space-y-4 mt-6">
                    {error && (
                        <div className="text-red-500 font-pincuk text-xl tracking-wider text-center mb-4">
                            {error}
                        </div>
                    )}
                    <RadioGroup
                        defaultValue="EMAIL"
                        className="space-y-3"
                        onValueChange={(value) => setSelectedOtpType(value as 'EMAIL' | 'SMS')}
                    >
                        <div className="flex items-center justify-center space-x-3 border-[#E328AF] border-1 rounded p-2">
                            <RadioGroupItem
                                value="EMAIL"
                                id="email"
                                className="text-[#E328AF] border-2 border-[#E328AF] h-5 w-5 focus:ring-[#E328AF] checked:bg-[#E328AF]"
                            />
                            <Label
                                htmlFor="email"
                                className="font-boogaloo text-base dark:text-white text-black text-center"
                            >
                                {email}
                            </Label>
                        </div>
                        <div className="flex items-center justify-center space-x-3 border-[#E328AF] border-1 rounded p-2">
                            <RadioGroupItem
                                value="SMS"
                                id="phone"
                                className="text-[#E328AF] border-2 border-[#E328AF] h-5 w-5 focus:ring-[#E328AF] checked:bg-[#E328AF]"
                            />
                            <Label
                                htmlFor="phone"
                                className="font-boogaloo text-base dark:text-white text-black text-center"
                            >
                                {phone}
                            </Label>
                        </div>
                    </RadioGroup>
                </div>

                <Button onClick={handleSendOTP} className="w-full mt-6 bg-[#E328AF] hover:bg-[#C026D3] text-white font-boogaloo py-3 rounded-md text-lg">
                    Next
                </Button>

            </AlertDialogContent>
            <OTPVerificationModal
                open={isOTPVerificationOpen}
                onOpenChange={setIsOTPVerificationOpen}
                userId={userId}
                contactMethod={selectedOtpType === 'EMAIL' ? email : phone}
                otpType={selectedOtpType}
                onVerificationSuccess={() => {
                    // Close the OTPPlatformModal when verification is successful
                    onOpenChange(false);
                }}
            />
        </AlertDialog>
    );
}
</file>

<file path="src/components/modals/OTPVerificationModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
import { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import {
  AlertDialog,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogHeader,
  AlertDialogTitle,
} from "../../components/ui/alert-dialog";
import { Button } from "../../components/ui/button";
import OTPInput from "react-otp-input";
import { useAuth } from "../../context/AuthContext";
import { useRequestOtp } from "../../backend/auth.service";
import { toast } from "sonner";
import { isValidRole } from "../../utils/main";

interface OTPVerificationDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  userId: string;
  contactMethod?: string; // Email or phone number that received the OTP
  otpType?: "EMAIL" | "SMS" | "BOTH"; // Type of OTP sent
  onVerificationSuccess?: () => void; // Callback for when verification is successful
}

export function OTPVerificationModal({
  open,
  onOpenChange,
  userId,
  contactMethod = "your email or phone",
  otpType = "EMAIL",
  onVerificationSuccess,
}: OTPVerificationDialogProps) {
  const [otp, setOtp] = useState("");
  const [error, setError] = useState("");
  const [isVerifying, setIsVerifying] = useState(false);
  const { verifyOtp } = useAuth();
  const requestOtp = useRequestOtp();
  const navigate = useNavigate();

  // Clear error message when modal opens
  useEffect(() => {
    if (open) {
      setError("");
      setOtp("");
    }
  }, [open]);

  const handleVerify = async () => {
    if (otp.length !== 6) {
      setError("Please enter a valid 6-digit OTP");
      toast.error("Please enter a valid 6-digit OTP");
      return;
    }

    try {
      setError("");
      setIsVerifying(true);
      const user = await verifyOtp(userId, otp);

      // Close the modal
      onOpenChange(false);

      // Call the success callback if provided
      if (onVerificationSuccess) {
        onVerificationSuccess();
      }

      const userRole = (user as any)?.data?.role.name;

      setTimeout(() => {
        if (isValidRole(userRole)) {
          navigate("/admin");
        } else {
          navigate("/");
        }
      }, 300);

      // Show success message
      toast.success("Login successful! Redirecting...");

      // eslint-disable-next-line @typescript-eslint/no-unused-vars
    } catch (error) {
      setError("Invalid OTP. Please try again.");
      toast.error("Invalid OTP. Please try again.");
    } finally {
      setOtp("");
      setIsVerifying(false);
    }
  };

  const handleResendOtp = async () => {
    try {
      setError("");
      await requestOtp.mutateAsync({ userId, otpType });
      // Show success message
      setError("OTP resent successfully!");
      toast.success("OTP resent successfully!");
      // eslint-disable-next-line @typescript-eslint/no-unused-vars
    } catch (error) {
      setError("Failed to resend OTP. Please try again.");
      toast.error("Failed to resend OTP. Please try again.");
    }
  };


  // Reset OTP when modal closes
  const handleOpenChange = (isOpen: boolean) => {
    if (!isOpen) {
      setOtp(""); // Clear OTP when modal closes
    }
    onOpenChange(isOpen);
  };

  return (
    <AlertDialog open={open} onOpenChange={handleOpenChange}>
      <AlertDialogContent className="max-w-[90vw] sm:max-w-[425px] p-4 sm:p-6 dark:bg-[#0F1221] rounded-xl">
        {/* Custom Close Button */}
        <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>
        <AlertDialogHeader>
          <AlertDialogTitle className="text-xl sm:text-2xl font-bold dark:text-white text-black font-boogaloo">
            OTP Verification
          </AlertDialogTitle>
          <AlertDialogDescription className="dark:text-white text-black font-boogaloo text-md tracking-wider sm:text-sm mt-1">
            Enter the verification code we just sent to{" "}
            {otpType === "BOTH" ? "both " : ""}
            {contactMethod}
          </AlertDialogDescription>
        </AlertDialogHeader>
        <div className="flex justify-center my-4 sm:my-6">
          <OTPInput
            value={otp}
            onChange={setOtp}
            numInputs={6}
            renderInput={(props) => (
              <div className="px-3 sm:px-3 py-2 sm:py-3 border-2 border-[#E328AF] mx-0.5 sm:mx-1 rounded-lg">
                <input
                  {...props}
                  className="w-12 h-12 sm:w-12 sm:h-12 text-center bg-transparent rounded-none dark:text-white text-black font-pincuk text-xl sm:text-2xl font-bold focus:outline-none focus:ring-0"
                />
              </div>
            )}
            inputType="tel"
            shouldAutoFocus
            placeholder=""
          />
        </div>
        {error && (
          <div
            className={`text-xs sm:text-sm text-center font-pincuk mt-2 sm:mt-3 ${error.includes("resent") ? "text-green-500" : "text-red-500"
              }`}
          >
            {error}
          </div>
        )}
        <Button
          onClick={handleVerify}
          disabled={isVerifying || otp.length !== 6}
          className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo text-base sm:text-lg py-2 sm:py-3 mt-4 sm:mt-6"
        >
          {isVerifying ? "Verifying..." : "Verify"}
        </Button>
        <p className="text-xs sm:text-sm text-center text-black dark:text-white font-boogaloo mt-2 sm:mt-3">
          Didn't receive a code?{" "}
          <button
            onClick={handleResendOtp}
            disabled={requestOtp.isPending}
            className="underline text-[#C026D3] cursor-pointer text-lg"
          >
            {requestOtp.isPending ? "Sending..." : "Resend"}
          </button>
        </p>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/components/modals/ProfileModal.tsx">
import { Dialog } from "../ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';

import { TbLogout } from "react-icons/tb";

interface ProfileModalProps {
    open: boolean;
    onClose: () => void;
}

export function ProfileModal({ open, onClose }: ProfileModalProps) {
    const { user, logout } = useAuth();
    const navigate = useNavigate();

    const handleLogout = () => {
        logout();
        onClose();
        navigate('/');
    };
    return (
        <Dialog open={open} onOpenChange={onClose}>
            <CustomDialogContent className="bg-white dark:bg-[#18192b] rounded-2xl shadow-lg p-8 min-w-[350px] max-w-[90vw] w-[400px] border-none">
                {/* Custom Close Button */}
                <button
                    className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
                    onClick={onClose}
                    aria-label="Close"
                    style={{ border: 'none' }}
                >
                    <span className="text-white text-2xl font-bold"></span>
                </button>
                {/* Profile Header */}
                <div className='justify-center text-center text-[#C026D3] mb-8 text-3xl'>
                    <h1 className='font-boogaloo'>Profile</h1>
                </div>
                <div className="flex items-center mb-2">

                    <div>
                    <img
                        src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y"
                        alt="Profile"
                        className="w-20 h-20 rounded-full object-cover mb-2 border-2 border-[#D946EF]"
                    />
                    </div>

                    <div className='ml-4'>
                    <div className="text-3xl font-extrabold font-boogaloo dark:text-[#D946EF] text-[#0F1621] mb-1">
                        {user ? `${user.firstName || '' } ${user.lastName || ''}` : 'Guest User'}
                    </div>
                    <div className="dark:text-white text-[#0F1621] font-pincuk text-xl tracking-wider">
                        {user?.email || ''}
                    </div>
                    </div>
                </div>
                {/* Profile Details */}
                <div className="dark:bg-[#18192b] bg-white rounded-xl p-4 mb-4 space-y-8">
                    <div className="flex justify-between py-2 border-b border-t border-[#CBD5E0] dark:border-[#475568] items-center mb-8">
                        <span className="dark:text-[#D946EF] font-boogaloo text-xl mt-4 mb-8">Name</span>
                        <span className="dark:text-white font-pincuk text-xl tracking-wider mt-4 mb-8">
                            {user ? `${user.firstName || ''} ${user.lastName || ''}` : 'Guest User'}
                        </span>
                    </div>
                    <div className="flex justify-between py-2 border-b border-[#CBD5E0] dark:border-[#475568] items-center">
                        <span className="dark:text-[#D946EF] font-boogaloo text-xl mb-6">Email account</span>
                        <span className="dark:text-white font-pincuk text-xl tracking-wider mb-6">
                            {user?.email || 'Not available'}
                        </span>
                    </div>
                    <div className="flex justify-between py-2 border-b border-[#CBD5E0] dark:border-[#475568] items-center">
                        <span className="dark:text-[#D946EF] font-boogaloo text-xl mb-6">Mobile number</span>
                        <span className="dark:text-white font-pincuk text-xl tracking-wider mb-6">
                            {user?.phoneNumber || 'Not available'}
                        </span>
                    </div>
                </div>
                <div className="flex justify-end">
                  <button
                      className="w-24 mt-2 py-2 rounded-lg bg-[#EF4444] hover:bg-[#dc2626] text-white tracking-wider text-lg transition-colors"
                      onClick={handleLogout}
                  >
                    <div className='flex gap-2 items-center px-2 font-boogaloo'>
                        Logout
                        <TbLogout className="w-8 h-8" />
                    </div>
                  </button>
                </div>
            </CustomDialogContent>
        </Dialog>
    );
}
</file>

<file path="src/components/modals/ResetPasswordOTPModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
/* eslint-disable @typescript-eslint/no-unused-vars */
import { useState } from "react";
import {
  AlertDialog,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogHeader,
  AlertDialogTitle,
} from "../../components/ui/alert-dialog";
import { Button } from "../../components/ui/button";
import OTPInput from "react-otp-input";
import { useRequestOtp, useVerifyResetOtp } from "../../backend/auth.service";
import { toast } from "sonner";

interface ResetPasswordOTPModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  userId: string;
  contactMethod?: string; // Phone number that received the OTP
  onVerificationSuccess?: () => void; // Callback for when verification is successful
}

export function ResetPasswordOTPModal({
  open,
  onOpenChange,
  userId,
  contactMethod = "your phone number",
  onVerificationSuccess,
}: ResetPasswordOTPModalProps) {
  const [otp, setOtp] = useState("");
  const [error, setError] = useState("");
  const [isVerifying, setIsVerifying] = useState(false);
  const verifyResetOtp = useVerifyResetOtp();
  const requestOtp = useRequestOtp();

  const handleVerify = async () => {
    if (otp.length !== 6) {
      setError("Please enter a valid 6-digit OTP");
      toast.error("Please enter a valid 6-digit OTP");
      return;
    }

    try {
      setError("");
      setIsVerifying(true);
      await verifyResetOtp.mutateAsync({ userId, otp });

      // Close the modal
      onOpenChange(false);

      // Call the success callback if provided
      if (onVerificationSuccess) {
        onVerificationSuccess();
      }

      // Show success message
      toast.success("OTP verified successfully");
    } catch (error: any) {
      setError("Invalid OTP. Please try again.");
      // toast.error("Invalid OTP. Please try again.");
    } finally {
      setIsVerifying(false);
    }
  };

  const handleResendOtp = async () => {
    try {
      setError("");
      await requestOtp.mutateAsync({ userId, otpType: "SMS" });
      // Show success message
      setError("OTP resent successfully!");
      toast.success("OTP resent successfully!");
    } catch (error) {
      setError("Failed to resend OTP. Please try again.");
      toast.error("Failed to resend OTP. Please try again.");
    }
  };

  return (
    <AlertDialog open={open} onOpenChange={onOpenChange}>
      <AlertDialogContent className="sm:max-w-[425px] dark:bg-[#0F1221]">
         <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>
        <AlertDialogHeader className="text-center">
          <AlertDialogTitle className="text-2xl font-bold dark:text-white text-black font-boogaloo">
            Reset Password Verification
          </AlertDialogTitle>
          <AlertDialogDescription className="dark:text-white text-black font-pincuk text-xl tracking-wider  mt-1">
            Enter the verification code we just sent to {contactMethod}
          </AlertDialogDescription>
        </AlertDialogHeader>
        <div className="flex justify-center my-4">
          <OTPInput
            value={otp}
            onChange={setOtp}
            numInputs={6}
            renderInput={(props) => (
              <div className="px-2 py-2 border-2 border-[#E328AF] mx-1 rounded-lg">
                <input
                  {...props}
                  className="w-12 h-12 text-center bg-transparent rounded-none dark:text-white text-black font-pincuk  tracking-wider text-2xl font-bold mx-1 focus:outline-none focus:ring-0"
                />
              </div>
            )}
            inputType="tel"
            shouldAutoFocus
            placeholder=""
          />
        </div>
        {error && (
          <div
            className={` text-center font-pincuk text-xl tracking-wider mt-2 ${
              error.includes("resent") ? "text-green-500" : "text-red-500"
            }`}
          >
            {error}
          </div>
        )}
        <Button
          onClick={handleVerify}
          disabled={isVerifying || otp.length !== 6}
          className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
        >
          {isVerifying ? "Verifying..." : "Verify"}
        </Button>
        <p className=" text-center text-black dark:text-white font-pincuk text-xl tracking-wider mt-2">
          Didn't receive a code?{" "}
          <button
            onClick={handleResendOtp}
            disabled={requestOtp.isPending}
            className="underline text-[#C026D3] cursor-pointer"
          >
            {requestOtp.isPending ? "Sending..." : "Resend"}
          </button>
        </p>
      </AlertDialogContent>
    </AlertDialog>
  );
}
</file>

<file path="src/components/modals/SignUpModal.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
/* eslint-disable @typescript-eslint/no-unused-vars */
import { useState } from "react";
import { useCreateUser } from "../../backend/user.service";
import { useTrackSignupClick } from "../../backend/signup.analytics.service";
import { useSystemConfigByKey } from "../../backend/configuration.service";
import { toast } from "sonner";
import { Formik, Form, Field, ErrorMessage } from "formik";
import type { FormikHelpers, FieldProps } from "formik";
import * as Yup from "yup";
import {
  passwordSchema,
  confirmPasswordSchema,
} from "../../validation/password";
import PhoneInput from "react-phone-input-2";
import "react-phone-input-2/lib/style.css";
import "../../styles/phone-input.css";
import {
  Dialog,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "../../components/ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { Button } from "../../components/ui/button";
import { Input } from "../../components/ui/input";
import { Label } from "../../components/ui/label";
import { Checkbox } from "../../components/ui/checkbox";
import { FaEye, FaEyeSlash } from "react-icons/fa";
import { TbUser } from "react-icons/tb";
import { AiOutlineMail } from "react-icons/ai";
import { useNavigate } from "react-router-dom";
import { getVisitorSessionId } from "../../utils/sessionUtils";

const getAuthFields = (config?: { value?: { settings: any } }) => {
  // Default state when no config or invalid config
  const defaultFields = {
    showAll: true,
    showEmail: true,
    showPhone: true,
    firstName: true,
    lastName: true,
  };

  if (!config?.value?.settings) return defaultFields;

  const { both, email, sms } = config.value.settings;

  // Guard against undefined settings
  if (!both || !email || !sms) return defaultFields;

  if (both.enabled) {
    return {
      showAll: false,
      showEmail: true,
      showPhone: true,
      firstName: true,
      lastName: true,
    };
  }

  if (email.enabled) {
    return {
      showAll: false,
      showEmail: true,
      showPhone: false,
      firstName: !!email.firstName,
      lastName: !!email.lastName,
    };
  }

  if (sms.enabled) {
    return {
      showAll: false,
      showEmail: false,
      showPhone: true,
      firstName: !!sms.firstName,
      lastName: !!sms.lastName,
    };
  }

  return defaultFields;
};

const getValidationSchema = (config?: { value?: { settings: any } }) => {
  const fields = getAuthFields(config);
  const schema: any = {
    password: passwordSchema,
    confirmPassword: confirmPasswordSchema,
    ageConfirm: Yup.boolean().default(false),
    terms: Yup.boolean()
      .oneOf([true], "You must accept the terms of use")
      .required("You must accept the terms of use"),
  };

  if (fields.showAll || fields.showEmail) {
    schema.email = Yup.string()
      .email("Invalid email address")
      .required("Email is required");
  }

  if (fields.showAll || fields.showPhone) {
    schema.phoneNumber = Yup.string().required("Phone number is required");
  }

  if (fields.firstName) {
    schema.firstName = Yup.string().required("First name is required");
  }

  if (fields.lastName) {
    schema.lastName = Yup.string().required("Last name is required");
  }

  return Yup.object(schema);
};

const getInitialValues = (config?: { value?: { settings: any } }) => {
  const fields = getAuthFields(config);
  const values: any = {
    password: "",
    confirmPassword: "",
    ageConfirm: false,
    terms: false,
  };

  if (fields.showAll || fields.showEmail) values.email = "";
  if (fields.showAll || fields.showPhone) values.phoneNumber = "";
  if (fields.firstName) values.firstName = "";
  if (fields.lastName) values.lastName = "";

  return values;
};

interface SignUpDialogProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  openLoginModal: () => void;
}

// Format phone number
const formatPhoneNumber = (value?: string) => (value ? `+${value}` : value);




export function SignUpModal({
  open,
  onOpenChange,
  openLoginModal,
}: SignUpDialogProps) {
  const [showPassword, setShowPassword] = useState(false);
  const { data: config } = useSystemConfigByKey("authentication_settings");
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  const togglePasswordVisibility = () => setShowPassword(!showPassword);
  const toggleConfirmPasswordVisibility = () =>
    setShowConfirmPassword(!showConfirmPassword);

  const createUser = useCreateUser();
  const { mutate: trackSignup } = useTrackSignupClick();

  const handleSignUp = async (
    values: ReturnType<typeof getInitialValues>,
    actions: FormikHelpers<ReturnType<typeof getInitialValues>>
  ) => {
    try {
      // Track the final signup button click with session ID
      trackSignup({
        sessionId: getVisitorSessionId(),
        type: 'signup-modal'
      });

      await createUser.mutateAsync({
        firstName: values.firstName,
        lastName: values.lastName,
        email: values.email,
        password: values.password,
        phoneNumber: values.phoneNumber,
        isAdult: values.ageConfirm,
        hasAcceptedTerms: values.terms,
      });

      // Close signup modal
      onOpenChange(false);

      toast.success("Account created successfully! Please login to continue.");
      openLoginModal();
    } catch (error: any) {
      actions.setStatus({ error: "Failed to create account" });
    } finally {
      actions.setSubmitting(false);
    }
  };

  const navigate = useNavigate();
  const handleTerms = () => {
    onOpenChange(false);
    navigate("/terms");
  };

  const handlePrivacy = () => {
    onOpenChange(false);
    navigate("/privacy");
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <CustomDialogContent className="sm:max-w-[425px] dark:bg-[#0F1221]">
        {/* Custom Close Button */}
        <button
          className="absolute -top-4 -right-4 w-10 h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={() => onOpenChange(false)}
          aria-label="Close"
          style={{ border: "none" }}
        >
          <span className="text-white text-2xl font-bold"></span>
        </button>
        <DialogHeader>
          <DialogTitle className="text-2xl font-bold text-[#E328AF] text-center font-boogaloo">
            Sign Up
          </DialogTitle>
          <DialogDescription className="text-center">
            <Formik
              initialValues={getInitialValues(config)}
              validationSchema={getValidationSchema(config)}
              onSubmit={handleSignUp}
              validateOnMount={false}
              validateOnChange={false}
              validateOnBlur={false}
            >
              {({ isSubmitting }) => (
                <Form className="space-y-1">
                  {/* Authentication Fields */}
                  {(() => {
                    const fields = getAuthFields(config);
                    return (
                      <>
                        {(fields.showAll || fields.showEmail) && (
                          <div className="relative">
                            <Label
                              htmlFor="email"
                              className="font-boogaloo text-base text-black dark:text-white"
                            >
                              E-Mail
                            </Label>
                            <div className="relative">
                              <AiOutlineMail
                                size={15}
                                className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"
                              />
                              <Field
                                as={Input}
                                id="email"
                                name="email"
                                placeholder="Enter Email"
                                className="mt-1 bg-[#E2E8F0] border-0 pl-10 font-boogaloo text-lg tracking-wider text-[11px] font-normal h-[48px]"
                              />
                            </div>
                            <ErrorMessage
                              name="email"
                              component="div"
                              className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                            />
                          </div>
                        )}

                        {(fields.showAll || fields.showPhone) && (
                          <div className="relative">
                            <Label
                              htmlFor="phoneNumber"
                              className="font-boogaloo text-base text-black dark:text-white"
                            >
                              Phone Number
                            </Label>
                            <Field name="phoneNumber">
                              {({ field, form }: FieldProps) => (
                                <div className="w-full mt-1">
                                  <PhoneInput
                                    country="us"
                                    value={field.value}
                                    onChange={(value) =>
                                      form.setFieldValue(
                                        "phoneNumber",
                                        formatPhoneNumber(value)
                                      )
                                    }
                                    inputStyle={{
                                      width: "100%",
                                      height: "48px",
                                      backgroundColor: "#E2E8F0",
                                      border: "0",
                                      borderRadius: "0.375rem",
                                      fontFamily: "boogaloo",
                                      fontSize: "11px",
                                    }}
                                    containerClass="dark:bg-[#191c2b]"
                                    buttonStyle={{
                                      backgroundColor: "#E2E8F0",
                                      border: "0",
                                      borderRadius: "0.375rem 0 0 0.375rem",
                                    }}
                                    dropdownStyle={{
                                      backgroundColor: "#E2E8F0",
                                      color: "#000",
                                    }}
                                    searchStyle={{
                                      backgroundColor: "##E2E8F0",
                                      color: "#000",
                                    }}
                                    enableAreaCodeStretch
                                    autoFormat
                                    enableSearch
                                    disableSearchIcon
                                    autocompleteSearch
                                    countryCodeEditable={false}
                                  />
                                </div>
                              )}
                            </Field>
                            <ErrorMessage
                              name="phoneNumber"
                              component="div"
                              className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                            />
                          </div>
                        )}

                        {/* Name Fields */}
                        {(fields.firstName || fields.lastName) && (
                          <div className="flex space-x-4 mt-4">
                            {fields.firstName && (
                              <div className="flex-1 relative">
                                <Label
                                  htmlFor="firstName"
                                  className="font-boogaloo text-base text-black dark:text-white"
                                >
                                  First Name
                                </Label>
                                <div className="relative">
                                  <TbUser
                                    size={15}
                                    className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"
                                  />
                                  <Field
                                    as={Input}
                                    id="firstName"
                                    name="firstName"
                                    placeholder="Enter First Name"
                                    className="mt-1 bg-[#E2E8F0] border-0 pl-10 font-boogaloo text-lg tracking-wider text-[11px] font-normal h-[48px]"
                                  />
                                </div>
                                <ErrorMessage
                                  name="firstName"
                                  component="div"
                                  className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                                />
                              </div>
                            )}
                            {fields.lastName && (
                              <div className="flex-1 relative">
                                <Label
                                  htmlFor="lastName"
                                  className="font-boogaloo text-base text-black dark:text-white"
                                >
                                  Last Name
                                </Label>
                                <div className="relative">
                                  <TbUser
                                    size={15}
                                    className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"
                                  />
                                  <Field
                                    as={Input}
                                    id="lastName"
                                    name="lastName"
                                    placeholder="Enter Last Name"
                                    className="mt-1 bg-[#E2E8F0] border-0 pl-10 font-boogaloo text-lg tracking-wider text-[11px] font-normal h-[48px]"
                                  />
                                </div>
                                <ErrorMessage
                                  name="lastName"
                                  component="div"
                                  className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                                />
                              </div>
                            )}
                          </div>
                        )}
                      </>
                    );
                  })()}

                  {/* Password Fields */}
                  <div className="relative mt-4">
                    <Label
                      htmlFor="password"
                      className="font-boogaloo text-base text-black dark:text-white"
                    >
                      Password
                    </Label>
                    <div className="relative">
                      <button
                        type="button"
                        onClick={togglePasswordVisibility}
                        className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"
                        aria-label={
                          showPassword ? "Hide password" : "Show password"
                        }
                      >
                        {showPassword ? (
                          <FaEyeSlash size={15} />
                        ) : (
                          <FaEye size={15} />
                        )}
                      </button>
                      <Field
                        as={Input}
                        id="password"
                        name="password"
                        type={showPassword ? "text" : "password"}
                        placeholder="Enter Password"
                        className="mt-1 bg-[#E2E8F0] border-0 pl-10 pr-10 font-boogaloo text-lg tracking-wider text-[11px] font-normal h-[48px]"
                      />
                    </div>
                    <ErrorMessage
                      name="password"
                      component="div"
                      className="text-red-500 mt-1 font-boogaloo text-sm tracking-wider"
                    />
                  </div>
                  <div className="relative mt-4">
                    <Label
                      htmlFor="confirmPassword"
                      className="font-boogaloo text-base text-black dark:text-white"
                    >
                      Confirm Password
                    </Label>
                    <div className="relative">
                      <button
                        type="button"
                        onClick={toggleConfirmPasswordVisibility}
                        className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"
                        aria-label={
                          showConfirmPassword
                            ? "Hide password"
                            : "Show password"
                        }
                      >
                        {showConfirmPassword ? (
                          <FaEyeSlash size={15} />
                        ) : (
                          <FaEye size={15} />
                        )}
                      </button>
                      <Field
                        as={Input}
                        id="confirmPassword"
                        name="confirmPassword"
                        type={showConfirmPassword ? "text" : "password"}
                        placeholder="Confirm Password"
                        className="mt-1 bg-[#E2E8F0] border-0 pl-10 pr-10 font-boogaloo text-lg tracking-wider text-[11px] font-normal h-[48px]"
                      />
                    </div>
                    <ErrorMessage
                      name="confirmPassword"
                      component="div"
                      className="text-red-500  mt-1 font-boogaloo text-sm tracking-wider"
                    />
                  </div>
                  <div className="my-5 flex flex-col gap-3">
                    <div className="flex items-center space-x-2">
                      <Field name="ageConfirm">
                        {({ field, form }: FieldProps) => (
                          <Checkbox
                            id="ageConfirm"
                            checked={field.value}
                            onCheckedChange={(checked) => {
                              form.setFieldValue("ageConfirm", checked);
                              form.setFieldTouched("ageConfirm", true);
                            }}
                            className="border-2 border-gray-400 data-[state=checked]:bg-[#C026D3] data-[state=checked]:border-[#C026D3]"
                          />
                        )}
                      </Field>
                      <Label
                        htmlFor="ageConfirm"
                        className="font-boogaloo text-black dark:text-white cursor-pointer"
                      >
                        Confirm age 18+
                      </Label>
                    </div>
                    <ErrorMessage
                      name="ageConfirm"
                      component="div"
                      className="text-red-500  font-boogaloo text-sm tracking-wider"
                    />
                    <div className="flex items-center space-x-2">
                      <Field name="terms">
                        {({ field, form }: FieldProps) => (
                          <Checkbox
                            id="terms"
                            checked={field.value}
                            onCheckedChange={(checked) => {
                              form.setFieldValue("terms", checked);
                              form.setFieldTouched("terms", true);
                            }}
                            className="border-2 border-gray-400 data-[state=checked]:bg-[#C026D3] data-[state=checked]:border-[#C026D3]"
                          />
                        )}
                      </Field>
                      <Label
                        htmlFor="terms"
                        className="font-boogaloo text-black dark:text-white cursor-pointer"
                      >
                        Accept Terms of Use
                      </Label>
                    </div>
                    <ErrorMessage
                      name="terms"
                      component="div"
                      className="text-red-500  font-boogaloo text-sm tracking-wider"
                    />
                  </div>
                  <Button
                    type="submit"
                    disabled={isSubmitting}
                    className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
                  >
                    {isSubmitting ? "Creating Account..." : "Sign Up"}
                  </Button>
                </Form>
              )}
            </Formik>
          </DialogDescription>
        </DialogHeader>
        <p className=" text-center text-black dark:text-white font-boogaloo text-lg tracking-wider">
          Already have an account?{" "}
          <span
            className="underline text-[#C026D3] cursor-pointer font-boogaloo text-lg"
            onClick={openLoginModal}
          >
            Login
          </span>
        </p>
        {/* terms and privacy */}
        <div className="font-pincuk flex space-2 text-lg justify-center">
          <p
            className="text-[#C026D3] text-center cursor-pointer tracking-wider mr-4 hover:underline"
             onClick={handleTerms}
          >
            Terms of Service
          </p>
          <p
            className="text-gray-400 text-center cursor-pointer tracking-wider mr-4 underline"
             onClick={handlePrivacy}
          >
            Privacy Policy
          </p>
        </div>
      </CustomDialogContent>
    </Dialog>
  );
}
</file>

<file path="src/components/modals/StatsModal.tsx">
import { Dialog } from "../ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { FiClock, FiInfo } from "react-icons/fi";
import { LuGamepad2 } from "react-icons/lu";
import { BsController } from "react-icons/bs";
import statImg from '../../assets/stat-img.svg';
import { useCurrentUserStats } from '../../backend/analytics.service';
import { formatTime } from '../../utils/main';

const formatRelativeTime = (date: Date) => {
  const now = new Date();
  const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);

  if (diffInSeconds < 60) {
    return "Just now";
  } else if (diffInSeconds < 3600) {
    const minutes = Math.floor(diffInSeconds / 60);
    return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
  } else if (diffInSeconds < 86400) {
    const hours = Math.floor(diffInSeconds / 3600);
    return `${hours} hour${hours > 1 ? 's' : ''} ago`;
  } else {
    const days = Math.floor(diffInSeconds / 86400);
    return `${days} day${days > 1 ? 's' : ''} ago`;
  }
};

interface StatsModalProps {
  open: boolean;
  onClose: () => void;
}

export function StatsModal({ open, onClose }: StatsModalProps) {
  const { data: stats, isLoading, isError } = useCurrentUserStats();

  if (isError) {
    return (
      <Dialog open={open} onOpenChange={onClose}>
        <CustomDialogContent className="bg-white dark:bg-[#18192b] rounded-2xl shadow-lg p-4 sm:p-6 max-w-[95vw] sm:max-w-[90vw] w-full sm:w-[600px] border-none">
          <div className="text-center text-red-500 text-sm sm:text-base">
            Error loading statistics. Please try again later.
          </div>
        </CustomDialogContent>
      </Dialog>
    );
  }

  return (
    <Dialog open={open} onOpenChange={onClose}>
      <CustomDialogContent className="bg-white dark:bg-[#18192b] rounded-2xl shadow-lg p-4 sm:p-6 max-w-[95vw] sm:max-w-[90vw] w-full sm:w-[600px] border-none font-boogaloo tracking-wider">
        {/* Close Button */}
        <button
          className="absolute -top-3 -right-3 w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-[#C026D3] flex items-center justify-center shadow-lg hover:bg-[#a21caf] transition-colors"
          onClick={onClose}
          aria-label="Close"
          style={{ border: 'none' }}
        >
          <span className="text-white text-xl sm:text-2xl font-bold"></span>
        </button>

        {/* Header */}
        <h2 className="text-2xl sm:text-3xl font-bold text-center mb-6 sm:mb-8 text-[#C026D3] font-boogaloo">User Stats</h2>

        {/* Scrollable Content */}
        <div className="max-h-[80vh] sm:max-h-[70vh] overflow-y-auto overflow-x-hidden scrollbar-hide w-full">
          {/* Stats Summary */}
          <div className="flex flex-col sm:flex-row gap-4 sm:gap-6 justify-center mb-6 sm:mb-8">
            {isLoading ? (
              <div className="w-full text-center py-4">
                <div className="inline-block h-6 w-6 sm:h-8 sm:w-8 animate-spin rounded-full border-4 border-solid border-[#C026D3] border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]" />
              </div>
            ) : !stats ? (
              <div className="w-full text-center py-6 sm:py-8">
                <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-xl p-4 sm:p-6">
                  <div className="flex flex-col items-center gap-4">
                    <div className="bg-[#E879F9] rounded-full p-3">
                      <BsController className="w-6 h-6 sm:w-8 sm:h-8 text-white" />
                    </div>
                    <h3 className="text-xl sm:text-2xl font-bold dark:text-white text-[#0F1621]">No Game Stats Yet</h3>
                    <p className="text-center dark:text-[#bdbdbd] text-[#334154] text-sm sm:text-base max-w-md">
                      Start playing games to see your statistics here! Your gaming journey begins with your first play.
                    </p>
                  </div>
                </div>
              </div>
            ) : (
              <>
                <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-xl p-4 sm:p-6 w-full flex items-start">
                  <div className="bg-[#E879F9] rounded-full p-2 sm:p-3 flex items-center justify-center">
                    <FiClock className="w-6 h-6 sm:w-8 sm:h-8 text-white" />
                  </div>
                  <div className="ml-3 sm:ml-4">
                    <div className="dark:text-white text-[#0F1621] font-bold text-base sm:text-lg">Minutes Played</div>
                    <div className="dark:text-white text-[#0F1621] text-lg sm:text-xl">
                      {formatTime(stats.totalSeconds || 0)}
                    </div>
                  </div>
                </div>
                <div className="flex items-center bg-[#F1F5F9] dark:bg-[#121C2D] rounded-xl p-4 sm:p-6 w-full">
                  <div className="bg-[#E879F9] rounded-full p-2 sm:p-3">
                    <LuGamepad2 className="w-8 h-8 sm:w-10 sm:h-10 text-white dark:text-[#0F1621]" />
                  </div>
                  <div className="flex flex-col ml-4 sm:ml-6">
                    <span className="dark:text-white text-[#0F1621] font-bold text-base sm:text-lg tracking-widest mb-2">Total Plays</span>
                    <div className="">
                      <span className="dark:text-white text-[#0F1621] text-lg sm:text-xl font-thin font-sans">
                        {stats.totalPlays || 0}
                      </span>
                    </div>
                  </div>
                </div>
              </>
            )}
          </div>

          {/* Games Played */}
          {isLoading ? (
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-xl p-4 sm:p-6 text-center">
              <div className="inline-block h-6 w-6 sm:h-8 sm:w-8 animate-spin rounded-full border-4 border-solid border-[#C026D3] border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]" />
            </div>
          ) : !stats ? null : (
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-xl p-4 sm:p-6">
              <h3 className="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 text-[#C026D3]">Games Played</h3>

              <div className="mb-4 grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div className="text-lg sm:text-xl font-bold dark:text-white text-[#0F1621] hidden sm:block">Game</div>
                <div className="text-lg sm:text-xl font-bold dark:text-white text-[#0F1621] hidden sm:block">Total Time Spent</div>
                <div className="text-lg sm:text-xl font-bold dark:text-white text-[#0F1621] hidden sm:block">Last Played</div>
              </div>

              {!stats.gamesPlayed || stats.gamesPlayed.length === 0 || !stats.gamesPlayed.some(game => game && game.gameId && game.title) ? (
                <div className="text-center py-6 sm:py-8">
                  <div className="flex flex-col items-center gap-4">
                    <div className="bg-[#E879F9] rounded-full p-3">
                      <FiInfo className="w-5 h-5 sm:w-6 sm:h-6 text-white" />
                    </div>
                    <p className="dark:text-[#bdbdbd] text-[#334154] text-sm sm:text-base">
                      You haven't played any games yet. Jump into a game to start tracking your progress!
                    </p>
                  </div>
                </div>
              ) : (
                <div className="divide-y divide-[#35364d]">
                  {stats.gamesPlayed.map((game) => (
                    <div key={game.gameId} className="py-4 grid grid-cols-1 sm:grid-cols-3 gap-4 items-center">
                      <div className="flex items-center">
                        <img
                          src={game.thumbnailUrl || statImg}
                          alt={game.title || "Game"}
                          className="w-10 h-10 sm:w-12 sm:h-12 rounded-lg mr-3"
                          onError={(e) => {
                            e.currentTarget.src = statImg;
                          }}
                        />
                        <div>
                          <span className="font-bold text-base sm:text-lg block sm:inline">{game.title}</span>
                          <div className="sm:hidden text-sm dark:text-[#bdbdbd] text-[#334154] mt-1">
                            <span className="font-bold">Time: </span>{formatTime(game.totalSeconds || 0)}<br />
                            <span className="font-bold">Last Played: </span>
                            {game.lastPlayed ? formatRelativeTime(new Date(game.lastPlayed)) : "-"}
                          </div>
                        </div>
                      </div>
                      <div className="dark:text-[#bdbdbd] text-[#334154] hidden sm:block">{formatTime(game.totalSeconds || 0)}</div>
                      <div className="dark:text-[#bdbdbd] text-[#334154] hidden sm:block">
                        {game.lastPlayed ? formatRelativeTime(new Date(game.lastPlayed)) : "-"}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}
        </div>
      </CustomDialogContent>
    </Dialog>
  );
}
</file>

<file path="src/components/modals/ToggleGameStatusModal.tsx">
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogClose } from "../ui/dialog";
import { Button } from "../ui/button";
import { XIcon } from "lucide-react";

interface ToggleGameStatusModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onConfirm: () => void;
  isToggling?: boolean;
  gameStatus: string;
  gameTitle?: string;
}

export function ToggleGameStatusModal({
  open,
  onOpenChange,
  onConfirm,
  isToggling = false,
  gameStatus,
  gameTitle = "this game"
}: ToggleGameStatusModalProps) {
  const isActive = gameStatus === "active";
  const action = isActive ? "disable" : "enable";
  const actionCapitalized = isActive ? "Disable" : "Enable";

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent
        className="rounded-2xl border-0 shadow-sm p-8 max-w-lg font-boogaloo tracking-wide dark:bg-[#232B3B] bg-white"
        style={{ boxShadow: "0 2px 4px 2px #e879f9" }}
        hideClose
      >
        <DialogHeader>
          <DialogTitle className="text-2xl tracking-wider mb-2 text-[#121C2D] dark:text-white">
            Are you sure you want to {action} {gameTitle}?
          </DialogTitle>
        </DialogHeader>
        <div className="mb-8 text-[#121C2D] dark:text-[#CBD5E0] font-pincuk text-xl tracking-wider">
          {isActive
            ? "Players will not be able to access this game until you enable it again."
            : "Players will be able to access this game once enabled."
          }
        </div>
        <DialogFooter className="flex justify-end gap-4">
          <DialogClose asChild>
            <Button
              variant="outline"
              className="px-3 py-2 rounded-lg bg-[#F8FAFC] border border-[#E2E8F0] text-[#232B3B] dark:bg-white dark:text-[#232B3B]"
            >
              Cancel
            </Button>
          </DialogClose>
          <Button
            className="bg-[#D946EF] text-white px-3 py-2 rounded-lg tracking-wider hover:bg-[#c026d3]"
            onClick={onConfirm}
            disabled={isToggling}
          >
            {isToggling ? `${actionCapitalized.slice(0, -1)}ing...` : actionCapitalized}
          </Button>
        </DialogFooter>
        <DialogClose asChild>
          <button className="absolute -top-4 -right-4 rounded-full bg-[#C026D3] w-10 h-10 flex items-center justify-center text-white">
            <XIcon className="w-6 h-6" />
          </button>
        </DialogClose>
      </DialogContent>
    </Dialog>
  );
}
</file>

<file path="src/components/modals/WelcomeModal.tsx">
import {
    Dialog,
    DialogDescription,
    DialogHeader,
    DialogTitle,
} from "../../components/ui/dialog";
import { CustomDialogContent } from "../ui/custom-dialog-content";
import { Button } from "../../components/ui/button";

interface WelcomeDialogProps {
    open: boolean;
    onOpenChange: (open: boolean) => void;
}

export function WelcomeModal({ open, onOpenChange }: WelcomeDialogProps) {
    return (
        <Dialog open={open} onOpenChange={onOpenChange}>
            <CustomDialogContent className="sm:max-w-[425px] dark:bg-[#334154] rounded-lg p-6 border-none">
                <button
                    onClick={() => onOpenChange(false)}
                    className="cursor-pointer absolute -top-4 -right-4 w-8 h-8 rounded-full bg-[#C026D3] text-white font-bold text-xl flex items-center justify-center"
                    aria-label="Close"
                >
                    
                </button>
                <DialogHeader>
                    <DialogTitle className="text-2xl font-bold dark:text-white text-black text-left font-boogaloo">
                        Welcome to Our Website
                    </DialogTitle>
                    <DialogDescription className="text-left dark:text-white text-black font-pincuk text-xl tracking-wider mt-1">
                        Please take a moment to review our new features
                    </DialogDescription>
                </DialogHeader>
                <div className="space-y-4 mt-6">
                    <Button
                        className="w-full bg-[#FFC107] hover:bg-[#FFB300] text-black font-pincuk text-xl tracking-wider py-3 rounded-md"
                        onClick={() => onOpenChange(false)}
                    >
                        New added games
                    </Button>
                    <Button
                        className="w-full bg-[#E328AF] hover:bg-[#C026D3] text-black font-pincuk text-xl tracking-wider py-3 rounded-md"
                        onClick={() => onOpenChange(false)}
                    >
                        Larger game screen
                    </Button>
                </div>
            </CustomDialogContent>
        </Dialog>
    );
}
</file>

<file path="src/components/single/AdminNavbar.tsx">
import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';
import { Button } from '../ui/button';

import { IoMdSettings } from "react-icons/io";
// import { IoIosSearch } from "react-icons/io";
// import { CommandInput } from '../ui/command';
import { IoExitOutline } from "react-icons/io5";



import sun from '../../assets/sun.svg';
import moon from '../../assets/moon.svg';


const AdminNavbar: React.FC = () => {
  const { logout } = useAuth();
  const [isDarkMode, setIsDarkMode] = useState(() => {
    const savedMode = localStorage.getItem('darkMode');
    return savedMode ? JSON.parse(savedMode) : false;
  });

  const [showSearch, setShowSearch] = useState(false);
  const searchInputRef = React.useRef<HTMLInputElement>(null);
  // const [searchValue, setSearchValue] = useState("");

  const navigate = useNavigate();

  useEffect(() => {
    localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
    if (isDarkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  }, [isDarkMode]);

  useEffect(() => {
    if (!showSearch) return;
    function handleKeyDown(e: KeyboardEvent) {
      if (e.key === "Escape") setShowSearch(false);
    }
    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [showSearch]);

  useEffect(() => {
    if (showSearch && searchInputRef.current) {
      searchInputRef.current.focus();
    }
  }, [showSearch]);

  const toggleDarkMode = () => {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    setIsDarkMode((prev: any) => !prev);
  };

  return (
    <header className="flex justify-between p-4 items-center bg-white dark:bg-[#0f1221] transition-colors duration-300">
      <div
        onClick={() => navigate('/')}
        className="text-2xl font-extrabold text-[#D946EF] dark:text-[#E879F9] cursor-pointer"
      >
        CHARELI
      </div>

      {/* right side */}
      <div className='flex gap-4 items-center'>
        <div className="font-extrabold text-[#D946EF] dark:text-[#E879F9] flex items-center gap-4">
          {/* {!showSearch ? (
            <button
              aria-label="Open search"
              onClick={() => setShowSearch(true)}
              className="focus:outline-none"
            >
              <IoIosSearch className='w-6 h-6' />
            </button>
          ) : (
            <div className="relative">
              <input
                ref={searchInputRef}
                value={searchValue}
                onChange={e => setSearchValue(e.target.value)}
                placeholder="Search..."
                className="w-60 px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-[#D946EF] transition placeholder:text-gray-400 text-normal tracking-wider text-gray-400"
                onBlur={() => {
                  if (searchValue === "") setShowSearch(false);
                }}
                autoFocus
              />
              {searchValue && (
                <button
                  type="button"
                  className="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
                  onClick={() => setSearchValue("")}
                  tabIndex={-1}
                >
                  &#10005;
                </button>
              )}
            </div>
          )} */}
          <IoMdSettings className='w-6 h-6 cursor-pointer' onClick={() => navigate('/admin/settings')} />
        </div>
        <div className="space-x-4 flex items-center">
          <img
            onClick={toggleDarkMode}
            src={isDarkMode ? moon : sun}
          alt={isDarkMode ? 'light mode' : 'dark mode'}
          className="w-6 h-6 cursor"
          />
          <Button
            onClick={() => {
              logout();
              navigate('/');
            }}
            className="bg-transparent flex items-center gap-2 text-red-500 hover:bg-red-500 hover:text-white"
          >
            <IoExitOutline className="w-5 h-5" />
            Logout
          </Button>
        </div>
      </div>
    </header>
  );
};

export default AdminNavbar;
</file>

<file path="src/components/single/AllGamesSection.tsx">
import { Card } from "../../components/ui/card";
import { Button } from "../../components/ui/button";
import { useNavigate } from "react-router-dom";
import { useGames } from "../../backend/games.service";
import { useCategories } from "../../backend/category.service";
import { useState } from "react";
import GamesSkeleton from "./GamesSkeleton";

import emptyGameImg from "../../assets/empty-game.png";

interface AllGamesSectionProps {
    searchQuery: string;
}

const AllGamesSection = ({ searchQuery }: AllGamesSectionProps) => {
    const navigate = useNavigate();
    const [selectedCategory, setSelectedCategory] = useState("all");
    const { data: categoriesData, isLoading: categoriesLoading } = useCategories();
    const { data: gamesData, isLoading: gamesLoading, error: gamesError } = useGames({
        categoryId: selectedCategory === "all" ? undefined : selectedCategory === "recent" ? undefined : selectedCategory,
        filter: selectedCategory === "recent" ? "recently_added" : undefined,
        status: "active",
        search: searchQuery || undefined
    });

    // Combine static filters with dynamic categories
    const allCategories = [
        { id: "all", name: "All Games", color: "#C026D3" },
        ...(categoriesData?.map(cat => ({
            id: cat.id,
            name: cat.name,
            color: "#94A3B7"
        })) || []),
        { id: "recent", name: "Recently Added", color: "#94A3B7" }
    ];

    const games: any = gamesData || [];

    const handleGamePlay = (gameId: string) => {
        navigate(`/gameplay/${gameId}`);
    };

    return (
        <div className="p-4">
            <div>
                <h1 className="text-[#D946EF] text-3xl mb-4 font-boogaloo">All Games</h1>
            </div>
            {/* filtering tabs */}
            <div className="flex gap-3 mb-8 flex-wrap">
                {categoriesLoading ? (
                    <div>Loading categories...</div>
                ) : (
                    allCategories.map(category => (
                    <Button
                        key={category.id}
                        className={`text-white ${selectedCategory === category.id ? 'bg-[#C026D3]' : 'bg-[#94A3B7]'}`}
                        onClick={() => setSelectedCategory(category.id)}
                    >
                        {category.name}
                    </Button>
                    ))
                )}
            </div>

            <div className="">
                <Card className="border-hidden shadow-none p-0 dark:bg-[#0f1221]">
                    {gamesLoading ? (
                        <GamesSkeleton count={9} showCategories={true} />
                    ) : gamesError ? (
                        <div className="text-center py-8 text-red-500">Error loading games</div>
                    ) : games.length === 0 ? (
                        <div className="text-center py-8 min-h-[60vh] flex flex-col items-center justify-center gap-4 text-[#C026D3] text-4xl">
                            <img src={emptyGameImg} alt="No games" className="w-80 h-80 object-contain" />
                            No games found for {selectedCategory === "all" ? "all categories" :
                                              selectedCategory === "recent" ? "recently added" :
                                              allCategories.find(cat => cat.id === selectedCategory)?.name || "this category"}
                        </div>
                    ) : (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 auto-rows-[150px]">
                            {games.map((game: any, index: number) => {
                                // Alternate between different spans for subtle height variations
                                const spans = [1, 1.3, 1.1]; // More subtle height differences
                                const spanIndex = index % spans.length;
                                const rowSpan = spans[spanIndex];

                                return (
                                    <div
                                        key={game.id}
                                        className="relative group cursor-pointer"
                                        style={{ gridRow: `span ${Math.round(rowSpan * 2)}` }}
                                        onClick={() => handleGamePlay(game.id)}
                                    >
                                        <div className="relative h-full overflow-hidden rounded-[20px]">
                                            <img
                                                src={game.thumbnailFile?.s3Key}
                                                alt={game.title}
                                                loading="lazy"
                                                className="w-full h-full object-cover border-4 border-transparent group-hover:border-[#D946EF] transition-all duration-300 ease-in-out group-hover:scale-105 group-hover:shadow-[0_0_20px_rgba(217,70,239,0.3)]"
                                            />
                                            <div className="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                                <span className="absolute bottom-3 left-4 text-white font-bold text-xl drop-shadow-lg">
                                                    {game.title}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}
                </Card>
            </div>
        </div>
    );
};

export default AllGamesSection;
</file>

<file path="src/components/single/ChangePassword-Sheet.tsx">
/* eslint-disable @typescript-eslint/no-unused-vars */
import { useState } from "react";
import { Formik, Form, Field } from "formik";
import * as Yup from "yup";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetFooter,
  SheetClose,
} from "../ui/sheet";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import { Button } from "../ui/button";
import { useChangePassword } from "../../backend/user.service";
import { useAuth } from "../../context/AuthContext";
import { toast } from "sonner";
import { passwordSchema } from "../../validation/password";

interface ChangePasswordSheetProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

interface ChangePasswordValues {
  oldPassword: string;
  newPassword: string;
}

const validationSchema = Yup.object({
  oldPassword: Yup.string().required("Old password is required"),
  newPassword: passwordSchema
});

const initialValues: ChangePasswordValues = {
  oldPassword: "",
  newPassword: ""
};

export function ChangePasswordSheet({ open, onOpenChange }: ChangePasswordSheetProps) {
  const [showOldPassword, setShowOldPassword] = useState(false);
  const [showNewPassword, setShowNewPassword] = useState(false);

  const changePassword = useChangePassword();
  const { user } = useAuth();

  const handleSubmit = async (values: ChangePasswordValues) => {
    try {
      if (!user?.id) {
        toast.error("User ID not found");
        return;
      }

      await changePassword.mutateAsync({
        password: values.newPassword,
        oldPassword: values.oldPassword
      });
      toast.success("Password changed successfully");
      onOpenChange(false);
    } catch (error) {
      toast.error("Failed to change password. Please check your old password.");
    }
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetContent side="right" className="max-w-md w-full p-6 font-boogaloo dark:bg-[#0F1621]">
        <SheetHeader>
          <SheetTitle className="text-lg mt-4 tracking-wider border-b">Change Password</SheetTitle>
        </SheetHeader>
        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
        >
          {({ errors, touched, isSubmitting }) => (
            <Form className="space-y-6">
              <div className="flex flex-col gap-6 px-2">
                <div>
                  <Label htmlFor="oldPassword" className="text-base mb-1">
                    Old Password
                  </Label>
                  <div className="relative">
                    <Field
                      as={Input}
                      id="oldPassword"
                      name="oldPassword"
                      type={showOldPassword ? "text" : "password"}
                      placeholder="Enter old password"
                      className="bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white h-14 shadow-none pr-12"
                    />
                    <button
                      type="button"
                      onClick={() => setShowOldPassword(v => !v)}
                      className="absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500"
                      tabIndex={-1}
                    >
                      {showOldPassword ? "Hide" : "Show"}
                    </button>
                  </div>
                  {errors.oldPassword && touched.oldPassword && (
                    <p className="text-red-500 text-xs mt-1">{errors.oldPassword}</p>
                  )}
                </div>
                <div>
                  <Label htmlFor="newPassword" className="text-base mb-1">
                    New Password
                  </Label>
                  <div className="relative">
                    <Field
                      as={Input}
                      id="newPassword"
                      name="newPassword"
                      type={showNewPassword ? "text" : "password"}
                      placeholder="Enter new password"
                      className="bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white h-14 shadow-none pr-12"
                    />
                    <button
                      type="button"
                      onClick={() => setShowNewPassword(v => !v)}
                      className="absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 dark:text-white"
                      tabIndex={-1}
                    >
                      {showNewPassword ? "Hide" : "Show"}
                    </button>
                  </div>
                  {errors.newPassword && touched.newPassword && (
                    <p className="text-red-500 text-xs mt-1">{errors.newPassword}</p>
                  )}
                </div>
              </div>
              <SheetFooter className="flex flex-row justify-end mt-8 gap-4">
                <SheetClose asChild>
                  <Button
                    type="button"
                    variant="outline"
                    className="w-24 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] shadow-none dark:text-white"
                  >
                    Cancel
                  </Button>
                </SheetClose>
                <Button
                  type="submit"
                  className="w-24 h-12 bg-[#D946EF] hover:bg-[#e782f7] text-white"
          disabled={isSubmitting || changePassword.isPending}
        >
          {(isSubmitting || changePassword.isPending) ? "..." : "Update"}
                </Button>
              </SheetFooter>
            </Form>
          )}
        </Formik>
      </SheetContent>
    </Sheet>
  );
}

export default ChangePasswordSheet;
</file>

<file path="src/components/single/CreateCategory-Sheet.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
/* eslint-disable @typescript-eslint/no-unused-vars */
import { useRef } from "react";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetClose,
} from "../ui/sheet";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import { useCreateCategory } from "../../backend/category.service";
import { toast } from "sonner";
import { Button } from "../ui/button";
import { Formik, Form, Field, ErrorMessage } from "formik";
import * as Yup from "yup";

interface CreateCategoryProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

interface FormValues {
  name: string;
  description?: string;
}

const validationSchema = Yup.object({
  name: Yup.string().required('Name is required').trim(),
  description: Yup.string().trim(),
});

export function CreateCategory({ open, onOpenChange }: CreateCategoryProps) {
  const formikRef = useRef<any>(null);
  const createCategory = useCreateCategory();

  const handleSubmit = async (values: FormValues, { setSubmitting, resetForm }: any) => {
    try {
      await createCategory.mutateAsync(values);
      toast.success("Category created successfully!");
      resetForm();
      onOpenChange(false);
    } catch (error) {
      toast.error("Failed to create category");
    } finally {
      setSubmitting(false);
    }
  };

  const initialValues: FormValues = {
    name: '',
    description: '',
  };

  return (
    <Sheet
      open={open}
      onOpenChange={(open) => {
        if (!open && formikRef.current) {
          formikRef.current.resetForm();
        }
        onOpenChange(open);
      }}
    >
      <SheetContent
        side="right"
        className="sm:max-w-md w-[90vw] bg-white dark:bg-[#18192b] border-l border-gray-200 dark:border-gray-800"
      >
        <SheetHeader className="pb-4 mt-8 font-boogaloo">
          <SheetTitle className="text-xl font-bold border-b">Create New Category</SheetTitle>
        </SheetHeader>

        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
          innerRef={formikRef}
        >
          {({ isSubmitting, isValid, dirty }) => (
            <Form className="flex flex-col gap-6 mt-2 font-boogaloo px-3">
              <div>
                <Label htmlFor="name" className="text-base mb-1">
                  Category Name
                </Label>
                <Field
                  as={Input}
                  id="name"
                  name="name"
                  placeholder="Name"
                  className="bg-[#F5F6FA] mt-1 text-sm font-pincuk dark:bg-[#121C2D] dark:text-white"
                />
                <ErrorMessage name="name" component="div" className="text-red-500 text-xs mt-1 font-pincuk" />
              </div>

              <div>
                <Label htmlFor="description" className="text-base mb-1 mt-4">
                  Game Description
                </Label>
                <Field
                  as="textarea"
                  id="description"
                  name="description"
                  placeholder="Description"
                  className="bg-[#F5F6FA] mt-1 text-sm rounded-md border border-input w-full min-h-[100px] p-3 resize-none font-pincuk dark:bg-[#121C2D] dark:text-white"
                />
                <ErrorMessage name="description" component="div" className="text-red-500 text-xs mt-1 font-pincuk" />
              </div>

              <div className="flex gap-4 justify-end mt-8">
                <SheetClose asChild>
                  <Button
                    type="button"
                    variant="outline"
                    className="dark:text-black dark:bg-white"
                    onClick={() => {
                      formikRef.current?.resetForm();
                    }}
                  >
                    Cancel
                  </Button>
                </SheetClose>

                <Button
                  type="submit"
                  disabled={isSubmitting || !isValid || !dirty}
                  variant="default"
                  className="bg-[#D946EF] hover:bg-accent dark:text-white"
                >
                  {isSubmitting ? "Creating..." : "Create"}
                </Button>
              </div>
            </Form>
          )}
        </Formik>
      </SheetContent>
    </Sheet>
  );
}

export default CreateCategory;
</file>

<file path="src/components/single/CreateGame-Sheet.tsx">
import { useState, useRef } from 'react';
import { Formik, Form, Field, ErrorMessage } from 'formik';
import * as Yup from 'yup';
import { Button } from '../ui/button';
import { Input } from '../ui/input';
import { Label } from '../ui/label';
import uploadImg from '../../assets/fetch-upload.svg';
import { useCreateGame } from '../../backend/games.service';
import { useCategories } from '../../backend/category.service';
import { toast } from 'sonner';
import GameCreationProgress from './GameCreationProgress';
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from '../ui/sheet';

interface FormValues {
  title: string;
  description: string;
  config: number;
  categoryId: string;
  thumbnailFile?: File;
  gameFile?: File;
}

// Validation schema
const validationSchema = Yup.object({
  title: Yup.string().required('Title is required').trim(),
  description: Yup.string().required('Description is required').trim(),
  config: Yup.number()
    .required('Config is required')
    .min(0, 'Config must be a positive number'),
  categoryId: Yup.string().required('Category is required'),
  thumbnailFile: Yup.mixed<File>()
    .required('Thumbnail image is required')
    .test('fileType', 'Only image files are allowed', (value) => {
      if (!value) return false;
      return value instanceof File && value.type.startsWith('image/');
    }),
  gameFile: Yup.mixed<File>()
    .required('Game file is required')
    .test('fileType', 'Only ZIP files are allowed', (value) => {
      if (!value) return false;
      return value instanceof File && value.name.toLowerCase().endsWith('.zip');
    }),
});

// Initial values
const initialValues: FormValues = {
  title: '',
  description: '',
  config: 0,
  categoryId: '',
};

export function CreateGameSheet({
  children,
  onOpenChange,
}: {
  children: React.ReactNode;
  onOpenChange?: (open: boolean) => void;
}) {
  const formikRef = useRef<any>(null);
  const [thumbnailPreview, setThumbnailPreview] = useState<string | null>(null);
  const [gameFileName, setGameFileName] = useState<string | null>(null);
  const [showProgress, setShowProgress] = useState(false);
  const [progress, setProgress] = useState(0);
  const [currentStep, setCurrentStep] = useState('');
  const createGame = useCreateGame();
  const { data: categories } = useCategories();
  const handleSubmit = async (
    values: FormValues,
    { setSubmitting, resetForm }: any
  ) => {
    try {
      // Show progress bar
      setShowProgress(true);
      setProgress(0);
      setCurrentStep('Preparing files...');

      const formData = new FormData();
      formData.append('title', values.title);
      formData.append('description', values.description);
      formData.append('config', String(values.config));
      formData.append('categoryId', values.categoryId);

      if (values.thumbnailFile) {
        formData.append('thumbnailFile', values.thumbnailFile);
      }
      if (values.gameFile) {
        formData.append('gameFile', values.gameFile);
      }

      // Simulate progress steps
      setProgress(20);
      setCurrentStep('Uploading thumbnail...');
      await new Promise(resolve => setTimeout(resolve, 500));

      setProgress(50);
      setCurrentStep('Uploading game file...');
      await new Promise(resolve => setTimeout(resolve, 500));

      setProgress(80);
      setCurrentStep('Processing...');

      await createGame.mutateAsync(formData);

      setProgress(100);
      setCurrentStep('Complete!');
      await new Promise(resolve => setTimeout(resolve, 1000));

      toast.success('Game created successfully!');
      resetForm();
      setThumbnailPreview(null);
      setGameFileName(null);
      setShowProgress(false);
      setProgress(0);
      setCurrentStep('');
      onOpenChange?.(false);
    } catch (error) {
      setShowProgress(false);
      setProgress(0);
      setCurrentStep('');
      toast.error('Failed to create game');
    } finally {
      setSubmitting(false);
    }
  };

  return (
    <Sheet onOpenChange={(open) => {
      if (!open && formikRef.current) {
        formikRef.current.resetForm();
        setThumbnailPreview(null);
        setGameFileName(null);
      }
      onOpenChange?.(open);
    }}>
      <SheetTrigger asChild>{children}</SheetTrigger>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621] max-w-xl w-full overflow-y-auto">
        <SheetHeader>
          <SheetTitle className="text-2xl font-bold tracking-wider mt-6 mb-2">
            Create New Game
          </SheetTitle>
          <div className="border border-b-gray-200 mb-2"></div>
        </SheetHeader>
        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
          innerRef={formikRef}
        >
          {({ setFieldValue, isSubmitting, isValid, dirty }) => (
            <Form className="grid grid-cols-1 gap-6 pl-4 pr-4">
              {/* Thumbnail Upload */}
              <div>
                <Label className="text-lg mb-2 block">Add Thumbnail icon</Label>
                <div className="flex items-center gap-4">
                  <label className="w-40 h-38 flex flex-col items-center justify-center border border-[#CBD5E0] rounded-lg cursor-pointer hover:border-[#D946EF] transition">
                    {thumbnailPreview ? (
                      <img
                        src={thumbnailPreview}
                        alt="thumbnail preview"
                        className="w-full h-full object-cover rounded-lg"
                      />
                    ) : (
                      <img
                        src={uploadImg}
                        alt="upload"
                        className="dark:text-white"
                      />
                    )}
                    <input
                      type="file"
                      accept="image/*"
                      className="hidden"
                      onChange={(e) => {
                        const file = e.target.files?.[0];
                        if (file) {
                          setFieldValue('thumbnailFile', file);
                          const reader = new FileReader();
                          reader.onloadend = () => {
                            setThumbnailPreview(reader.result as string);
                          };
                          reader.readAsDataURL(file);
                        }
                      }}
                    />
                  </label>
                </div>
                <ErrorMessage
                  name="thumbnailFile"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              {/* Title Input */}
              <div>
                <Label
                  htmlFor="title"
                  className="text-lg mb-2 block dark:text-white"
                >
                  Title
                </Label>
                <Field
                  as={Input}
                  id="title"
                  name="title"
                  className="w-full h-12 rounded-md border border-[#CBD5E0] dark:text-white bg-[#F1F5F9] dark:bg-[#121C2D] px-3 text-gray-700 focus:border-[#D946EF] focus:outline-none font-pincuk tracking-wider text-sm"
                  placeholder="Enter game title"
                />
                <ErrorMessage
                  name="title"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              {/* Description */}
              <div>
                <Label
                  htmlFor="description"
                  className="text-lg mb-2 block dark:text-white"
                >
                  Short Description
                </Label>
                <Field
                  as="textarea"
                  id="description"
                  name="description"
                  className="w-full min-h-[80px] rounded-md border border-[#CBD5E0] dark:text-white dark:bg-[#121C2D] bg-[#F1F5F9] px-3 py-2 font-pincuk text-xl tracking-wider  text-gray-700 focus:border-[#D946EF] focus:outline-none resize-none"
                  placeholder="Description"
                />
                <ErrorMessage
                  name="description"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              {/* Game Upload */}
              <div>
                <Label className="text-lg mb-2 block">Game Upload .zip</Label>
                <div className="flex items-center gap-4">
                  <label className="w-40 h-38 flex flex-col items-center justify-center border border-[#CBD5E0] rounded-lg cursor-pointer hover:border-[#D946EF] transition">
                    <img src={uploadImg} alt="upload" />
                    <input
                      type="file"
                      accept=".zip"
                      className="hidden"
                      onChange={(e) => {
                        const file = e.target.files?.[0];
                        if (file) {
                          setFieldValue('gameFile', file);
                          setGameFileName(file.name);
                        }
                      }}
                    />
                  </label>
                  {gameFileName && (
                    <span className=" font-pincuk text-xl tracking-wider text-gray-600 dark:text-gray-300">
                      {gameFileName}
                    </span>
                  )}
                </div>
                <ErrorMessage
                  name="gameFile"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              {/* Category Dropdown */}
              <div>
                <Label
                  htmlFor="categoryId"
                  className="text-lg mb-2 block dark:text-white"
                >
                  Game Category
                </Label>
                <Field
                  as="select"
                  id="categoryId"
                  name="categoryId"
                  className="w-full h-12 rounded-md border border-[#CBD5E0] dark:text-white dark:bg-[#121C2D] bg-[#F1F5F9] px-3 font-pincuk text-xl tracking-wider  text-gray-700 focus:border-[#D946EF] focus:outline-none"
                >
                  <option value="">Select category</option>
                  {categories?.map((category) => (
                    <option key={category.id} value={category.id}>
                      {category.name}
                    </option>
                  ))}
                </Field>
                <ErrorMessage
                  name="categoryId"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              {/* Config Input */}
              <div>
                <Label
                  htmlFor="config"
                  className="text-lg mb-2 block dark:text-white"
                >
                  Game Config
                </Label>
                <Field
                  as={Input}
                  type="number"
                  id="config"
                  name="config"
                  min="0"
                  className="w-full h-12 rounded-md border border-[#CBD5E0] dark:text-white dark:bg-[#121C2D] bg-[#F1F5F9] px-3 font-pincuk text-xl tracking-wider  text-gray-700 focus:border-[#D946EF] focus:outline-none"
                  placeholder="Enter config number"
                />
                <ErrorMessage
                  name="config"
                  component="div"
                  className="text-red-500  mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div className="flex gap-3 justify-end px-2 mt-4">
                <SheetClose asChild>
                  <Button
                    type="button"
                    className="w-24 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] hover:bg-accent"
                    onClick={() => {
                      formikRef.current?.resetForm();
                      setThumbnailPreview(null);
                      setGameFileName(null);
                    }}
                  >
                    Cancel
                  </Button>
                </SheetClose>
                <Button
                  type="submit"
                  disabled={isSubmitting || !isValid || !dirty}
                  className="w-24 h-12 bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
                >
                  {isSubmitting ? 'Creating...' : 'Create'}
                </Button>
              </div>
            </Form>
          )}
        </Formik>

        {/* Progress Bar */}
        {showProgress && (
          <GameCreationProgress
            progress={progress}
            currentStep={currentStep}
            isComplete={progress === 100}
          />
        )}
      </SheetContent>
    </Sheet>
  );
}
</file>

<file path="src/components/single/Edit-Sheet.tsx">
import { useState, useEffect } from 'react';
import { Formik, Form, Field, ErrorMessage } from 'formik';
import * as Yup from 'yup';
import {
  Sheet,
  SheetContent,
  SheetTitle,
  SheetFooter,
  SheetClose,
} from '../ui/sheet';
import { Input } from '../ui/input';
import { Label } from '../ui/label';
import { Button } from '../ui/button';
import { DeleteConfirmationModal } from '../modals/DeleteConfirmationModal';
import { XIcon } from 'lucide-react';
import {
  useGameById,
  useUpdateGame,
  useDeleteGame,
} from '../../backend/games.service';
import { useCategories } from '../../backend/category.service';
import { toast } from 'sonner';
import uploadImg from '../../assets/fetch-upload.svg';
import GameCreationProgress from './GameCreationProgress';
// import type { GameResponse } from "../../backend/types";

interface EditSheetProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  gameId: string;
}

interface FormValues {
  title: string;
  description: string;
  config: number;
  categoryId: string;
  thumbnailFile?: File;
  gameFile?: File;
}

const validationSchema = Yup.object({
  title: Yup.string().required('Title is required'),
  description: Yup.string(),
  config: Yup.number()
    .required('Config is required')
    .min(0, 'Config must be a positive number'),
  categoryId: Yup.string().required('Category is required'),
  thumbnailFile: Yup.mixed<File>(),
  gameFile: Yup.mixed<File>(),
});

export function EditSheet({ open, onOpenChange, gameId }: EditSheetProps) {
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [thumbnailPreview, setThumbnailPreview] = useState<string | null>(null);
  const [isImageLoading, setIsImageLoading] = useState(false);
  const [gameFileName, setGameFileName] = useState<string | null>(null);
  const [showProgress, setShowProgress] = useState(false);
  const [progress, setProgress] = useState(0);
  const [currentStep, setCurrentStep] = useState('');

  const { data: game, error } = useGameById(gameId);

  console.log('games by id', gameFileName);

  // Close sheet if game is not found
  useEffect(() => {
    const axiosError = error as { response?: { status: number } };
    if (axiosError?.response?.status === 404) {
      onOpenChange(false);
    }
  }, [error, onOpenChange]);
  const { data: categories } = useCategories();

  // Set initial thumbnail and file name when game data loads
  useEffect(() => {
    if (game) {
      // Reset states when game changes
      setThumbnailPreview(null);
      setGameFileName(null);

      // Set thumbnail preview if available
      if (game.thumbnailFile?.s3Key) {
        setIsImageLoading(true);
        setThumbnailPreview(game.thumbnailFile.s3Key);
      }

      // Set game file name if available
      if (game.gameFile?.name) {
        setGameFileName(game.gameFile.name);
      }
    }
  }, [game?.id]); // Only run when game ID changes to prevent unnecessary updates
  const updateGame = useUpdateGame();
  const deleteGame = useDeleteGame();

  const handleSubmit = async (values: FormValues, { setSubmitting }: any) => {
    try {
      // Show progress bar
      setShowProgress(true);
      setProgress(0);
      setCurrentStep('Preparing update...');

      const formData = new FormData();
      formData.append('title', values.title);
      formData.append('description', values.description);
      formData.append('config', String(values.config));
      formData.append('categoryId', values.categoryId);

      if (values.thumbnailFile) {
        formData.append('thumbnailFile', values.thumbnailFile);
      }
      if (values.gameFile) {
        formData.append('gameFile', values.gameFile);
      }

      // Simulate progress steps
      setProgress(20);
      setCurrentStep('Updating thumbnail...');
      await new Promise(resolve => setTimeout(resolve, 500));

      setProgress(50);
      setCurrentStep('Updating game file...');
      await new Promise(resolve => setTimeout(resolve, 500));

      setProgress(80);
      setCurrentStep('Processing update...');

      await updateGame.mutateAsync({ id: gameId, data: formData });

      setProgress(100);
      setCurrentStep('Update complete!');
      await new Promise(resolve => setTimeout(resolve, 1000));

      toast.success('Game updated successfully!');
      setShowProgress(false);
      setProgress(0);
      setCurrentStep('');
      onOpenChange(false);
    } catch (error) {
      setShowProgress(false);
      setProgress(0);
      setCurrentStep('');
      toast.error('Failed to update game');
    } finally {
      setSubmitting(false);
    }
  };

  const handleDelete = async () => {
    try {
      await deleteGame.mutateAsync(gameId);
      toast.success('Game deleted successfully');
      setShowDeleteModal(false);
      onOpenChange(false);
    } catch (error) {
      toast.error('Failed to delete game');
    }
  };

  if (!game) return null;

  const initialValues: FormValues = {
    title: game.title,
    description: game.description || '',
    config: game.config,
    categoryId: game.categoryId || '',
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetContent
        side="right"
        className="max-w-md w-full overflow-y-auto p-6 font-boogaloo dark:bg-[#0F1621]"
      >
        <div className="mb-4">
          <SheetTitle className="text-lg mt-8 tracking-wider border-b">
            Edit Game
          </SheetTitle>
        </div>
        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
        >
          {({ setFieldValue, isSubmitting }) => (
            <Form className="space-y-4">
              <div>
                <Label className="">Update Thumbnail icon</Label>
                <div className="mt-2 relative w-36 h-36">
                  {thumbnailPreview ? (
                    <label className="relative w-36 h-36 cursor-pointer group">
                      <img
                        src={thumbnailPreview}
                        alt="Thumbnail"
                        className={`w-36 h-36 rounded-lg object-cover transition-opacity duration-200 group-hover:opacity-75 ${
                          isImageLoading ? 'opacity-0' : 'opacity-100'
                        }`}
                        onLoad={() => setIsImageLoading(false)}
                        onError={(e) => {
                          // If image fails to load, clear the preview
                          setThumbnailPreview(null);
                          e.currentTarget.onerror = null; // Prevent infinite loop
                        }}
                      />
                      {/* Overlay on hover */}
                      <div className="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-lg flex items-center justify-center">
                        <span className="text-white text-sm font-medium">Click to change</span>
                      </div>
                      <input
                        type="file"
                        accept="image/*"
                        className="hidden"
                        onChange={(e) => {
                          const file = e.target.files?.[0];
                          if (file) {
                            setFieldValue('thumbnailFile', file);
                            const reader = new FileReader();
                            reader.onloadend = () => {
                              setThumbnailPreview(reader.result as string);
                            };
                            reader.readAsDataURL(file);
                          }
                        }}
                      />
                      <button
                        type="button"
                        onClick={(e) => {
                          e.preventDefault();
                          e.stopPropagation();
                          setThumbnailPreview(null);
                          setFieldValue('thumbnailFile', undefined);
                        }}
                        className="absolute top-2 right-2 bg-[#C026D3] text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-[#a21caf] transition-colors"
                        title="Remove thumbnail"
                      >
                        <XIcon className="w-4 h-4" />
                      </button>
                    </label>
                  ) : isImageLoading ? (
                    <div className="w-36 h-36 rounded-lg bg-[#F1F5F9] dark:bg-[#121C2D] animate-pulse flex items-center justify-center">
                      <div className="w-8 h-8 border-4 border-[#D946EF] border-t-transparent rounded-full animate-spin"></div>
                    </div>
                  ) : (
                    <label className="w-36 h-36 flex flex-col items-center justify-center border border-[#e5e7eb] rounded-lg cursor-pointer hover:bg-[#f3e8ff] transition">
                      <span className="flex items-center justify-center">
                        <img src={uploadImg} alt="upload" />
                      </span>
                      <input
                        type="file"
                        accept="image/*"
                        className="hidden"
                        onChange={(e) => {
                          const file = e.target.files?.[0];
                          if (file) {
                            setFieldValue('thumbnailFile', file);
                            const reader = new FileReader();
                            reader.onloadend = () => {
                              setThumbnailPreview(reader.result as string);
                            };
                            reader.readAsDataURL(file);
                          }
                        }}
                      />
                    </label>
                  )}
                </div>
                <ErrorMessage
                  name="thumbnailFile"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div className="mt-8">
                <Label htmlFor="title" className="">
                  Title
                </Label>
                <Field
                  as={Input}
                  id="title"
                  name="title"
                  className="mt-1 font-pincuk text-xl tracking-wider bg-[#F1F5F9] shadow-none dark:bg-[#121C2D]"
                />
                <ErrorMessage
                  name="title"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div className="mt-8">
                <Label htmlFor="description" className="">
                  Short Description
                </Label>
                <Field
                  as="textarea"
                  id="description"
                  name="description"
                  className="w-full mt-1 rounded-md border bg-transparent p-2 font-pincuk text-xl tracking-wider dark:text-white dark:bg-[#121C2D]"
                  rows={3}
                />
                <ErrorMessage
                  name="description"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div className="mt-8">
                <Label className="text-lg mb-2 block">Game Upload .zip</Label>
                <div className="mt-2 relative w-36 h-36">
                  {(gameFileName || game.gameFile) ? (
                    <label className="relative w-36 h-36 cursor-pointer group">
                      {/* Show game thumbnail as visual representation */}
                      <img
                        src={thumbnailPreview || game.thumbnailFile?.s3Key || uploadImg}
                        alt="Game File"
                        className="w-36 h-36 rounded-lg object-cover transition-opacity duration-200 group-hover:opacity-75"
                        onError={(e) => {
                          // If thumbnail fails to load, show upload icon
                          e.currentTarget.src = uploadImg;
                        }}
                      />
                      {/* Overlay on hover */}
                      <div className="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-lg flex items-center justify-center">
                        <span className="text-white text-sm font-medium">Click to change</span>
                      </div>
                      {/* ZIP badge overlay */}
                      <div className="absolute top-2 left-2 bg-[#D946EF] text-white rounded px-2 py-1 text-xs font-bold">
                        ZIP
                      </div>
                      <input
                        type="file"
                        accept=".zip"
                        className="hidden"
                        onChange={(e) => {
                          const file = e.target.files?.[0];
                          if (file) {
                            setFieldValue('gameFile', file);
                            setGameFileName(file.name);
                          }
                        }}
                      />
                      <button
                        type="button"
                        onClick={(e) => {
                          e.preventDefault();
                          e.stopPropagation();
                          setGameFileName(null);
                          setFieldValue('gameFile', undefined);
                        }}
                        className="absolute top-2 right-2 bg-[#C026D3] text-white rounded-full w-6 h-6 flex items-center justify-center shadow hover:bg-[#a21caf] transition-colors"
                        title="Remove game file"
                      >
                        <XIcon className="w-4 h-4" />
                      </button>
                    </label>
                  ) : (
                    <label className="w-36 h-36 flex flex-col items-center justify-center border border-[#e5e7eb] rounded-lg cursor-pointer hover:bg-[#f3e8ff] transition">
                      <span className="flex items-center justify-center">
                        <img src={uploadImg} alt="upload" />
                      </span>
                      <input
                        type="file"
                        accept=".zip"
                        className="hidden"
                        onChange={(e) => {
                          const file = e.target.files?.[0];
                          if (file) {
                            setFieldValue('gameFile', file);
                            setGameFileName(file.name);
                          }
                        }}
                      />
                    </label>
                  )}
                </div>
                {/* Show game title as file name */}
                {(gameFileName || game.gameFile) && (
                  <div className="mt-2 text-sm font-pincuk tracking-wider text-gray-600 dark:text-gray-300">
                     {gameFileName || `${game.title}.zip`}
                  </div>
                )}
                <ErrorMessage
                  name="gameFile"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div className="mt-8">
                <Label htmlFor="categoryId" className="">
                  Game Category
                </Label>
                <div className="relative">
                  <Field
                    as="select"
                    id="categoryId"
                    name="categoryId"
                    className="mt-1 w-full rounded-lg dark:bg-[#121C2D] dark:text-white bg-[#F1F5F9] text-[#64748b] px-4 py-3 font-pincuk text-xl tracking-wider outline-none border-none appearance-none pr-10"
                  >
                    <option value="">Select category</option>
                    {categories?.map((category) => (
                      <option key={category.id} value={category.id}>
                        {category.name}
                      </option>
                    ))}
                  </Field>
                  <span className="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-[#64748b]">
                    <svg width="20" height="20" fill="none" viewBox="0 0 20 20">
                      <path
                        d="M6 8l4 4 4-4"
                        stroke="currentColor"
                        strokeWidth="2"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </span>
                </div>
                <ErrorMessage
                  name="categoryId"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <div>
                <Label htmlFor="config" className="mt-8">
                  Game Config
                </Label>
                <Field
                  as={Input}
                  type="number"
                  id="config"
                  name="config"
                  min="0"
                  className="mt-1 bg-[#F1F5F9] shadow-none border-none dark:bg-[#121C2D]"
                />
                <ErrorMessage
                  name="config"
                  component="div"
                  className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                />
              </div>

              <SheetFooter className="flex flex-row justify-between mt-6">
                <Button
                  type="button"
                  variant="destructive"
                  onClick={() => setShowDeleteModal(true)}
                  className="dark:bg-[#EF4444]"
                >
                  Delete
                </Button>
                <div className="flex gap-2">
                  <SheetClose asChild>
                    <Button
                      type="button"
                      variant="outline"
                      className="dark:text-black dark:bg-white"
                    >
                      Cancel
                    </Button>
                  </SheetClose>
                  <Button
                    type="submit"
                    disabled={isSubmitting}
                    variant="default"
                    className="bg-[#D946EF] hover:bg-accent dark:text-white"
                  >
                    {isSubmitting ? 'Updating...' : 'Update'}
                  </Button>
                </div>
              </SheetFooter>
            </Form>
          )}
        </Formik>

        {/* Progress Bar */}
        {showProgress && (
          <GameCreationProgress
            progress={progress}
            currentStep={currentStep}
            isComplete={progress === 100}
          />
        )}
      </SheetContent>
      {/* Delete Confirmation Modal */}
      <DeleteConfirmationModal
        open={showDeleteModal}
        onOpenChange={setShowDeleteModal}
        onConfirm={handleDelete}
        isDeleting={deleteGame.isPending}
      />
    </Sheet>
  );
}
</file>

<file path="src/components/single/EditCategory-Sheet.tsx">
import { useState, useEffect } from "react";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetClose,
} from "../ui/sheet";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import { Button } from "../ui/button";
import { useCategoryById, useUpdateCategory, useDeleteCategory } from "../../backend/category.service";
import { toast } from "sonner";
import { Formik, Form, Field, ErrorMessage } from "formik";
import * as Yup from "yup";
import { DeleteConfirmationModal } from "../modals/DeleteConfirmationModal";
import { useQueryClient } from "@tanstack/react-query";
import { BackendRoute } from "../../backend/constants";

interface EditCategoryProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  categoryId: string;
}

interface FormValues {
  name: string;
  description?: string;
}

const validationSchema = Yup.object({
  name: Yup.string().required('Name is required'),
  description: Yup.string(),
});

export function EditCategory({ open, onOpenChange, categoryId }: EditCategoryProps) {
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const { data: category, error } = useCategoryById(categoryId);
  const updateCategory = useUpdateCategory();
  const deleteCategory = useDeleteCategory();
  const queryClient = useQueryClient();

  // Close sheet if category is not found
  useEffect(() => {
    const axiosError = error as { response?: { status: number } };
    if (axiosError?.response?.status === 404) {
      onOpenChange(false);
    }
  }, [error, onOpenChange]);

  const handleSubmit = async (values: FormValues, { setSubmitting }: any) => {
    try {
      await updateCategory.mutateAsync({
        id: categoryId,
        data: values
      });
      toast.success("Category updated successfully!");
      onOpenChange(false);
    } catch (error) {
      toast.error("Failed to update category");
    } finally {
      setSubmitting(false);
    }
  };

  const handleDelete = async () => {
    try {
      await deleteCategory.mutateAsync(categoryId);
      queryClient.invalidateQueries({ queryKey: [BackendRoute.CATEGORIES] });
      toast.success("Category deleted successfully");
      setShowDeleteModal(false);
      onOpenChange(false);
    } catch (error: any) {
      toast.error("Failed to delete category");
    }
  };

  if (!category) return null;

  const initialValues: FormValues = {
    name: category.name,
    description: category.description || '',
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetContent
        side="right"
        className="sm:max-w-md w-[90vw] bg-white dark:bg-[#18192b] border-l border-gray-200 dark:border-gray-800"
      >
        <SheetHeader className="pb-4 mt-8 font-boogaloo">
          <SheetTitle className="text-xl font-bold border-b">Edit Category</SheetTitle>
        </SheetHeader>

        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
        >
          {({ isSubmitting }) => (
            <Form className="flex flex-col gap-6 mt-2 font-boogaloo px-3">
              <div>
                <Label htmlFor="name" className="text-base mb-1">
                  Category Name
                </Label>
                <Field
                  as={Input}
                  id="name"
                  name="name"
                  placeholder="Name"
                  className="bg-[#F5F6FA] mt-1  font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white"
                />
                <ErrorMessage name="name" component="div" className="text-red-500  mt-1 font-pincuk text-xl tracking-wider" />
              </div>

              <div>
                <Label htmlFor="description" className="text-base mb-1 mt-4">
                  Game Description
                </Label>
                <Field
                  as="textarea"
                  id="description"
                  name="description"
                  placeholder="Description"
                  className="bg-[#F5F6FA] mt-1  rounded-md border border-input w-full min-h-[100px] p-3 resize-none font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white"
                />
                <ErrorMessage name="description" component="div" className="text-red-500  mt-1 font-pincuk text-xl tracking-wider" />
              </div>

              <div className="flex justify-between mt-8 items-center">
                <Button
                  type="button"
                  variant="destructive"
                  onClick={() => setShowDeleteModal(true)}
                  className="dark:bg-[#EF4444]"
                >
                  Delete
                </Button>
                <div className="flex gap-3">
                  <SheetClose asChild>
                    <Button
                      type="button"
                      variant="outline"
                      className="dark:text-black dark:bg-white"
                    >
                      Cancel
                    </Button>
                  </SheetClose>

                  <Button
                    type="submit"
                    disabled={isSubmitting}
                    variant="default"
                    className="bg-[#D946EF] hover:bg-accent dark:text-white"
                  >
                    {isSubmitting ? "Updating..." : "Update"}
                  </Button>
                </div>
              </div>
            </Form>
          )}
        </Formik>

        <DeleteConfirmationModal
          open={showDeleteModal}
          onOpenChange={setShowDeleteModal}
          onConfirm={handleDelete}
          isDeleting={deleteCategory.isPending}
          title="Are you sure you want to Delete Category?"
          description="This action cannot be reversed"
        />
      </SheetContent>
    </Sheet>
  );
}

export default EditCategory;
</file>

<file path="src/components/single/EditProfile-Sheet.tsx">
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetFooter,
  SheetClose,
} from "../ui/sheet";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import { Button } from "../ui/button";
import { useUpdateUserData } from "../../backend/user.service";
import { toast } from "sonner";
import { useAuth } from "../../context/AuthContext";
import { Formik, Form, Field, ErrorMessage } from "formik";
import * as Yup from "yup";

interface EditProfileSheetProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  profile: {
    firstName: string;
    lastName: string;
    email: string;
    phone: string;
  };
}

const validationSchema = Yup.object().shape({
  firstName: Yup.string()
    .required("First name is required")
    .min(2, "First name must be at least 2 characters")
    .max(50, "First name must be less than 50 characters"),
  lastName: Yup.string()
    .required("Last name is required")
    .min(2, "Last name must be at least 2 characters")
    .max(50, "Last name must be less than 50 characters"),
  email: Yup.string()
    .email("Invalid email address")
    .required("Email is required"),
  phone: Yup.string()
    .nullable()
    .matches(/^[+]?[(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{4,6}$/, "Invalid phone number format")
});

export function EditProfileSheet({ open, onOpenChange, profile }: EditProfileSheetProps) {
  const updateUser = useUpdateUserData();
  const { user } = useAuth();

  const initialValues = {
    firstName: profile.firstName,
    lastName: profile.lastName,
    email: profile.email,
    phone: profile.phone
  };

  const handleSubmit = async (values: typeof initialValues) => {
    try {
      if (!user?.id) {
        toast.error("User ID not found");
        return;
      }

      await updateUser.mutateAsync({
        id: user.id,
        firstName: values.firstName.trim(),
        lastName: values.lastName.trim(),
        email: values.email,
        phoneNumber: values.phone || undefined
      });

      toast.success("Profile updated successfully");
      onOpenChange(false);
    } catch (error) {
      toast.error("Failed to update profile");
    }
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetContent side="right" className="max-w-md w-full p-6 font-boogaloo dark:bg-[#0F1621]">
        <SheetHeader>
          <SheetTitle className="text-lg mt-4 tracking-wider">Edit Profile</SheetTitle>
        </SheetHeader>
        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={handleSubmit}
        >
          {({ errors, touched }) => (
            <Form className="flex flex-col gap-6 mt-4 px-2">
              <div>
                <Label htmlFor="firstName" className="text-base mb-1">
                  First Name
                </Label>
                <Field
                  as={Input}
                  id="firstName"
                  name="firstName"
                  placeholder="Enter first name"
                  className={`bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white ${
                    errors.firstName && touched.firstName ? "border-red-500" : ""
                  }`}
                />
                <ErrorMessage
                  name="firstName"
                  component="div"
                  className="text-red-500 text-sm mt-1"
                />
              </div>
              <div>
                <Label htmlFor="lastName" className="text-base mb-1">
                  Last Name
                </Label>
                <Field
                  as={Input}
                  id="lastName"
                  name="lastName"
                  placeholder="Enter last name"
                  className={`bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white ${
                    errors.lastName && touched.lastName ? "border-red-500" : ""
                  }`}
                />
                <ErrorMessage
                  name="lastName"
                  component="div"
                  className="text-red-500 text-sm mt-1"
                />
              </div>
              <div>
                <Label htmlFor="email" className="text-base mb-1">
                  Email
                </Label>
                <Field
                  as={Input}
                  id="email"
                  name="email"
                  type="email"
                  placeholder="Enter email"
                  className={`bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white ${
                    errors.email && touched.email ? "border-red-500" : ""
                  }`}
                />
                <ErrorMessage
                  name="email"
                  component="div"
                  className="text-red-500 text-sm mt-1"
                />
              </div>
              <div>
                <Label htmlFor="phone" className="text-base mb-1">
                  Phone Number
                </Label>
                <Field
                  as={Input}
                  id="phone"
                  name="phone"
                  placeholder="Enter phone number"
                  className={`bg-[#F1F5F9] mt-1 font-pincuk text-xl tracking-wider dark:bg-[#121C2D] dark:text-white ${
                    errors.phone && touched.phone ? "border-red-500" : ""
                  }`}
                />
                <ErrorMessage
                  name="phone"
                  component="div"
                  className="text-red-500 text-sm mt-1"
                />
              </div>
              <SheetFooter className="flex flex-row justify-end mt-8 gap-4">
                <SheetClose asChild>
                  <Button variant="outline" className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] dark:text-white">
                    Cancel
                  </Button>
                </SheetClose>
                <Button
                  type="submit"
                  className="w-20 h-12 bg-[#D946EF] text-white tracking-wide"
                  disabled={updateUser.isPending}
                >
                  {updateUser.isPending ? "..." : "Update"}
                </Button>
              </SheetFooter>
            </Form>
          )}
        </Formik>
      </SheetContent>
    </Sheet>
  );
}

export default EditProfileSheet;
</file>

<file path="src/components/single/Filter-Sheet.tsx">
import { useState } from "react";
import { Button } from "../ui/button"
import { Label } from "../ui/label"
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "../ui/sheet"
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "../ui/select"
import { useCategories } from "../../backend/category.service"
import type { GameStatus } from "../../backend/types"

interface FilterSheetProps {
  children: React.ReactNode;
  onFilter: (filters: { categoryId?: string; status?: GameStatus }) => void;
  onReset: () => void;
}

export function FilterSheet({ children, onFilter, onReset }: FilterSheetProps) {
  const { data: categories } = useCategories();
  const [selectedCategory, setSelectedCategory] = useState<string>("all");
  const [selectedStatus, setSelectedStatus] = useState<string>("all");
  return (
    <Sheet>
      <SheetTrigger asChild>
        {children}
      </SheetTrigger>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621]">
        <SheetHeader>
          <SheetTitle className="text-xl font-normal tracking-wider mt-6">Filter</SheetTitle>
         <div className="border border-b-gray-200"></div>
        </SheetHeader>
        <form
          className="grid gap-4 p-4"
          onSubmit={(e) => {
            e.preventDefault();
            onFilter({
              categoryId: selectedCategory === "all" ? undefined : selectedCategory,
              status: selectedStatus === "all" ? undefined : selectedStatus as GameStatus
            });
          }}
        >
          {/* category */}
          <div className="items-center gap-4">
            <div className="flex flex-col space-y-2">
              <Label htmlFor="category" className="text-right text-lg">
                Select Category
              </Label>
              <Select value={selectedCategory} onValueChange={setSelectedCategory}>
                <SelectTrigger className="h-14 bg-[#F1F5F9] border border-[#CBD5E0] font-pincuk text-xl tracking-wider w-full">
                  <SelectValue placeholder="Select category" />
                </SelectTrigger>
                <SelectContent className="dark:bg-[#121C2D]">
                  <SelectItem value="all">All Categories</SelectItem>
                  {categories?.map((category) => (
                    <SelectItem key={category.id} value={category.id}>
                      {category.name}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          </div>
          {/* status */}
          <div className="items-center gap-4">
            <div className="flex flex-col space-y-2">
              <Label htmlFor="status" className="text-right text-lg">
                Select Game Status
              </Label>
              <Select value={selectedStatus} onValueChange={setSelectedStatus}>
                <SelectTrigger className="h-14 bg-[#F1F5F9] border border-[#CBD5E0] font-pincuk text-xl tracking-wider w-full">
                  <SelectValue placeholder="Select status" />
                </SelectTrigger>
                <SelectContent className="dark:bg-[#121C2D]">
                  <SelectItem value="all">All Status</SelectItem>
                  <SelectItem value="active">Active</SelectItem>
                  <SelectItem value="disabled">Disabled</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>
          <div className="flex gap-3 justify-end px-2">
            <SheetClose asChild>
              <Button
                type="button"
                onClick={() => {
                  setSelectedCategory("all");
                  setSelectedStatus("all");
                  onReset();
                }}
                className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] hover:bg-accent"
              >
                Reset
              </Button>
            </SheetClose>
            <SheetClose asChild>
              <Button
                type="submit"
                className="w-20 h-12 bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
              >
                Filter
              </Button>
            </SheetClose>
          </div>
        </form>
      </SheetContent>
    </Sheet>
  )
}
</file>

<file path="src/components/single/GameCreationProgress.tsx">
import { useEffect, useState } from 'react';

interface GameCreationProgressProps {
  progress: number;
  currentStep: string;
  isComplete?: boolean;
}

const GameCreationProgress = ({
  progress,
  currentStep,
  isComplete = false
}: GameCreationProgressProps) => {
  const [displayProgress, setDisplayProgress] = useState(0);

  // Smooth progress animation
  useEffect(() => {
    const timer = setTimeout(() => {
      setDisplayProgress(progress);
    }, 100);
    return () => clearTimeout(timer);
  }, [progress]);

  return (
    <>
      {/* Backdrop overlay to prevent interactions */}
      <div className="fixed inset-0 bg-black/20 backdrop-blur-sm z-40" />

      {/* Progress bar */}
      <div className="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-96">
        <div className="bg-gray-700/95 backdrop-blur-sm rounded-lg px-4 py-3 shadow-lg border border-gray-600/50">
          <div className="flex items-center justify-between text-white">
            {/* Progress percentage */}
            <div className="text-[#D946EF] font-bold text-lg">
              {Math.round(displayProgress)}%
            </div>

            {/* Current step */}
            <div className="text-white text-sm font-medium flex-1 mx-4">
              {currentStep}
            </div>

            {/* Time indicator (placeholder) */}
            <div className="text-gray-400 text-sm">
              {isComplete ? 'Done!' : '10s left'}
            </div>
          </div>

          {/* Progress bar */}
          <div className="mt-2 w-full bg-gray-600 rounded-full h-1">
            <div
              className="bg-gradient-to-r from-[#D946EF] to-[#c026d3] h-1 rounded-full transition-all duration-500 ease-out"
              style={{ width: `${displayProgress}%` }}
            ></div>
          </div>
        </div>
      </div>
    </>
  );
};

export default GameCreationProgress;
</file>

<file path="src/components/single/GameLoadingScreen.tsx">
import { ImSpinner8 } from "react-icons/im";
import { useEffect, useState } from "react";

interface GameLoadingScreenProps {
    game: {
        title: string;
        thumbnailFile?: {
            s3key: string;
        };
        gameFile?: {
            s3Key: string;
        };
    };
    progress: number;
    onProgress: (progress: number) => void;
}

const GameLoadingScreen = ({ game, progress, onProgress }: GameLoadingScreenProps) => {
    const [showSlowLoadMessage, setShowSlowLoadMessage] = useState(false);

    useEffect(() => {
        let progressInterval: NodeJS.Timeout;
        let slowLoadTimeout: NodeJS.Timeout;

        // Fast progress simulation
        if (progress < 100) {
            progressInterval = setInterval(() => {
                const increment = 5; // Smaller increment for slower progress
                const nextProgress = progress + increment;

                if (nextProgress < 100) {
                    onProgress(nextProgress);
                } else {
                    clearInterval(progressInterval);
                }
            }, 250);
        }

        // Show slow load message after 10 seconds
        slowLoadTimeout = setTimeout(() => {
            setShowSlowLoadMessage(true);
        }, 3000);

        return () => {
            if (progressInterval) clearInterval(progressInterval);
            if (slowLoadTimeout) clearTimeout(slowLoadTimeout);
        };
    }, [progress, onProgress]);

    return (
        <div
            className="absolute inset-0 flex flex-col items-center justify-center overflow-hidden rounded-2xl"
            style={{
                backgroundImage: game.thumbnailFile?.s3key? `url(${game.thumbnailFile.s3key})` : 'none',
                backgroundSize: 'cover',
                backgroundPosition: 'center'
            }}
        >
            <div className="absolute inset-0 bg-black/70 backdrop-blur-sm" />
            <div className="relative z-10 flex flex-col items-center">
                <ImSpinner8 className="w-16 h-16 text-[#D946EF] animate-spin" />
                <h2 className="mt-4 text-2xl font-boogaloo text-white">{game.title}</h2>
                <p className="mt-2 text-[#D946EF]">Getting your game ready...</p>

                {/* Progress Bar */}
                <div className="w-64 h-2 mt-4 bg-gray-700 rounded-full overflow-hidden">
                    <div
                        className="h-full bg-[#D946EF] transition-all duration-300 ease-out"
                        style={{ width: `${Math.min(progress, 100)}%` }}
                    />
                </div>
                <p className="mt-2 text-white text-sm">{Math.round(progress)}%</p>

                {/* Slow Load Message */}
                {showSlowLoadMessage && (
                    <div className="mt-4 text-gray-400 text-sm text-center max-w-md">
                        <p>This game is taking longer than usual to load.</p>
                        <p>Please be patient or try refreshing the page.</p>
                    </div>
                )}
            </div>
        </div>
    );
};

export default GameLoadingScreen;
</file>

<file path="src/components/single/GamesSkeleton.tsx">
import { Card } from "../ui/card";

interface GamesSkeletonProps {
    count?: number;
    showCategories?: boolean;
}

const GamesSkeleton = ({ count = 4, showCategories = false }: GamesSkeletonProps) => {
    return (
        <div className="w-full">
            {/* Title Skeleton */}
            <div className="mb-4">
                <div className="h-8 w-48 bg-gradient-to-r from-[#0f1221] via-[#D946EF]/10 to-[#0f1221] animate-shimmer rounded-lg"></div>
            </div>

            {/* Categories Skeleton */}
            {showCategories && (
                <div className="flex gap-3 mb-8 flex-wrap">
                    {[...Array(7)].map((_, i) => (
                        <div
                            key={i}
                            className="h-10 w-24 bg-gradient-to-r from-[#0f1221] via-[#D946EF]/10 to-[#0f1221] animate-shimmer rounded-lg"
                        ></div>
                    ))}
                </div>
            )}

            {/* Games Grid Skeleton */}
            <Card className="border-hidden shadow-none p-0 dark:bg-[#0f1221]">
                <div className={`grid ${count > 4 ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3' : 'grid-cols-[repeat(auto-fit,minmax(268.8px,1fr))]'} gap-4`}>
                    {[...Array(count)].map((_, i) => (
                        <div key={i} className="relative p-[10px] group">
                            <div className="relative h-[290px] rounded-[32px] overflow-hidden">
                                <div className="absolute inset-0 bg-gradient-to-r from-[#0f1221] via-[#D946EF]/10 to-[#0f1221] animate-shimmer"></div>
                            </div>
                        </div>
                    ))}
                </div>
            </Card>
        </div>
    );
};

export default GamesSkeleton;
</file>

<file path="src/components/single/Invite-Sheet.tsx">
import { Button } from "../ui/button";
import { Input } from "../ui/input";
import { Label } from "../ui/label";
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "../ui/sheet";
import React from "react";
import { Formik, Form, Field, ErrorMessage } from "formik";
import { useInviteTeamMember } from "../../backend/teams.service";
import { toast } from "sonner";
import * as Yup from "yup";
import type { InviteUserRequest } from "../../backend/teams.service";

const inviteSchema = Yup.object().shape({
  email: Yup.string()
    .email("Invalid email format")
    .required("Email is required"),
  role: Yup.string()
    .oneOf(["admin"], "Invalid role")
    .required("Role is required"),
});

const initialValues: InviteUserRequest = {
  email: "",
  role: "admin",
};

export function InviteSheet({ children }: { children: React.ReactNode }) {
  const formikRef = React.useRef<any>(null);
  const { mutate: inviteTeamMember, isPending } = useInviteTeamMember();
  const [open, setOpen] = React.useState(false);

  const handleInvite = async (
    values: InviteUserRequest,
    { resetForm }: any
  ) => {
    inviteTeamMember(values, {
      onSuccess: () => {
        toast.success("Invitation sent successfully");
        resetForm();
        setOpen(false);
      },
      onError: (error: any) => {
        console.log("my error", error)
        const message =
          error?.response?.data?.message ||
          error?.message ||
          "Failed to send invitation";

        toast.error(message);
      },
    });
  };

  return (
    <Sheet
      open={open}
      onOpenChange={(newOpen) => {
        if (!newOpen && formikRef.current) {
          formikRef.current.resetForm();
        }
        setOpen(newOpen);
      }}
    >
      <SheetTrigger asChild>{children}</SheetTrigger>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621] max-w-md w-full">
        <SheetHeader>
          <SheetTitle className="text-xl font-normal tracking-wider mt-6">
            Share Admin Invite
          </SheetTitle>
          <div className="border border-b-gray-200"></div>
        </SheetHeader>
        <Formik
          initialValues={initialValues}
          validationSchema={inviteSchema}
          onSubmit={handleInvite}
          innerRef={formikRef}
        >
          {({ isSubmitting, isValid, dirty }) => (
            <Form className="grid gap-6 px-4">
              <div className="flex flex-col space-y-2">
                <Label htmlFor="email" className="text-lg">
                  User Email
                </Label>
                <Field
                  as={Input}
                  id="email"
                  name="email"
                  type="email"
                  placeholder="Enter email"
                  className="col-span-3 shadow-none text-gray-400 font-thin text-xl tracking-wider h-14 bg-[#F1F5F9] border border-[#CBD5E0] dark:bg-[#121C2D] dark:text-white"
                />
                <ErrorMessage
                  name="email"
                  component="div"
                  className="text-red-500 text-xs mt-1"
                />
              </div>
              <div className="flex flex-col space-y-2">
                <Label htmlFor="role" className="text-lg">
                  Role
                </Label>
                <Field
                  as="select"
                  id="role"
                  name="role"
                  className="col-span-3 shadow-none text-gray-400 font-thin font-pincuk text-xl tracking-wider h-14 bg-[#F1F5F9] border border-[#CBD5E0] rounded-lg dark:bg-[#121C2D] dark:text-white p-2"
                >
                  <option value="admin">Admin</option>
                </Field>
                <ErrorMessage
                  name="role"
                  component="div"
                  className="text-red-500 text-xs mt-1"
                />
              </div>
              <div className="flex gap-3 justify-end px-2">
                <SheetClose asChild>
                  <Button
                    type="button"
                    className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] hover:bg-accent"
                    onClick={() => formikRef.current?.resetForm()}
                  >
                    Cancel
                  </Button>
                </SheetClose>
                <Button
                  type="submit"
                  className="w-22 h-12 bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
                  disabled={isSubmitting || isPending || !isValid || !dirty}
                >
                  {isSubmitting || isPending ? "Sending..." : "Send Invite"}
                </Button>
              </div>
            </Form>
          )}
        </Formik>
      </SheetContent>
    </Sheet>
  );
}
</file>

<file path="src/components/single/Navbar.tsx">
import React, { useState, useEffect, useRef } from 'react';
import { Link, useNavigate } from 'react-router-dom';
import { Button } from '../../components/ui/button';
import { RiMenu3Line, RiCloseLine } from 'react-icons/ri';
import { StatsModal } from '../modals/StatsModal';
import { ProfileModal } from '../modals/ProfileModal';
import { useAuth } from '../../context/AuthContext';
import { useTrackSignupClick } from '../../backend/signup.analytics.service';
import { getVisitorSessionId } from '../../utils/sessionUtils';

import sun from '../../assets/sun.svg';
import moon from '../../assets/moon.svg';
import bolt from '../../assets/bolt.svg';
import profileImg from '../../assets/profile.svg'

import { SignUpModal } from '../modals/SignUpModal';
import { LoginModal } from '../modals/LoginModal';


const Navbar: React.FC = () => {
  const { isAuthenticated, isAdmin, logout } = useAuth();
  const { mutate: trackSignup } = useTrackSignupClick();
  const [isDarkMode, setIsDarkMode] = useState(() => {
    const savedMode = localStorage.getItem('darkMode');
    return savedMode ? JSON.parse(savedMode) : false;
  });

  const navigate = useNavigate();
  const [isSignUpModalOpen, setIsSignUpModalOpen] = useState(false);
  const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);
  const [isStatsModalOpen, setIsStatsModalOpen] = useState(false);
  const [isProfileModalOpen, setIsProfileModalOpen] = useState(false);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
  const mobileMenuRef = useRef<HTMLDivElement>(null);
  const menuButtonRef = useRef<HTMLButtonElement>(null);

  useEffect(() => {
    localStorage.setItem('darkMode', JSON.stringify(isDarkMode));
    if (isDarkMode) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  }, [isDarkMode]);

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (mobileMenuRef.current &&
        !mobileMenuRef.current.contains(event.target as Node) &&
        !menuButtonRef.current?.contains(event.target as Node)) {
        setIsMobileMenuOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  }, []);

  const toggleDarkMode = () => {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    setIsDarkMode((prev: any) => !prev);
  };

  return (
    <header className="relative flex justify-between p-4 items-center bg-white dark:bg-[#0f1221] transition-colors duration-300">
      <div
        onClick={() => navigate('/')}
        className="text-2xl font-extrabold text-[#D946EF] dark:text-[#E879F9] cursor-pointer"
      >
        CHARELI
      </div>

      {/* Desktop Navigation */}
      <div className="hidden md:flex gap-8 text-lg font-bold text-[#111826] dark:text-[#94A3B7] items-center justify-center">
        <Link to="/about" className="hover:bg-[#D946EF] hover:text-white px-4 py-2 rounded-md">About Us</Link>
        <Link to="/categories" className="hover:bg-[#D946EF] hover:text-white px-4 py-2 rounded-md">Categories</Link>
      </div>

      {/* Mobile Menu Button */}
      <button
        ref={menuButtonRef}
        className="md:hidden text-[#D946EF] p-2"
        onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
      >
        {isMobileMenuOpen ? <RiCloseLine size={24} /> : <RiMenu3Line size={24} />}
      </button>

      {/* Mobile Navigation */}
      {isMobileMenuOpen && (
        <div
          ref={mobileMenuRef}
          className="absolute top-full left-0 right-0 bg-white dark:bg-[#0f1221] shadow-lg md:hidden z-50 border-t border-gray-200 dark:border-gray-800"
        >
          <div className="flex flex-col p-4 gap-4">
            <Link
              to="/about"
              className="text-[#111826] dark:text-[#94A3B7] hover:bg-[#D946EF] hover:text-white px-4 py-2 rounded-md text-lg font-bold"
              onClick={() => setIsMobileMenuOpen(false)}
            >
              About Us
            </Link>
            <Link
              to="/categories"
              className="text-[#111826] dark:text-[#94A3B7] hover:bg-[#D946EF] hover:text-white px-4 py-2 rounded-md text-lg font-bold"
              onClick={() => setIsMobileMenuOpen(false)}
            >
              Categories
            </Link>
            {isAuthenticated ? (
              <div className="flex flex-col gap-4">
                {isAdmin && (
                  <Button
                    onClick={() => {
                      navigate('/admin');
                      setIsMobileMenuOpen(false);
                    }}
                    className="bg-[#E328AF] text-white hover:bg-[#C026D3] w-full"
                  >
                    Admin Dashboard
                  </Button>
                )}
                <div className="flex justify-between items-center">
                  <img
                    src={bolt}
                    alt="bolt"
                    className="cursor-pointer"
                    onClick={() => {
                      setIsStatsModalOpen(true);
                      setIsMobileMenuOpen(false);
                    }}
                  />
                  <img
                    src={profileImg}
                    alt="profile image"
                    className="cursor-pointer"
                    onClick={() => {
                      setIsProfileModalOpen(true);
                      setIsMobileMenuOpen(false);
                    }}
                  />
                </div>
                <Button
                  onClick={() => {
                    logout();
                    navigate('/');
                    setIsMobileMenuOpen(false);
                  }}
                  className="bg-transparent border border-red-500 text-red-500 hover:bg-red-500 hover:text-white w-full"
                >
                  Logout
                </Button>
              </div>
            ) : (
              <div className="flex flex-col gap-4">
                <Button
                  onClick={() => {
                    setIsLoginModalOpen(true);
                    setIsMobileMenuOpen(false);
                  }}
                  className="bg-transparent border border-[#111826] dark:border-gray-500 text-[#111826] hover:text-[#111826] dark:text-gray-300 text-lg cursor-pointer hover:bg-accent w-full"
                >
                  Log in
                </Button>
                <Button
                  onClick={() => {
                    trackSignup({
                      sessionId: getVisitorSessionId(),
                      type: 'navbar'
                    });
                    setIsSignUpModalOpen(true);
                    setIsMobileMenuOpen(false);
                  }}
                  className="bg-transparent border border-[#C026D3] dark:border-purple-400 text-[#C026D3] dark:text-purple-300 text-lg hover:bg-accent hover:text-[#C026D3] w-full"
                >
                  Sign up
                </Button>
              </div>
            )}
            <div className="flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800">
              <span className="text-[#111826] dark:text-[#94A3B7] font-medium">Theme</span>
              <img
                onClick={toggleDarkMode}
                src={isDarkMode ? moon : sun}
                alt={isDarkMode ? 'light mode' : 'dark mode'}
                className="w-6 h-6 cursor-pointer"
              />
            </div>
          </div>
        </div>
      )}

      {/* Modals - Available for both mobile and desktop */}
      <SignUpModal
        open={isSignUpModalOpen}
        onOpenChange={setIsSignUpModalOpen}
        openLoginModal={() => {
          setIsSignUpModalOpen(false);
          setIsLoginModalOpen(true);
        }}
      />
      <LoginModal
        open={isLoginModalOpen}
        onOpenChange={setIsLoginModalOpen}
        openSignUpModal={() => {
          setIsLoginModalOpen(false);
          setIsSignUpModalOpen(true);
        }}
      />
      <StatsModal open={isStatsModalOpen} onClose={() => setIsStatsModalOpen(false)} />
      <ProfileModal open={isProfileModalOpen} onClose={() => setIsProfileModalOpen(false)} />

      {/* Desktop Actions */}
      <div className="hidden md:flex space-x-4 items-center">
        <img
          onClick={toggleDarkMode}
          src={isDarkMode ? moon : sun}
          alt={isDarkMode ? 'light mode' : 'dark mode'}
          className="w-6 h-6 cursor-pointer"
        />

        {isAuthenticated ? (
          <>
            {isAdmin && (
              <Button
                onClick={() => navigate('/admin')}
                className="bg-[#E328AF] text-white hover:bg-[#C026D3]"
              >
                Admin Dashboard
              </Button>
            )}

            <img
              src={bolt}
              alt="bolt"
              className="cursor-pointer"
              onClick={() => setIsStatsModalOpen(true)}
            />

            <img
              src={profileImg}
              alt="profile image"
              className="cursor-pointer"
              onClick={() => setIsProfileModalOpen(true)}
            />

            <Button
              onClick={() => {
                logout();
                navigate('/');
              }}
              className="bg-transparent border border-red-500 text-red-500 hover:bg-red-500 hover:text-white"
            >
              Logout
            </Button>
          </>
        ) : (
          <>
            <Button
              onClick={() => setIsLoginModalOpen(true)}
              className="bg-transparent border border-[#111826] dark:border-gray-500 text-[#111826] hover:text-[#111826] dark:text-gray-300 text-lg cursor-pointer hover:bg-accent">
              Log in
            </Button>
            <Button
              onClick={() => {
                trackSignup({
                  sessionId: getVisitorSessionId(),
                  type: 'navbar'
                });
                setIsSignUpModalOpen(true);
              }}
              className="bg-transparent border border-[#C026D3] dark:border-purple-400 text-[#C026D3] dark:text-purple-300 text-lg hover:bg-accent hover:text-[#C026D3]">
              Sign up
            </Button>
          </>
        )}

      </div>
    </header>
  );
};

export default Navbar;
</file>

<file path="src/components/single/NoResults.tsx">
import React from 'react';
import { RiSearchLine } from 'react-icons/ri';
import { cn } from '../../lib/utils';

interface NoResultsProps {
  title?: string;
  message?: string;
  icon?: React.ReactNode;
  className?: string;
}

export function NoResults({
  title = "No results found",
  message = "Try adjusting your filters or search criteria",
  icon = <RiSearchLine className="w-12 h-12 text-gray-400" />,
  className
}: NoResultsProps) {
  return (
    <div className={cn(
      "flex flex-col items-center justify-center py-12 px-4",
      "bg-transparent",
      className
    )}>
      <div className="mb-4">
        {icon}
      </div>
      <h3 className="text-lg font-semibold text-gray-900 dark:text-white mb-2">
        {title}
      </h3>
      <p className="text-sm text-gray-500 dark:text-gray-400 text-center max-w-sm">
        {message}
      </p>
    </div>
  );
}
</file>

<file path="src/components/single/PopularSection.tsx">
import { Card } from "../../components/ui/card";
import { Input } from "../ui/input";
import { IoIosSearch } from "react-icons/io";
import { useNavigate } from "react-router-dom";
import { useGames } from "../../backend/games.service";
import GamesSkeleton from "./GamesSkeleton";

import emptyGameImg from "../../assets/empty-game.png";

interface PopularSectionProps {
    searchQuery: string;
    setSearchQuery: (query: string) => void;
}

const PopularSection = ({ searchQuery, setSearchQuery }: PopularSectionProps) => {
    const navigate = useNavigate();
    const { data: gamesData, isLoading, error } = useGames({
        filter: "popular",
        status: "active",
        search: searchQuery || undefined,
        limit: 4
    });
    const games: any = gamesData || [];

    const handleGamePlay = (gameId: string) => {
        navigate(`/gameplay/${gameId}`);
    };

    return (
        <div className="p-4">
            <div className="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8">
                <h1 className="text-[#D946EF] text-4xl font-boogaloo tracking-wide">Popular</h1>
                <div className="relative w-full md:w-[400px]">
                    <IoIosSearch className="absolute left-4 top-1/2 transform -translate-y-1/2 text-[#64748A] text-xl pointer-events-none" />
                    <Input
                        className="pl-12 w-full h-12 rounded-2xl text-[#64748A] tracking-wider border-2 border-[#D946EF] focus:border-[#D946EF] focus:outline-none shadow-[0_0_8px_rgba(217,70,239,0.2)]
                        placeholder:text-[#64748A] bg-white/5
                        placeholder:text-sm"
                        placeholder="What game do you want to search for?"
                        value={searchQuery}
                        onChange={(e) => setSearchQuery(e.target.value)}
                    />
                </div>
            </div>
            <div className="">
                <Card className="border-hidden shadow-none p-0 dark:bg-[#0f1221]">
                    {isLoading && <GamesSkeleton count={4} />}
                    {error && <div className="text-center py-8 text-red-500">Error loading games</div>}
                    {!isLoading && !error && games.length === 0 && (
                         <div className="text-center py-8 min-h-[60vh] flex flex-col items-center justify-center gap-4 text-[#C026D3] text-4xl">
                            <img src={emptyGameImg} alt="No games" className="w-80 h-80 object-contain" />
                            No popular games found {searchQuery ? `for "${searchQuery}"` : ""}
                        </div>
                    )}
                    {!isLoading && !error && games.length > 0 && (
                        <div className="grid gap-[10px] w-full grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 justify-items-center">
                            {games.map((game: any) => (
                                <div key={game.id} className="relative p-[10px] group cursor-pointer w-full max-w-[340px]">
                                    <img
                                        src={game.thumbnailFile?.s3Key}
                                        alt={game.title}
                                        loading="lazy"
                                        className="w-full h-[290px] min-h-[290px] max-h-[290px] object-cover rounded-[32px] border-4 border-transparent group-hover:border-[#D946EF] transition-all duration-300 ease-in-out group-hover:scale-105 group-hover:shadow-[0_0_20px_rgba(217,70,239,0.3)]"
                                        onClick={() => handleGamePlay(game.id)}
                                    />
                                </div>
                            ))}
                        </div>
                    )}
                </Card>
            </div>
        </div>
    );
};

export default PopularSection;
</file>

<file path="src/components/single/PopUp-Sheet.tsx">
import { Button } from "../ui/button"
import { Input } from "../ui/input"
import { Label } from "../ui/label"
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "../ui/sheet"
import { Formik, Form, Field, ErrorMessage } from "formik"
import { toast } from "sonner"
import * as Yup from "yup"
import { useCreateSystemConfig } from "../../backend/configuration.service"
import { BackendRoute } from "../../backend/constants"
import { useQueryClient } from "@tanstack/react-query"

const validationSchema = Yup.object({
  title: Yup.string().required("Title is required"),
  subtitle: Yup.string().required("Subtitle is required")
});

export function PopUpSheet({ children }: { children: React.ReactNode }) {
  const queryClient = useQueryClient();
  const createConfig = useCreateSystemConfig();

  const initialValues = {
    title: "",
    subtitle: ""
  };

  return (
    <Sheet>
      <SheetTrigger asChild>
        {children}
      </SheetTrigger>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621]">
        <SheetHeader>
          <SheetTitle className="text-xl font-normal tracking-wider mt-6">Admin Configuration</SheetTitle>
          <div className="border border-b-gray-200"></div>
        </SheetHeader>
        <Formik
          initialValues={initialValues}
          validationSchema={validationSchema}
          onSubmit={async (values, { setSubmitting }) => {
            try {
              await createConfig.mutateAsync({
                key: "popup",
                value: values,
                description: "Popup display configuration"
              });
              queryClient.invalidateQueries({ queryKey: [BackendRoute.SYSTEM_CONFIG, "popup"] });
              toast.success("Popup configuration saved successfully");
              // Close the sheet after successful save
              const closeEvent = new Event('click');
              document.querySelector('[aria-label="Close"]')?.dispatchEvent(closeEvent);
            } catch (error) {
              toast.error("Failed to save popup configuration");
            } finally {
              setSubmitting(false);
            }
          }}
        >
          {({ isSubmitting }) => (
            <Form>
              <div className="grid gap-4 p-4">
                {/* title */}
                <div className="items-center gap-4">
                  <div className="flex flex-col space-y-2">
                    <Label htmlFor="title" className="text-right text-lg">
                      Pop-Up Title
                    </Label>
                    <Field
                      as={Input}
                      id="title"
                      name="title"
                      placeholder="Wanna Keep Playing"
                      className="col-span-3 shadow-none text-gray-400 font-thin font-pincuk text-xl tracking-wider h-14 bg-[#F1F5F9] border border-[#CBD5E0]"
                    />
                    <ErrorMessage
                      name="title"
                      component="div"
                      className="text-red-500 text-sm"
                    />
                  </div>
                </div>
                {/* subtitle */}
                <div className="items-center gap-4">
                  <div className="flex flex-col space-y-2">
                    <Label htmlFor="subtitle" className="text-right text-lg">
                      Pop-Up Subtitle
                    </Label>
                    <Field
                      as={Input}
                      id="subtitle"
                      name="subtitle"
                      placeholder="Sign up now"
                      className="col-span-3 shadow-none text-gray-400 font-thin font-pincuk text-xl tracking-wider h-14 bg-[#F1F5F9] border border-[#CBD5E0]"
                    />
                    <ErrorMessage
                      name="subtitle"
                      component="div"
                      className="text-red-500 text-sm"
                    />
                  </div>
                </div>

              </div>
              <div className="flex gap-3 justify-end px-2">
                <SheetClose asChild>
                  <Button type="button" className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0]">
                    Cancel
                  </Button>
                </SheetClose>
                <Button
                  type="submit"
                  className="w-40 h-12 bg-[#D946EF] dark:text-white"
                  disabled={isSubmitting || createConfig.isPending}
                >
                  {(isSubmitting || createConfig.isPending) ? "Saving..." : "Save Configuration"}
                </Button>
              </div>
            </Form>
          )}
        </Formik>
      </SheetContent>
    </Sheet>
  )
}
</file>

<file path="src/components/single/Terms-Sheet.tsx">
import { Button } from '../ui/button';
import { Label } from '../ui/label';
import uploadImg from '../../assets/fetch-upload.svg';
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
} from '../ui/sheet';
import { useCreateSystemConfig } from '../../backend/configuration.service';
import { toast } from 'sonner';
import { useQueryClient } from '@tanstack/react-query';
import { BackendRoute } from '../../backend/constants';
import { useState } from 'react';

interface TermsSheetProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
}

export function TermsSheet({ open, onOpenChange }: TermsSheetProps) {
  const [selectedFile, setSelectedFile] = useState<File | null>(null);
  const queryClient = useQueryClient();
  const createConfig = useCreateSystemConfig();

  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      // Check file type
      if (!file.type.match('application/pdf|application/msword|application/vnd.openxmlformats-officedocument.wordprocessingml.document')) {
        toast.error('Please upload a PDF or Word document');
        return;
      }
      // Check file size (5MB limit)
      if (file.size > 5 * 1024 * 1024) {
        toast.error('File size should not exceed 5MB');
        return;
      }
      setSelectedFile(file);
    }
  };

  const handleSubmit = async (event: React.FormEvent) => {
    event.preventDefault();
    if (!selectedFile) {
      toast.error('Please select a file');
      return;
    }

    try {
      const formData = new FormData();
      formData.append('file', selectedFile);
      formData.append('key', 'terms');
      formData.append('description', 'Terms of use document');

      await createConfig.mutateAsync(formData);
      queryClient.invalidateQueries({ queryKey: [BackendRoute.SYSTEM_CONFIG, 'terms'] });
      toast.success('Terms file uploaded successfully');
      onOpenChange(false);
    } catch (error) {
      toast.error('Failed to upload terms file');
    }
  };

  return (
    <Sheet open={open} onOpenChange={onOpenChange}>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621] max-w-xl w-full">
        <SheetHeader>
          <SheetTitle className="text-2xl font-bold tracking-wider mt-6">
            Terms of Use
          </SheetTitle>
          <div className="border border-b-gray-200 mb-2"></div>
        </SheetHeader>
        <form onSubmit={handleSubmit} className="grid grid-cols-1 gap-6 pl-4 pr-4">
          {/* Thumbnail Upload */}
          <div>
            <Label className="text-lg mb-2 block">Upload file</Label>
            <div className="flex items-center">
              <label className="w-40 h-38 flex flex-col items-center justify-center border border-[#CBD5E0] rounded-lg cursor-pointer hover:border-[#D946EF] transition">
                <img src={uploadImg} alt="upload" className="dark:text-white" />
                <input
                  type="file"
                  accept=".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document"
                  className="hidden"
                  onChange={handleFileChange}
                />
                {selectedFile && (
                  <span className="mt-2 text-sm text-gray-500 truncate max-w-[140px]">
                    {selectedFile.name}
                  </span>
                )}
              </label>
            </div>
          </div>
        </form>
        <div className="flex gap-3 justify-end px-2 mt-4">
          <SheetClose asChild>
            <Button
              type="button"
              className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] hover:bg-accent shadow-none"
            >
              Cancel
            </Button>
          </SheetClose>
          <Button
            type="submit"
            className="w-20 h-12 bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF] shadow-none"
            onClick={handleSubmit}
            disabled={!selectedFile || createConfig.isPending}
          >
            {createConfig.isPending ? 'Uploading...' : 'Add'}
          </Button>
        </div>
      </SheetContent>
    </Sheet>
  );
}
</file>

<file path="src/components/single/UserMgtFilter-Sheet.tsx">
import { Button } from "../ui/button"
import { Input } from "../ui/input"
import { Label } from "../ui/label"
import {
  Sheet,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "../ui/sheet"
import { useGamesAnalytics } from "../../backend/analytics.service"

interface FilterState {
  registrationDates: {
    startDate: string;
    endDate: string;
  };
  sessionCount: string;
  timePlayed: {
    min: number;
    max: number;
  };
  gameTitle: string;
  gameCategory: string;
  sortByMaxTimePlayed: boolean;
}

interface UserManagementFilterSheetProps {
  children: React.ReactNode;
  filters: FilterState;
  onFiltersChange: (filters: FilterState) => void;
  onReset: () => void;
}

export function UserManagementFilterSheet({
  children,
  filters,
  onFiltersChange,
  onReset
}: UserManagementFilterSheetProps) {
  const { data: games } = useGamesAnalytics();

  // Get unique categories from games
  const categories = [...new Set(games?.map(game => game.category?.name).filter(Boolean))];

  // Get game titles
  const titles = games?.map(game => game.title) || [];

  const handleChange = (field: keyof FilterState, value: unknown) => {
    onFiltersChange({
      ...filters,
      [field]: value
    });
  };

  return (
    <Sheet>
      <SheetTrigger asChild>
        {children}
      </SheetTrigger>
      <SheetContent className="font-boogaloo dark:bg-[#0F1621] overflow-y-auto overflow-x-hidden">
        <SheetHeader>
          <SheetTitle className="text-xl font-normal tracking-wider mt-6">Filter</SheetTitle>
          <div className="border border-b-gray-200"></div>
        </SheetHeader>
        <div className="grid gap-4 px-4">
          {/* Registration Dates */}
          <div className="flex flex-col space-y-2">
            <Label className="text-lg">Registration Dates</Label>
            <div className="flex gap-2">
              <Input
                type="date"
                value={filters.registrationDates.startDate}
                onChange={(e) => handleChange('registrationDates', {
                  ...filters.registrationDates,
                  startDate: e.target.value
                })}
                className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 text-gray-400 font-thin font-pincuk text-xl tracking-wider dark:bg-[#121C2D]"
              />
              <Input
                type="date"
                value={filters.registrationDates.endDate}
                onChange={(e) => handleChange('registrationDates', {
                  ...filters.registrationDates,
                  endDate: e.target.value
                })}
                className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 text-gray-400 font-thin font-pincuk text-xl tracking-wider dark:bg-[#121C2D]"
              />
            </div>
          </div>

          {/* Session Count */}
          <div className="flex flex-col space-y-2">
            <Label className="text-lg">Session Count</Label>
            <Input
              type="number"
              min="0"
              value={filters.sessionCount}
              onChange={(e) => handleChange('sessionCount', e.target.value)}
              placeholder="Minimum sessions"
              className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 text-gray-400 font-thin font-pincuk text-xl tracking-wider dark:bg-[#121C2D]"
            />
          </div>

          {/* Time Played (in minutes) */}
          <div className="flex flex-col space-y-2">
            <Label className="text-lg">Time Played (minutes)</Label>
            <div className="flex gap-2">
              <Input
                type="number"
                min="0"
                value={filters.timePlayed.min === 0 ? '' : filters.timePlayed.min}
                onChange={(e) => handleChange('timePlayed', {
                  ...filters.timePlayed,
                  min: e.target.value === '' ? 0 : parseInt(e.target.value, 10) || 0
                })}
                placeholder="Min minutes"
                className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 text-gray-400 font-thin font-pincuk text-xl tracking-wider dark:bg-[#121C2D]"
              />
              <Input
                type="number"
                min={filters.timePlayed.min}
                value={filters.timePlayed.max === 0 ? '' : filters.timePlayed.max}
                onChange={(e) => handleChange('timePlayed', {
                  ...filters.timePlayed,
                  max: e.target.value === '' ? 0 : parseInt(e.target.value, 10) || 0
                })}
                placeholder="Max minutes"
                className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 text-gray-400 font-thin font-pincuk text-xl tracking-wider dark:bg-[#121C2D]"
              />
            </div>
          </div>

          {/* Game Category */}
          <div className="flex flex-col space-y-2">
            <Label className="text-lg">Game Category</Label>
            <select
              value={filters.gameCategory}
              onChange={(e) => handleChange('gameCategory', e.target.value)}
              className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 px-3 text-gray-400 font-thin font-pincuk text-xl tracking-wider rounded dark:bg-[#121C2D]"
            >
              <option value="">All Categories</option>
              {categories.map((category) => (
                <option key={category} value={category}>{category}</option>
              ))}
            </select>
          </div>

          {/* Game Title */}
          <div className="flex flex-col space-y-2">
            <Label className="text-lg">Game Title</Label>
            <select
              value={filters.gameTitle}
              onChange={(e) => handleChange('gameTitle', e.target.value)}
              className="bg-[#F1F5F9] border border-[#CBD5E0] h-14 px-3 text-gray-400 font-thin font-pincuk text-xl tracking-wider rounded dark:bg-[#121C2D]"
            >
              <option value="">All Games</option>
              {titles.map((title) => (
                <option key={title} value={title}>{title}</option>
              ))}
            </select>
          </div>

          {/* Sort by Max Time Played */}
          <div className="flex items-center space-x-2">
            <input
              type="checkbox"
              id="sortByMaxTimePlayed"
              className="w-4 h-4"
              checked={filters.sortByMaxTimePlayed}
              onChange={(e) => handleChange('sortByMaxTimePlayed', e.target.checked)}
            />
            <Label htmlFor="sortByMaxTimePlayed" className="text-lg">Sort by Max Time Played</Label>
          </div>



        </div>

        <div className="flex gap-3 justify-end px-2 mb-4">
          <SheetClose asChild>
            <Button
              type="button"
              onClick={onReset}
              className="w-20 h-12 text-[#334154] bg-[#F8FAFC] border border-[#E2E8F0] hover:bg-accent"
            >
              Reset
            </Button>
          </SheetClose>
          <SheetClose asChild>
            <Button
              type="button"
              className="w-20 h-12 bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
            >
              Filter
            </Button>
          </SheetClose>
        </div>
      </SheetContent>
    </Sheet>
  )
}
</file>

<file path="src/components/ui/alert-dialog.tsx">
import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "../../lib/utils"
import { buttonVariants } from "./button"

function AlertDialog({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Root>) {
  return <AlertDialogPrimitive.Root data-slot="alert-dialog" {...props} />
}

function AlertDialogTrigger({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Trigger>) {
  return (
    <AlertDialogPrimitive.Trigger data-slot="alert-dialog-trigger" {...props} />
  )
}

function AlertDialogPortal({
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Portal>) {
  return (
    <AlertDialogPrimitive.Portal data-slot="alert-dialog-portal" {...props} />
  )
}

function AlertDialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Overlay>) {
  return (
    <AlertDialogPrimitive.Overlay
      data-slot="alert-dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogContent({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Content>) {
  return (
    <AlertDialogPortal>
      <AlertDialogOverlay />
      <AlertDialogPrimitive.Content
        data-slot="alert-dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className
        )}
        {...props}
      />
    </AlertDialogPortal>
  )
}

function AlertDialogHeader({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function AlertDialogFooter({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function AlertDialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Title>) {
  return (
    <AlertDialogPrimitive.Title
      data-slot="alert-dialog-title"
      className={cn("text-lg font-semibold", className)}
      {...props}
    />
  )
}

function AlertDialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Description>) {
  return (
    <AlertDialogPrimitive.Description
      data-slot="alert-dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function AlertDialogAction({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Action>) {
  return (
    <AlertDialogPrimitive.Action
      className={cn(buttonVariants(), className)}
      {...props}
    />
  )
}

function AlertDialogCancel({
  className,
  ...props
}: React.ComponentProps<typeof AlertDialogPrimitive.Cancel>) {
  return (
    <AlertDialogPrimitive.Cancel
      className={cn(buttonVariants({ variant: "outline" }), className)}
      {...props}
    />
  )
}

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}
</file>

<file path="src/components/ui/alert.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "../../lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",
  {
    variants: {
      variant: {
        default: "bg-card text-card-foreground",
        destructive:
          "text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Alert({
  className,
  variant,
  ...props
}: React.ComponentProps<"div"> & VariantProps<typeof alertVariants>) {
  return (
    <div
      data-slot="alert"
      role="alert"
      className={cn(alertVariants({ variant }), className)}
      {...props}
    />
  )
}

function AlertTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-title"
      className={cn(
        "col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",
        className
      )}
      {...props}
    />
  )
}

function AlertDescription({
  className,
  ...props
}: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="alert-description"
      className={cn(
        "text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",
        className
      )}
      {...props}
    />
  )
}

export { Alert, AlertTitle, AlertDescription }
</file>

<file path="src/components/ui/aspect-ratio.tsx">
"use client"

import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"

function AspectRatio({
  ...props
}: React.ComponentProps<typeof AspectRatioPrimitive.Root>) {
  return <AspectRatioPrimitive.Root data-slot="aspect-ratio" {...props} />
}

export { AspectRatio }
</file>

<file path="src/components/ui/avatar.tsx">
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "../../lib/utils"

function Avatar({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Root>) {
  return (
    <AvatarPrimitive.Root
      data-slot="avatar"
      className={cn(
        "relative flex size-8 shrink-0 overflow-hidden rounded-full",
        className
      )}
      {...props}
    />
  )
}

function AvatarImage({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Image>) {
  return (
    <AvatarPrimitive.Image
      data-slot="avatar-image"
      className={cn("aspect-square size-full", className)}
      {...props}
    />
  )
}

function AvatarFallback({
  className,
  ...props
}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {
  return (
    <AvatarPrimitive.Fallback
      data-slot="avatar-fallback"
      className={cn(
        "bg-muted flex size-full items-center justify-center rounded-full",
        className
      )}
      {...props}
    />
  )
}

export { Avatar, AvatarImage, AvatarFallback }
</file>

<file path="src/components/ui/badge.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "../../lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }
</file>

<file path="src/components/ui/breadcrumb.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { ChevronRight, MoreHorizontal } from "lucide-react"
import { cn } from "../../lib/utils"

function Breadcrumb({ ...props }: React.ComponentProps<"nav">) {
  return <nav aria-label="breadcrumb" data-slot="breadcrumb" {...props} />
}

function BreadcrumbList({ className, ...props }: React.ComponentProps<"ol">) {
  return (
    <ol
      data-slot="breadcrumb-list"
      className={cn(
        "text-muted-foreground flex flex-wrap items-center gap-1.5 text-sm break-words sm:gap-2.5",
        className
      )}
      {...props}
    />
  )
}

function BreadcrumbItem({ className, ...props }: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="breadcrumb-item"
      className={cn("inline-flex items-center gap-1.5", className)}
      {...props}
    />
  )
}

function BreadcrumbLink({
  asChild,
  className,
  ...props
}: React.ComponentProps<"a"> & {
  asChild?: boolean
}) {
  const Comp = asChild ? Slot : "a"

  return (
    <Comp
      data-slot="breadcrumb-link"
      className={cn("hover:text-foreground transition-colors", className)}
      {...props}
    />
  )
}

function BreadcrumbPage({ className, ...props }: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="breadcrumb-page"
      role="link"
      aria-disabled="true"
      aria-current="page"
      className={cn("text-foreground font-normal", className)}
      {...props}
    />
  )
}

function BreadcrumbSeparator({
  children,
  className,
  ...props
}: React.ComponentProps<"li">) {
  return (
    <li
      data-slot="breadcrumb-separator"
      role="presentation"
      aria-hidden="true"
      className={cn("[&>svg]:size-3.5", className)}
      {...props}
    >
      {children ?? <ChevronRight />}
    </li>
  )
}

function BreadcrumbEllipsis({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="breadcrumb-ellipsis"
      role="presentation"
      aria-hidden="true"
      className={cn("flex size-9 items-center justify-center", className)}
      {...props}
    >
      <MoreHorizontal className="size-4" />
      <span className="sr-only">More</span>
    </span>
  )
}

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
}
</file>

<file path="src/components/ui/button.tsx">
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "../../lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default:
          "bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",
        destructive:
          "bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant,
  size,
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }
</file>

<file path="src/components/ui/calendar.tsx">
"use client"

import * as React from "react"
import { ChevronLeft, ChevronRight } from "lucide-react"
import { DayPicker } from "react-day-picker"
import type { DayPickerProps } from "react-day-picker"

import { cn } from "../../lib/utils"
import { buttonVariants } from "./button"

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: React.ComponentProps<typeof DayPicker>) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row gap-2",
        month: "flex flex-col gap-4",
        caption: "flex justify-center pt-1 relative items-center w-full",
        caption_label: "text-sm font-medium",
        nav: "flex items-center gap-1",
        nav_button: cn(
          buttonVariants({ variant: "outline" }),
          "size-7 bg-transparent p-0 opacity-50 hover:opacity-100"
        ),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-x-1",
        head_row: "flex",
        head_cell:
          "text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: cn(
          "relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",
          props.mode === "range"
            ? "[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md"
            : "[&:has([aria-selected])]:rounded-md"
        ),
        day: cn(
          buttonVariants({ variant: "ghost" }),
          "size-8 p-0 font-normal aria-selected:opacity-100"
        ),
        day_range_start:
          "day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",
        day_range_end:
          "day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground aria-selected:text-muted-foreground",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle:
          "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        Dropdown: () => (
          <div className="flex gap-1">
            <button className="nav_button nav_button_previous">
              <ChevronLeft className="size-4" />
            </button>
            <button className="nav_button nav_button_next">
              <ChevronRight className="size-4" />
            </button>
          </div>
        )
      } satisfies NonNullable<DayPickerProps["components"]>}
      {...props}
    />
  )
}

export { Calendar }
</file>

<file path="src/components/ui/card.tsx">
import * as React from "react"

import { cn } from "../../lib/utils"

function Card({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card"
      className={cn(
        "bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",
        className
      )}
      {...props}
    />
  )
}

function CardHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-header"
      className={cn(
        "@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",
        className
      )}
      {...props}
    />
  )
}

function CardTitle({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-title"
      className={cn("leading-none font-semibold", className)}
      {...props}
    />
  )
}

function CardDescription({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function CardAction({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-action"
      className={cn(
        "col-start-2 row-span-2 row-start-1 self-start justify-self-end",
        className
      )}
      {...props}
    />
  )
}

function CardContent({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-content"
      className={cn("px-6", className)}
      {...props}
    />
  )
}

function CardFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="card-footer"
      className={cn("flex items-center px-6 [.border-t]:pt-6", className)}
      {...props}
    />
  )
}

export {
  Card,
  CardHeader,
  CardFooter,
  CardTitle,
  CardAction,
  CardDescription,
  CardContent,
}
</file>

<file path="src/components/ui/carousel.tsx">
import * as React from "react"
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from "embla-carousel-react"
import { ArrowLeft, ArrowRight } from "lucide-react"

import { cn } from "../../lib/utils"
import { Button } from "./button"

type CarouselApi = UseEmblaCarouselType[1]
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>
type CarouselOptions = UseCarouselParameters[0]
type CarouselPlugin = UseCarouselParameters[1]

type CarouselProps = {
  opts?: CarouselOptions
  plugins?: CarouselPlugin
  orientation?: "horizontal" | "vertical"
  setApi?: (api: CarouselApi) => void
}

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0]
  api: ReturnType<typeof useEmblaCarousel>[1]
  scrollPrev: () => void
  scrollNext: () => void
  canScrollPrev: boolean
  canScrollNext: boolean
} & CarouselProps

const CarouselContext = React.createContext<CarouselContextProps | null>(null)

function useCarousel() {
  const context = React.useContext(CarouselContext)

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />")
  }

  return context
}

function Carousel({
  orientation = "horizontal",
  opts,
  setApi,
  plugins,
  className,
  children,
  ...props
}: React.ComponentProps<"div"> & CarouselProps) {
  const [carouselRef, api] = useEmblaCarousel(
    {
      ...opts,
      axis: orientation === "horizontal" ? "x" : "y",
    },
    plugins
  )
  const [canScrollPrev, setCanScrollPrev] = React.useState(false)
  const [canScrollNext, setCanScrollNext] = React.useState(false)

  const onSelect = React.useCallback((api: CarouselApi) => {
    if (!api) return
    setCanScrollPrev(api.canScrollPrev())
    setCanScrollNext(api.canScrollNext())
  }, [])

  const scrollPrev = React.useCallback(() => {
    api?.scrollPrev()
  }, [api])

  const scrollNext = React.useCallback(() => {
    api?.scrollNext()
  }, [api])

  const handleKeyDown = React.useCallback(
    (event: React.KeyboardEvent<HTMLDivElement>) => {
      if (event.key === "ArrowLeft") {
        event.preventDefault()
        scrollPrev()
      } else if (event.key === "ArrowRight") {
        event.preventDefault()
        scrollNext()
      }
    },
    [scrollPrev, scrollNext]
  )

  React.useEffect(() => {
    if (!api || !setApi) return
    setApi(api)
  }, [api, setApi])

  React.useEffect(() => {
    if (!api) return
    onSelect(api)
    api.on("reInit", onSelect)
    api.on("select", onSelect)

    return () => {
      api?.off("select", onSelect)
    }
  }, [api, onSelect])

  return (
    <CarouselContext.Provider
      value={{
        carouselRef,
        api: api,
        opts,
        orientation:
          orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
        scrollPrev,
        scrollNext,
        canScrollPrev,
        canScrollNext,
      }}
    >
      <div
        onKeyDownCapture={handleKeyDown}
        className={cn("relative", className)}
        role="region"
        aria-roledescription="carousel"
        data-slot="carousel"
        {...props}
      >
        {children}
      </div>
    </CarouselContext.Provider>
  )
}

function CarouselContent({ className, ...props }: React.ComponentProps<"div">) {
  const { carouselRef, orientation } = useCarousel()

  return (
    <div
      ref={carouselRef}
      className="overflow-hidden"
      data-slot="carousel-content"
    >
      <div
        className={cn(
          "flex",
          orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col",
          className
        )}
        {...props}
      />
    </div>
  )
}

function CarouselItem({ className, ...props }: React.ComponentProps<"div">) {
  const { orientation } = useCarousel()

  return (
    <div
      role="group"
      aria-roledescription="slide"
      data-slot="carousel-item"
      className={cn(
        "min-w-0 shrink-0 grow-0 basis-full",
        orientation === "horizontal" ? "pl-4" : "pt-4",
        className
      )}
      {...props}
    />
  )
}

function CarouselPrevious({
  className,
  variant = "outline",
  size = "icon",
  ...props
}: React.ComponentProps<typeof Button>) {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel()

  return (
    <Button
      data-slot="carousel-previous"
      variant={variant}
      size={size}
      className={cn(
        "absolute size-8 rounded-full",
        orientation === "horizontal"
          ? "top-1/2 -left-12 -translate-y-1/2"
          : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft />
      <span className="sr-only">Previous slide</span>
    </Button>
  )
}

function CarouselNext({
  className,
  variant = "outline",
  size = "icon",
  ...props
}: React.ComponentProps<typeof Button>) {
  const { orientation, scrollNext, canScrollNext } = useCarousel()

  return (
    <Button
      data-slot="carousel-next"
      variant={variant}
      size={size}
      className={cn(
        "absolute size-8 rounded-full",
        orientation === "horizontal"
          ? "top-1/2 -right-12 -translate-y-1/2"
          : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
        className
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight />
      <span className="sr-only">Next slide</span>
    </Button>
  )
}

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
}
</file>

<file path="src/components/ui/chart.tsx">
import * as React from "react"
import * as RechartsPrimitive from "recharts"

import { cn } from "../../lib/utils"

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />")
  }

  return context
}

function ChartContainer({
  id,
  className,
  children,
  config,
  ...props
}: React.ComponentProps<"div"> & {
  config: ChartConfig
  children: React.ComponentProps<
    typeof RechartsPrimitive.ResponsiveContainer
  >["children"]
}) {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-slot="chart"
        data-chart={chartId}
        className={cn(
          "[&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border flex aspect-video justify-center text-xs [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
}

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([, config]) => config.theme || config.color
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join("\n")}
}
`
          )
          .join("\n"),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

function ChartTooltipContent({
  active,
  payload,
  className,
  indicator = "dot",
  hideLabel = false,
  hideIndicator = false,
  label,
  labelFormatter,
  labelClassName,
  formatter,
  color,
  nameKey,
  labelKey,
}: React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
  React.ComponentProps<"div"> & {
    hideLabel?: boolean
    hideIndicator?: boolean
    indicator?: "line" | "dot" | "dashed"
    nameKey?: string
    labelKey?: string
  }) {
  const { config } = useChart()

  const tooltipLabel = React.useMemo(() => {
    if (hideLabel || !payload?.length) {
      return null
    }

    const [item] = payload
    const key = `${labelKey || item?.dataKey || item?.name || "value"}`
    const itemConfig = getPayloadConfigFromPayload(config, item, key)
    const value =
      !labelKey && typeof label === "string"
        ? config[label as keyof typeof config]?.label || label
        : itemConfig?.label

    if (labelFormatter) {
      return (
        <div className={cn("font-medium", labelClassName)}>
          {labelFormatter(value, payload)}
        </div>
      )
    }

    if (!value) {
      return null
    }

    return <div className={cn("font-medium", labelClassName)}>{value}</div>
  }, [
    label,
    labelFormatter,
    payload,
    hideLabel,
    labelClassName,
    config,
    labelKey,
  ])

  if (!active || !payload?.length) {
    return null
  }

  const nestLabel = payload.length === 1 && indicator !== "dot"

  return (
    <div
      className={cn(
        "border-border/50 bg-background grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl",
        className
      )}
    >
      {!nestLabel ? tooltipLabel : null}
      <div className="grid gap-1.5">
        {payload.map((item, index) => {
          const key = `${nameKey || item.name || item.dataKey || "value"}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)
          const indicatorColor = color || item.payload.fill || item.color

          return (
            <div
              key={item.dataKey}
              className={cn(
                "[&>svg]:text-muted-foreground flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5",
                indicator === "dot" && "items-center"
              )}
            >
              {formatter && item?.value !== undefined && item.name ? (
                formatter(item.value, item.name, item, index, item.payload)
              ) : (
                <>
                  {itemConfig?.icon ? (
                    <itemConfig.icon />
                  ) : (
                    !hideIndicator && (
                      <div
                        className={cn(
                          "shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",
                          {
                            "h-2.5 w-2.5": indicator === "dot",
                            "w-1": indicator === "line",
                            "w-0 border-[1.5px] border-dashed bg-transparent":
                              indicator === "dashed",
                            "my-0.5": nestLabel && indicator === "dashed",
                          }
                        )}
                        style={
                          {
                            "--color-bg": indicatorColor,
                            "--color-border": indicatorColor,
                          } as React.CSSProperties
                        }
                      />
                    )
                  )}
                  <div
                    className={cn(
                      "flex flex-1 justify-between leading-none",
                      nestLabel ? "items-end" : "items-center"
                    )}
                  >
                    <div className="grid gap-1.5">
                      {nestLabel ? tooltipLabel : null}
                      <span className="text-muted-foreground">
                        {itemConfig?.label || item.name}
                      </span>
                    </div>
                    {item.value && (
                      <span className="text-foreground font-mono font-medium tabular-nums">
                        {item.value.toLocaleString()}
                      </span>
                    )}
                  </div>
                </>
              )}
            </div>
          )
        })}
      </div>
    </div>
  )
}

const ChartLegend = RechartsPrimitive.Legend

function ChartLegendContent({
  className,
  hideIcon = false,
  payload,
  verticalAlign = "bottom",
  nameKey,
}: React.ComponentProps<"div"> &
  Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
    hideIcon?: boolean
    nameKey?: string
  }) {
  const { config } = useChart()

  if (!payload?.length) {
    return null
  }

  return (
    <div
      className={cn(
        "flex items-center justify-center gap-4",
        verticalAlign === "top" ? "pb-3" : "pt-3",
        className
      )}
    >
      {payload.map((item) => {
        const key = `${nameKey || item.dataKey || "value"}`
        const itemConfig = getPayloadConfigFromPayload(config, item, key)

        return (
          <div
            key={item.value}
            className={cn(
              "[&>svg]:text-muted-foreground flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3"
            )}
          >
            {itemConfig?.icon && !hideIcon ? (
              <itemConfig.icon />
            ) : (
              <div
                className="h-2 w-2 shrink-0 rounded-[2px]"
                style={{
                  backgroundColor: item.color,
                }}
              />
            )}
            {itemConfig?.label}
          </div>
        )
      })}
    </div>
  )
}

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}
</file>

<file path="src/components/ui/checkbox.tsx">
"use client"

import * as React from "react"
import * as CheckboxPrimitive from "@radix-ui/react-checkbox"
import { CheckIcon } from "lucide-react"

import { cn } from "../../lib/utils"

interface CheckboxProps extends React.ComponentProps<typeof CheckboxPrimitive.Root> {
  color?: string
}

function Checkbox({
  className,
  color,
  ...props
}: CheckboxProps) {
  return (
    <CheckboxPrimitive.Root
   data-slot="checkbox"
     className={cn(
        "peer border-input dark:bg-input/30 focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      style={
        props.checked
          ? { backgroundColor: color, borderColor: color, color: "#fff" }
          : undefined
      }
      {...props}
    >
      <CheckboxPrimitive.Indicator
        data-slot="checkbox-indicator"
        className="flex items-center justify-center text-current transition-none"
      >
        <CheckIcon className="size-3.5" />
      </CheckboxPrimitive.Indicator>
    </CheckboxPrimitive.Root>
  )
}

export { Checkbox }
</file>

<file path="src/components/ui/collapsible.tsx">
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

function Collapsible({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.Root>) {
  return <CollapsiblePrimitive.Root data-slot="collapsible" {...props} />
}

function CollapsibleTrigger({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleTrigger>) {
  return (
    <CollapsiblePrimitive.CollapsibleTrigger
      data-slot="collapsible-trigger"
      {...props}
    />
  )
}

function CollapsibleContent({
  ...props
}: React.ComponentProps<typeof CollapsiblePrimitive.CollapsibleContent>) {
  return (
    <CollapsiblePrimitive.CollapsibleContent
      data-slot="collapsible-content"
      {...props}
    />
  )
}

export { Collapsible, CollapsibleTrigger, CollapsibleContent }
</file>

<file path="src/components/ui/command.tsx">
"use client"

import * as React from "react"
import { Command as CommandPrimitive } from "cmdk"
import { SearchIcon } from "lucide-react"

import { cn } from "../../lib/utils"
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
} from "./dialog"

function Command({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive>) {
  return (
    <CommandPrimitive
      data-slot="command"
      className={cn(
        "bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",
        className
      )}
      {...props}
    />
  )
}

function CommandDialog({
  title = "Command Palette",
  description = "Search for a command to run...",
  children,
  ...props
}: React.ComponentProps<typeof Dialog> & {
  title?: string
  description?: string
}) {
  return (
    <Dialog {...props}>
      <DialogHeader className="sr-only">
        <DialogTitle>{title}</DialogTitle>
        <DialogDescription>{description}</DialogDescription>
      </DialogHeader>
      <DialogContent className="overflow-hidden p-0">
        <Command className="[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  )
}

function CommandInput({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Input>) {
  return (
    <div
      data-slot="command-input-wrapper"
      className="flex h-9 items-center gap-2 border-b px-3"
    >
      <SearchIcon className="size-4 shrink-0 opacity-50" />
      <CommandPrimitive.Input
        data-slot="command-input"
        className={cn(
          "placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        {...props}
      />
    </div>
  )
}

function CommandList({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.List>) {
  return (
    <CommandPrimitive.List
      data-slot="command-list"
      className={cn(
        "max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",
        className
      )}
      {...props}
    />
  )
}

function CommandEmpty({
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Empty>) {
  return (
    <CommandPrimitive.Empty
      data-slot="command-empty"
      className="py-6 text-center text-sm"
      {...props}
    />
  )
}

function CommandGroup({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Group>) {
  return (
    <CommandPrimitive.Group
      data-slot="command-group"
      className={cn(
        "text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",
        className
      )}
      {...props}
    />
  )
}

function CommandSeparator({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Separator>) {
  return (
    <CommandPrimitive.Separator
      data-slot="command-separator"
      className={cn("bg-border -mx-1 h-px", className)}
      {...props}
    />
  )
}

function CommandItem({
  className,
  ...props
}: React.ComponentProps<typeof CommandPrimitive.Item>) {
  return (
    <CommandPrimitive.Item
      data-slot="command-item"
      className={cn(
        "data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function CommandShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="command-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
}
</file>

<file path="src/components/ui/country-dropdown.tsx">
"use client";
import React, { useCallback, useState, forwardRef, useEffect } from "react";

// shadcn
import {
  Command,
  CommandEmpty,
  CommandGroup,
  CommandInput,
  CommandItem,
  CommandList,
} from "./command";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "./popover";

// utils
import { cn } from "../../lib/utils";

// assets
import { ChevronDown, CheckIcon, Globe } from "lucide-react";
import { CircleFlag } from "react-circle-flags";

// data
import { countries } from "country-data-list";

// Country interface
export interface Country {
  alpha2: string;
  alpha3: string;
  countryCallingCodes: string[];
  currencies: string[];
  emoji?: string;
  ioc: string;
  languages: string[];
  name: string;
  status: string;
}

// Dropdown props
interface CountryDropdownProps {
  options?: Country[];
  onChange?: (country: Country) => void;
  defaultValue?: string;
  disabled?: boolean;
  placeholder?: string;
  slim?: boolean;
  className?: string;
  value?: Country;
}

const CountryDropdownComponent = (
  {
    options = countries.all.filter(
      (country: Country) =>
        country.emoji && country.status !== "deleted" && country.ioc !== "PRK"
    ),
    onChange,
    defaultValue,
    disabled = false,
    placeholder = "Select a country",
    slim = false,
    className,
    value,
    // ...props
  }: CountryDropdownProps,
  ref: React.ForwardedRef<HTMLButtonElement>
) => {
  const [open, setOpen] = useState(false);
  const [selectedCountry, setSelectedCountry] = useState<Country | undefined>(value);

  useEffect(() => {
    setSelectedCountry(value);
  }, [value]);

  useEffect(() => {
    if (defaultValue && !value) {
      const initialCountry = options.find(
        (country) => country.alpha3 === defaultValue
      );
      if (initialCountry) {
        setSelectedCountry(initialCountry);
        onChange?.(initialCountry);
      }
    }
  }, [defaultValue, options, onChange, value]);

  const handleSelect = useCallback(
    (country: Country) => {
      console.log(" CountryDropdown value: ", country);
      setSelectedCountry(country);
      onChange?.(country);
      setOpen(false);
    },
    [onChange]
  );

  const triggerClasses = cn(
    "flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-2 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
    slim === true && "w-[90px]",
    className
  );

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger
        ref={ref}
        className={triggerClasses}
        disabled={disabled}
      >
        {selectedCountry ? (
          <div className="flex items-center flex-grow w-0 gap-1 overflow-hidden">
            <div className="inline-flex items-center justify-center w-5 h-5 shrink-0 overflow-hidden rounded-full">
              <CircleFlag
                countryCode={selectedCountry.alpha2.toLowerCase()}
                height={20}
              />
            </div>
            <span className="overflow-hidden text-ellipsis whitespace-nowrap text-gray-500 text-[11px] font-medium ml-1">
              {selectedCountry.countryCallingCodes[0]}
            </span>
          </div>
        ) : (
          <span>
            {slim === false ? (
              placeholder || setSelectedCountry.name
            ) : (
              <Globe size={20} />
            )}
          </span>
        )}
        <ChevronDown size={14} className="text-gray-500" />
      </PopoverTrigger>
      <PopoverContent
        collisionPadding={10}
        side="bottom"
        className="min-w-[--radix-popper-anchor-width] p-0"
      >
        <Command className="w-full max-h-[200px] sm:max-h-[270px]">
          <CommandList>
            <div className="sticky top-0 z-10 bg-popover">
              <CommandInput placeholder="Search country..." />
            </div>
            <CommandEmpty>No country found.</CommandEmpty>
            <CommandGroup>
              {options
                .filter((x) => x.name)
                .map((option, key: number) => (
                  <CommandItem
                    className="flex items-center w-full gap-2"
                    key={key}
                    onSelect={() => handleSelect(option)}
                  >
                    <div className="flex flex-grow w-0 space-x-2 overflow-hidden">
                      <div className="inline-flex items-center justify-center w-5 h-5 shrink-0 overflow-hidden rounded-full">
                        <CircleFlag
                          countryCode={option.alpha2.toLowerCase()}
                          height={20}
                        />
                      </div>
                      <span className="overflow-hidden text-ellipsis whitespace-nowrap">
                        {option.name}
                      </span>
                    </div>
                    <CheckIcon
                      className={cn(
                        "ml-auto h-4 w-4 shrink-0",
                        option.name === selectedCountry?.name
                          ? "opacity-100"
                          : "opacity-0"
                      )}
                    />
                  </CommandItem>
                ))}
            </CommandGroup>
          </CommandList>
        </Command>
      </PopoverContent>
    </Popover>
  );
};

CountryDropdownComponent.displayName = "CountryDropdownComponent";

export const CountryDropdown = forwardRef(CountryDropdownComponent);
</file>

<file path="src/components/ui/custom-dialog-content.tsx">
import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { cn } from "../../lib/utils"
import { DialogOverlay, DialogPortal } from "./dialog"

function CustomDialogContent({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content>) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className
        )}
        {...props}
      >
        {children}
        {/* Close button removed */}
      </DialogPrimitive.Content>
    </DialogPortal>
  )
}

export { CustomDialogContent }
</file>

<file path="src/components/ui/dialog.tsx">
import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "../../lib/utils"

function Dialog({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Root>) {
  return <DialogPrimitive.Root data-slot="dialog" {...props} />
}

function DialogTrigger({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {
  return <DialogPrimitive.Trigger data-slot="dialog-trigger" {...props} />
}

function DialogPortal({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Portal>) {
  return <DialogPrimitive.Portal data-slot="dialog-portal" {...props} />
}

function DialogClose({
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Close>) {
  return <DialogPrimitive.Close data-slot="dialog-close" {...props} />
}

function DialogOverlay({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {
  return (
    <DialogPrimitive.Overlay
      data-slot="dialog-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function DialogContent({
  className,
  children,
  hideClose, // <-- add this line
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Content> & { hideClose?: boolean }) {
  return (
    <DialogPortal data-slot="dialog-portal">
      <DialogOverlay />
      <DialogPrimitive.Content
        data-slot="dialog-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",
          className
        )}
        {...props}
      >
        {children}
        {!hideClose && (
          <DialogPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4">
            <XIcon />
            <span className="sr-only">Close</span>
          </DialogPrimitive.Close>
        )}
      </DialogPrimitive.Content>
    </DialogPortal>
  )
}

function DialogHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-header"
      className={cn("flex flex-col gap-2 text-center sm:text-left", className)}
      {...props}
    />
  )
}

function DialogFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="dialog-footer"
      className={cn(
        "flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",
        className
      )}
      {...props}
    />
  )
}

function DialogTitle({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Title>) {
  return (
    <DialogPrimitive.Title
      data-slot="dialog-title"
      className={cn("text-lg leading-none font-semibold", className)}
      {...props}
    />
  )
}

function DialogDescription({
  className,
  ...props
}: React.ComponentProps<typeof DialogPrimitive.Description>) {
  return (
    <DialogPrimitive.Description
      data-slot="dialog-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Dialog,
  DialogClose,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogOverlay,
  DialogPortal,
  DialogTitle,
  DialogTrigger,
}
</file>

<file path="src/components/ui/dropdown-menu.tsx">
import * as React from "react"
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu"
import { CheckIcon, ChevronRightIcon, CircleIcon } from "lucide-react"

import { cn } from "../../lib/utils"

function DropdownMenu({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Root>) {
  return <DropdownMenuPrimitive.Root data-slot="dropdown-menu" {...props} />
}

function DropdownMenuPortal({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Portal>) {
  return (
    <DropdownMenuPrimitive.Portal data-slot="dropdown-menu-portal" {...props} />
  )
}

function DropdownMenuTrigger({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Trigger>) {
  return (
    <DropdownMenuPrimitive.Trigger
      data-slot="dropdown-menu-trigger"
      {...props}
    />
  )
}

function DropdownMenuContent({
  className,
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Content>) {
  return (
    <DropdownMenuPrimitive.Portal>
      <DropdownMenuPrimitive.Content
        data-slot="dropdown-menu-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",
          className
        )}
        {...props}
      />
    </DropdownMenuPrimitive.Portal>
  )
}

function DropdownMenuGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Group>) {
  return (
    <DropdownMenuPrimitive.Group data-slot="dropdown-menu-group" {...props} />
  )
}

function DropdownMenuItem({
  className,
  inset,
  variant = "default",
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Item> & {
  inset?: boolean
  variant?: "default" | "destructive"
}) {
  return (
    <DropdownMenuPrimitive.Item
      data-slot="dropdown-menu-item"
      data-inset={inset}
      data-variant={variant}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuCheckboxItem({
  className,
  children,
  checked,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.CheckboxItem>) {
  return (
    <DropdownMenuPrimitive.CheckboxItem
      data-slot="dropdown-menu-checkbox-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      checked={checked}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.CheckboxItem>
  )
}

function DropdownMenuRadioGroup({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioGroup>) {
  return (
    <DropdownMenuPrimitive.RadioGroup
      data-slot="dropdown-menu-radio-group"
      {...props}
    />
  )
}

function DropdownMenuRadioItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.RadioItem>) {
  return (
    <DropdownMenuPrimitive.RadioItem
      data-slot="dropdown-menu-radio-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-sm py-1.5 pr-2 pl-8 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      <span className="pointer-events-none absolute left-2 flex size-3.5 items-center justify-center">
        <DropdownMenuPrimitive.ItemIndicator>
          <CircleIcon className="size-2 fill-current" />
        </DropdownMenuPrimitive.ItemIndicator>
      </span>
      {children}
    </DropdownMenuPrimitive.RadioItem>
  )
}

function DropdownMenuLabel({
  className,
  inset,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Label> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.Label
      data-slot="dropdown-menu-label"
      data-inset={inset}
      className={cn(
        "px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSeparator({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Separator>) {
  return (
    <DropdownMenuPrimitive.Separator
      data-slot="dropdown-menu-separator"
      className={cn("bg-border -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function DropdownMenuShortcut({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      data-slot="dropdown-menu-shortcut"
      className={cn(
        "text-muted-foreground ml-auto text-xs tracking-widest",
        className
      )}
      {...props}
    />
  )
}

function DropdownMenuSub({
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.Sub>) {
  return <DropdownMenuPrimitive.Sub data-slot="dropdown-menu-sub" {...props} />
}

function DropdownMenuSubTrigger({
  className,
  inset,
  children,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubTrigger> & {
  inset?: boolean
}) {
  return (
    <DropdownMenuPrimitive.SubTrigger
      data-slot="dropdown-menu-sub-trigger"
      data-inset={inset}
      className={cn(
        "focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex cursor-default items-center rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[inset]:pl-8",
        className
      )}
      {...props}
    >
      {children}
      <ChevronRightIcon className="ml-auto size-4" />
    </DropdownMenuPrimitive.SubTrigger>
  )
}

function DropdownMenuSubContent({
  className,
  ...props
}: React.ComponentProps<typeof DropdownMenuPrimitive.SubContent>) {
  return (
    <DropdownMenuPrimitive.SubContent
      data-slot="dropdown-menu-sub-content"
      className={cn(
        "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-lg",
        className
      )}
      {...props}
    />
  )
}

export {
  DropdownMenu,
  DropdownMenuPortal,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuGroup,
  DropdownMenuLabel,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioGroup,
  DropdownMenuRadioItem,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuSub,
  DropdownMenuSubTrigger,
  DropdownMenuSubContent,
}
</file>

<file path="src/components/ui/form.tsx">
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  FormProvider,
  useFormContext,
  useFormState,
  type ControllerProps,
  type FieldPath,
  type FieldValues,
} from "react-hook-form"

import { cn } from "../../lib/utils"
import { Label } from "./label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState } = useFormContext()
  const formState = useFormState({ name: fieldContext.name })
  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

function FormItem({ className, ...props }: React.ComponentProps<"div">) {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div
        data-slot="form-item"
        className={cn("grid gap-2", className)}
        {...props}
      />
    </FormItemContext.Provider>
  )
}

function FormLabel({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  const { error, formItemId } = useFormField()

  return (
    <Label
      data-slot="form-label"
      data-error={!!error}
      className={cn("data-[error=true]:text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
}

function FormControl({ ...props }: React.ComponentProps<typeof Slot>) {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      data-slot="form-control"
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
}

function FormDescription({ className, ...props }: React.ComponentProps<"p">) {
  const { formDescriptionId } = useFormField()

  return (
    <p
      data-slot="form-description"
      id={formDescriptionId}
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

function FormMessage({ className, ...props }: React.ComponentProps<"p">) {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message ?? "") : props.children

  if (!body) {
    return null
  }

  return (
    <p
      data-slot="form-message"
      id={formMessageId}
      className={cn("text-destructive text-sm", className)}
      {...props}
    >
      {body}
    </p>
  )
}

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}
</file>

<file path="src/components/ui/input.tsx">
import * as React from "react"

import { cn } from "../../lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }
</file>

<file path="src/components/ui/label.tsx">
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "../../lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }
</file>

<file path="src/components/ui/pagination.tsx">
import * as React from "react"
import {
  ChevronLeftIcon,
  ChevronRightIcon,
  MoreHorizontalIcon,
} from "lucide-react"

import { cn } from "../../lib/utils"
import { Button, buttonVariants } from "./button"

function Pagination({ className, ...props }: React.ComponentProps<"nav">) {
  return (
    <nav
      role="navigation"
      aria-label="pagination"
      data-slot="pagination"
      className={cn("mx-auto flex w-full justify-center", className)}
      {...props}
    />
  )
}

function PaginationContent({
  className,
  ...props
}: React.ComponentProps<"ul">) {
  return (
    <ul
      data-slot="pagination-content"
      className={cn("flex flex-row items-center gap-1", className)}
      {...props}
    />
  )
}

function PaginationItem({ ...props }: React.ComponentProps<"li">) {
  return <li data-slot="pagination-item" {...props} />
}

type PaginationLinkProps = {
  isActive?: boolean
} & Pick<React.ComponentProps<typeof Button>, "size"> &
  React.ComponentProps<"a">

function PaginationLink({
  className,
  isActive,
  size = "icon",
  ...props
}: PaginationLinkProps) {
  return (
    <a
      aria-current={isActive ? "page" : undefined}
      data-slot="pagination-link"
      data-active={isActive}
      className={cn(
        buttonVariants({
          variant: isActive ? "outline" : "ghost",
          size,
        }),
        className
      )}
      {...props}
    />
  )
}

function PaginationPrevious({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to previous page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pl-2.5", className)}
      {...props}
    >
      <ChevronLeftIcon />
      <span className="hidden sm:block">Previous</span>
    </PaginationLink>
  )
}

function PaginationNext({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) {
  return (
    <PaginationLink
      aria-label="Go to next page"
      size="default"
      className={cn("gap-1 px-2.5 sm:pr-2.5", className)}
      {...props}
    >
      <span className="hidden sm:block">Next</span>
      <ChevronRightIcon />
    </PaginationLink>
  )
}

function PaginationEllipsis({
  className,
  ...props
}: React.ComponentProps<"span">) {
  return (
    <span
      aria-hidden
      data-slot="pagination-ellipsis"
      className={cn("flex size-9 items-center justify-center", className)}
      {...props}
    >
      <MoreHorizontalIcon className="size-4" />
      <span className="sr-only">More pages</span>
    </span>
  )
}

export {
  Pagination,
  PaginationContent,
  PaginationLink,
  PaginationItem,
  PaginationPrevious,
  PaginationNext,
  PaginationEllipsis,
}
</file>

<file path="src/components/ui/popover.tsx">
import * as React from "react"
import * as PopoverPrimitive from "@radix-ui/react-popover"

import { cn } from "../../lib/utils"

function Popover({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Root>) {
  return <PopoverPrimitive.Root data-slot="popover" {...props} />
}

function PopoverTrigger({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Trigger>) {
  return <PopoverPrimitive.Trigger data-slot="popover-trigger" {...props} />
}

function PopoverContent({
  className,
  align = "center",
  sideOffset = 4,
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Content>) {
  return (
    <PopoverPrimitive.Portal>
      <PopoverPrimitive.Content
        data-slot="popover-content"
        align={align}
        sideOffset={sideOffset}
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",
          className
        )}
        {...props}
      />
    </PopoverPrimitive.Portal>
  )
}

function PopoverAnchor({
  ...props
}: React.ComponentProps<typeof PopoverPrimitive.Anchor>) {
  return <PopoverPrimitive.Anchor data-slot="popover-anchor" {...props} />
}

export { Popover, PopoverTrigger, PopoverContent, PopoverAnchor }
</file>

<file path="src/components/ui/progress.tsx">
"use client"

import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "../../lib/utils"

function Progress({
  className,
  value,
  ...props
}: React.ComponentProps<typeof ProgressPrimitive.Root>) {
  return (
    <ProgressPrimitive.Root
      data-slot="progress"
      className={cn(
        "bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",
        className
      )}
      {...props}
    >
      <ProgressPrimitive.Indicator
        data-slot="progress-indicator"
        className="bg-primary h-full w-full flex-1 transition-all"
        style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
      />
    </ProgressPrimitive.Root>
  )
}

export { Progress }
</file>

<file path="src/components/ui/radio-group.tsx">
import * as React from "react"
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group"
import { CircleIcon } from "lucide-react"

import { cn } from "../../lib/utils"

function RadioGroup({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Root>) {
  return (
    <RadioGroupPrimitive.Root
      data-slot="radio-group"
      className={cn("grid gap-3", className)}
      {...props}
    />
  )
}

function RadioGroupItem({
  className,
  ...props
}: React.ComponentProps<typeof RadioGroupPrimitive.Item>) {
  return (
    <RadioGroupPrimitive.Item
      data-slot="radio-group-item"
      className={cn(
        "border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator
        data-slot="radio-group-indicator"
        className="relative flex items-center justify-center"
      >
        <CircleIcon className="fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  )
}

export { RadioGroup, RadioGroupItem }
</file>

<file path="src/components/ui/resizable.tsx">
"use client"

import * as React from "react"
import { GripVerticalIcon } from "lucide-react"
import * as ResizablePrimitive from "react-resizable-panels"

import { cn } from "../../lib/utils"

function ResizablePanelGroup({
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) {
  return (
    <ResizablePrimitive.PanelGroup
      data-slot="resizable-panel-group"
      className={cn(
        "flex h-full w-full data-[panel-group-direction=vertical]:flex-col",
        className
      )}
      {...props}
    />
  )
}

function ResizablePanel({
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.Panel>) {
  return <ResizablePrimitive.Panel data-slot="resizable-panel" {...props} />
}

function ResizableHandle({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean
}) {
  return (
    <ResizablePrimitive.PanelResizeHandle
      data-slot="resizable-handle"
      className={cn(
        "bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
        className
      )}
      {...props}
    >
      {withHandle && (
        <div className="bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border">
          <GripVerticalIcon className="size-2.5" />
        </div>
      )}
    </ResizablePrimitive.PanelResizeHandle>
  )
}

export { ResizablePanelGroup, ResizablePanel, ResizableHandle }
</file>

<file path="src/components/ui/scroll-area.tsx">
import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "../../lib/utils"

function ScrollArea({
  className,
  children,
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {
  return (
    <ScrollAreaPrimitive.Root
      data-slot="scroll-area"
      className={cn("relative", className)}
      {...props}
    >
      <ScrollAreaPrimitive.Viewport
        data-slot="scroll-area-viewport"
        className="focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"
      >
        {children}
      </ScrollAreaPrimitive.Viewport>
      <ScrollBar />
      <ScrollAreaPrimitive.Corner />
    </ScrollAreaPrimitive.Root>
  )
}

function ScrollBar({
  className,
  orientation = "vertical",
  ...props
}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {
  return (
    <ScrollAreaPrimitive.ScrollAreaScrollbar
      data-slot="scroll-area-scrollbar"
      orientation={orientation}
      className={cn(
        "flex touch-none p-px transition-colors select-none",
        orientation === "vertical" &&
          "h-full w-2.5 border-l border-l-transparent",
        orientation === "horizontal" &&
          "h-2.5 flex-col border-t border-t-transparent",
        className
      )}
      {...props}
    >
      <ScrollAreaPrimitive.ScrollAreaThumb
        data-slot="scroll-area-thumb"
        className="bg-border relative flex-1 rounded-full"
      />
    </ScrollAreaPrimitive.ScrollAreaScrollbar>
  )
}

export { ScrollArea, ScrollBar }
</file>

<file path="src/components/ui/select.tsx">
"use client"

import * as React from "react"
import * as SelectPrimitive from "@radix-ui/react-select"
import { CheckIcon, ChevronDownIcon, ChevronUpIcon } from "lucide-react"

import { cn } from "../../lib/utils"

function Select({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Root>) {
  return <SelectPrimitive.Root data-slot="select" {...props} />
}

function SelectGroup({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Group>) {
  return <SelectPrimitive.Group data-slot="select-group" {...props} />
}

function SelectValue({
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Value>) {
  return <SelectPrimitive.Value data-slot="select-value" {...props} />
}

function SelectTrigger({
  className,
  size = "default",
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {
  size?: "sm" | "default"
}) {
  return (
    <SelectPrimitive.Trigger
      data-slot="select-trigger"
      data-size={size}
      className={cn(
        "border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    >
      {children}
      <SelectPrimitive.Icon asChild>
        <ChevronDownIcon className="size-4 opacity-50" />
      </SelectPrimitive.Icon>
    </SelectPrimitive.Trigger>
  )
}

function SelectContent({
  className,
  children,
  position = "popper",
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Content>) {
  return (
    <SelectPrimitive.Portal>
      <SelectPrimitive.Content
        data-slot="select-content"
        className={cn(
          "bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",
          position === "popper" &&
            "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
          className
        )}
        position={position}
        {...props}
      >
        <SelectScrollUpButton />
        <SelectPrimitive.Viewport
          className={cn(
            "p-1",
            position === "popper" &&
              "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"
          )}
        >
          {children}
        </SelectPrimitive.Viewport>
        <SelectScrollDownButton />
      </SelectPrimitive.Content>
    </SelectPrimitive.Portal>
  )
}

function SelectLabel({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Label>) {
  return (
    <SelectPrimitive.Label
      data-slot="select-label"
      className={cn("text-muted-foreground px-2 py-1.5 text-xs", className)}
      {...props}
    />
  )
}

function SelectItem({
  className,
  children,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Item>) {
  return (
    <SelectPrimitive.Item
      data-slot="select-item"
      className={cn(
        "focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",
        className
      )}
      {...props}
    >
      <span className="absolute right-2 flex size-3.5 items-center justify-center">
        <SelectPrimitive.ItemIndicator>
          <CheckIcon className="size-4" />
        </SelectPrimitive.ItemIndicator>
      </span>
      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
    </SelectPrimitive.Item>
  )
}

function SelectSeparator({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.Separator>) {
  return (
    <SelectPrimitive.Separator
      data-slot="select-separator"
      className={cn("bg-border pointer-events-none -mx-1 my-1 h-px", className)}
      {...props}
    />
  )
}

function SelectScrollUpButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {
  return (
    <SelectPrimitive.ScrollUpButton
      data-slot="select-scroll-up-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronUpIcon className="size-4" />
    </SelectPrimitive.ScrollUpButton>
  )
}

function SelectScrollDownButton({
  className,
  ...props
}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {
  return (
    <SelectPrimitive.ScrollDownButton
      data-slot="select-scroll-down-button"
      className={cn(
        "flex cursor-default items-center justify-center py-1",
        className
      )}
      {...props}
    >
      <ChevronDownIcon className="size-4" />
    </SelectPrimitive.ScrollDownButton>
  )
}

export {
  Select,
  SelectContent,
  SelectGroup,
  SelectItem,
  SelectLabel,
  SelectScrollDownButton,
  SelectScrollUpButton,
  SelectSeparator,
  SelectTrigger,
  SelectValue,
}
</file>

<file path="src/components/ui/separator.tsx">
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "../../lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator-root"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }
</file>

<file path="src/components/ui/sheet.tsx">
"use client"

import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "../../lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="absolute top-4 right-4 flex items-center justify-center w-12 h-12 rounded-full bg-[#D946EF] hover:bg-[#e782f7] transition-colors focus:outline-none disabled:pointer-events-none">
          <XIcon className="size-6 text-white" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}
</file>

<file path="src/components/ui/skeleton.tsx">
import { cn } from "../../lib/utils"

function Skeleton({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="skeleton"
      className={cn("bg-accent animate-pulse rounded-md", className)}
      {...props}
    />
  )
}

export { Skeleton }
</file>

<file path="src/components/ui/slider.tsx">
import * as React from "react"
import * as SliderPrimitive from "@radix-ui/react-slider"

import { cn } from "../../lib/utils"

function Slider({
  className,
  defaultValue,
  value,
  min = 0,
  max = 100,
  ...props
}: React.ComponentProps<typeof SliderPrimitive.Root>) {
  const _values = React.useMemo(
    () =>
      Array.isArray(value)
        ? value
        : Array.isArray(defaultValue)
          ? defaultValue
          : [min, max],
    [value, defaultValue, min, max]
  )

  return (
    <SliderPrimitive.Root
      data-slot="slider"
      defaultValue={defaultValue}
      value={value}
      min={min}
      max={max}
      className={cn(
        "relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",
        className
      )}
      {...props}
    >
      <SliderPrimitive.Track
        data-slot="slider-track"
        className={cn(
          "bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"
        )}
      >
        <SliderPrimitive.Range
          data-slot="slider-range"
          className={cn(
            "bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full"
          )}
        />
      </SliderPrimitive.Track>
      {Array.from({ length: _values.length }, (_, index) => (
        <SliderPrimitive.Thumb
          data-slot="slider-thumb"
          key={index}
          className="border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"
        />
      ))}
    </SliderPrimitive.Root>
  )
}

export { Slider }
</file>

<file path="src/components/ui/sonner.tsx">
import { useTheme } from "next-themes"
import { Toaster as Sonner, type ToasterProps } from "sonner"

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      style={
        {
          "--normal-bg": "var(--popover)",
          "--normal-text": "var(--popover-foreground)",
          "--normal-border": "var(--border)",
        } as React.CSSProperties
      }
      {...props}
    />
  )
}

export { Toaster }
</file>

<file path="src/components/ui/switch.tsx">
"use client"

import * as React from "react"
import * as SwitchPrimitive from "@radix-ui/react-switch"

import { cn } from "../../lib/utils"

function Switch({
  className,
  ...props
}: React.ComponentProps<typeof SwitchPrimitive.Root>) {
  return (
    <SwitchPrimitive.Root
      data-slot="switch"
      className={cn(
        "peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <SwitchPrimitive.Thumb
        data-slot="switch-thumb"
        className={cn(
          "bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0"
        )}
      />
    </SwitchPrimitive.Root>
  )
}

export { Switch }
</file>

<file path="src/components/ui/table.tsx">
import * as React from "react"

import { cn } from "../../lib/utils"

function Table({ className, ...props }: React.ComponentProps<"table">) {
  return (
    <div
      data-slot="table-container"
      className="relative w-full overflow-x-auto"
    >
      <table
        data-slot="table"
        className={cn("w-full caption-bottom text-sm", className)}
        {...props}
      />
    </div>
  )
}

function TableHeader({ className, ...props }: React.ComponentProps<"thead">) {
  return (
    <thead
      data-slot="table-header"
      className={cn("[&_tr]:border-b", className)}
      {...props}
    />
  )
}

function TableBody({ className, ...props }: React.ComponentProps<"tbody">) {
  return (
    <tbody
      data-slot="table-body"
      className={cn("[&_tr:last-child]:border-0", className)}
      {...props}
    />
  )
}

function TableFooter({ className, ...props }: React.ComponentProps<"tfoot">) {
  return (
    <tfoot
      data-slot="table-footer"
      className={cn(
        "bg-muted/50 border-t font-medium [&>tr]:last:border-b-0",
        className
      )}
      {...props}
    />
  )
}

function TableRow({ className, ...props }: React.ComponentProps<"tr">) {
  return (
    <tr
      data-slot="table-row"
      className={cn(
        "hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",
        className
      )}
      {...props}
    />
  )
}

function TableHead({ className, ...props }: React.ComponentProps<"th">) {
  return (
    <th
      data-slot="table-head"
      className={cn(
        "text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCell({ className, ...props }: React.ComponentProps<"td">) {
  return (
    <td
      data-slot="table-cell"
      className={cn(
        "p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",
        className
      )}
      {...props}
    />
  )
}

function TableCaption({
  className,
  ...props
}: React.ComponentProps<"caption">) {
  return (
    <caption
      data-slot="table-caption"
      className={cn("text-muted-foreground mt-4 text-sm", className)}
      {...props}
    />
  )
}

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}
</file>

<file path="src/components/ui/tabs.tsx">
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "../../lib/utils"

function Tabs({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Root>) {
  return (
    <TabsPrimitive.Root
      data-slot="tabs"
      className={cn("flex flex-col gap-2", className)}
      {...props}
    />
  )
}

function TabsList({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.List>) {
  return (
    <TabsPrimitive.List
      data-slot="tabs-list"
      className={cn(
        "bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",
        className
      )}
      {...props}
    />
  )
}

function TabsTrigger({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {
  return (
    <TabsPrimitive.Trigger
      data-slot="tabs-trigger"
      className={cn(
        "data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",
        className
      )}
      {...props}
    />
  )
}

function TabsContent({
  className,
  ...props
}: React.ComponentProps<typeof TabsPrimitive.Content>) {
  return (
    <TabsPrimitive.Content
      data-slot="tabs-content"
      className={cn("flex-1 outline-none", className)}
      {...props}
    />
  )
}

export { Tabs, TabsList, TabsTrigger, TabsContent }
</file>

<file path="src/components/ui/textarea.tsx">
import * as React from "react"

import { cn } from "../../lib/utils"

function Textarea({ className, ...props }: React.ComponentProps<"textarea">) {
  return (
    <textarea
      data-slot="textarea"
      className={cn(
        "border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        className
      )}
      {...props}
    />
  )
}

export { Textarea }
</file>

<file path="src/components/ui/toggle-group.tsx">
"use client"

import * as React from "react"
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group"
import { type VariantProps } from "class-variance-authority"

import { cn } from "../../lib/utils"
import { toggleVariants } from "./toggle"

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: "default",
  variant: "default",
})

function ToggleGroup({
  className,
  variant,
  size,
  children,
  ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Root> &
  VariantProps<typeof toggleVariants>) {
  return (
    <ToggleGroupPrimitive.Root
      data-slot="toggle-group"
      data-variant={variant}
      data-size={size}
      className={cn(
        "group/toggle-group flex w-fit items-center rounded-md data-[variant=outline]:shadow-xs",
        className
      )}
      {...props}
    >
      <ToggleGroupContext.Provider value={{ variant, size }}>
        {children}
      </ToggleGroupContext.Provider>
    </ToggleGroupPrimitive.Root>
  )
}

function ToggleGroupItem({
  className,
  children,
  variant,
  size,
  ...props
}: React.ComponentProps<typeof ToggleGroupPrimitive.Item> &
  VariantProps<typeof toggleVariants>) {
  const context = React.useContext(ToggleGroupContext)

  return (
    <ToggleGroupPrimitive.Item
      data-slot="toggle-group-item"
      data-variant={context.variant || variant}
      data-size={context.size || size}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        "min-w-0 flex-1 shrink-0 rounded-none shadow-none first:rounded-l-md last:rounded-r-md focus:z-10 focus-visible:z-10 data-[variant=outline]:border-l-0 data-[variant=outline]:first:border-l",
        className
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  )
}

export { ToggleGroup, ToggleGroupItem }
</file>

<file path="src/components/ui/toggle.tsx">
import * as React from "react"
import * as TogglePrimitive from "@radix-ui/react-toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "../../lib/utils"

const toggleVariants = cva(
  "inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent shadow-xs hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-9 px-2 min-w-9",
        sm: "h-8 px-1.5 min-w-8",
        lg: "h-10 px-2.5 min-w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Toggle({
  className,
  variant,
  size,
  ...props
}: React.ComponentProps<typeof TogglePrimitive.Root> &
  VariantProps<typeof toggleVariants>) {
  return (
    <TogglePrimitive.Root
      data-slot="toggle"
      className={cn(toggleVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Toggle, toggleVariants }
</file>

<file path="src/components/ui/tooltip.tsx">
import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "../../lib/utils"

function TooltipProvider({
  delayDuration = 0,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {
  return (
    <TooltipPrimitive.Provider
      data-slot="tooltip-provider"
      delayDuration={delayDuration}
      {...props}
    />
  )
}

function Tooltip({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Root>) {
  return (
    <TooltipProvider>
      <TooltipPrimitive.Root data-slot="tooltip" {...props} />
    </TooltipProvider>
  )
}

function TooltipTrigger({
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {
  return <TooltipPrimitive.Trigger data-slot="tooltip-trigger" {...props} />
}

function TooltipContent({
  className,
  sideOffset = 0,
  children,
  ...props
}: React.ComponentProps<typeof TooltipPrimitive.Content>) {
  return (
    <TooltipPrimitive.Portal>
      <TooltipPrimitive.Content
        data-slot="tooltip-content"
        sideOffset={sideOffset}
        className={cn(
          "bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",
          className
        )}
        {...props}
      >
        {children}
        <TooltipPrimitive.Arrow className="bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]" />
      </TooltipPrimitive.Content>
    </TooltipPrimitive.Portal>
  )
}

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }
</file>

<file path="src/context/__tests__/AuthContext.logic.test.ts">
import { describe, it, expect } from 'vitest'

describe('AuthContext Business Logic', () => {
  describe('Role-based Access Logic', () => {
    it('should identify admin roles correctly', () => {
      const adminRoles = ['admin', 'superadmin']
      const testCases = [
        { user: { role: { name: 'admin' } }, expected: true },
        { user: { role: { name: 'superadmin' } }, expected: true },
        { user: { role: { name: 'player' } }, expected: false },
        { user: { role: { name: 'user' } }, expected: false },
        { user: { role: { name: 'editor' } }, expected: false },
        { user: { role: { name: '' } }, expected: false },
        { user: { role: null }, expected: false },
        { user: null, expected: false }
      ]

      testCases.forEach(({ user, expected }) => {
        // Simulate the actual logic from AuthContext
        const isRoleIncluded = adminRoles.includes(user?.role?.name || '') || false
        expect(isRoleIncluded).toBe(expected)
      })
    })

    it('should handle case sensitivity in role checking', () => {
      const adminRoles = ['admin', 'superadmin']
      const testCases = [
        { user: { role: { name: 'ADMIN' } }, expected: false }, // Case sensitive
        { user: { role: { name: 'Admin' } }, expected: false },
        { user: { role: { name: 'admin' } }, expected: true },
        { user: { role: { name: 'SUPERADMIN' } }, expected: false },
        { user: { role: { name: 'superadmin' } }, expected: true }
      ]

      testCases.forEach(({ user, expected }) => {
        const isRoleIncluded = adminRoles.includes(user?.role?.name || '') || false
        expect(isRoleIncluded).toBe(expected)
      })
    })
  })

  describe('Authentication State Logic', () => {
    it('should determine authentication status correctly', () => {
      const testCases = [
        { user: { id: '1', name: 'John' }, expected: true },
        { user: { id: '2', email: 'test@test.com' }, expected: true },
        { user: null, expected: false },
        { user: undefined, expected: false }
      ]

      testCases.forEach(({ user, expected }) => {
        const isAuthenticated = !!user
        expect(isAuthenticated).toBe(expected)
      })
    })

    it('should handle user object validation', () => {
      const testCases = [
        { user: {}, expected: true }, // Empty object is truthy
        { user: { id: '' }, expected: true }, // Object with empty string is truthy
        { user: { id: null }, expected: true }, // Object with null property is truthy
        { user: false, expected: false },
        { user: 0, expected: false },
        { user: '', expected: false }
      ]

      testCases.forEach(({ user, expected }) => {
        const isAuthenticated = !!user
        expect(isAuthenticated).toBe(expected)
      })
    })
  })

  describe('Login Response Processing Logic', () => {
    it('should process login response correctly', () => {
      const mockResponse = {
        data: {
          userId: 'user-123',
          email: 'test@example.com',
          phoneNumber: '+1234567890',
          requiresOtp: true,
          otpType: 'EMAIL',
          role: 'admin',
          tokens: null
        }
      }

      const processedResponse = {
        userId: mockResponse.data.userId,
        hasEmail: !!mockResponse.data.email,
        hasPhone: !!mockResponse.data.phoneNumber,
        email: mockResponse.data.email,
        role: mockResponse.data.role,
        phoneNumber: mockResponse.data.phoneNumber,
        requiresOtp: mockResponse.data.requiresOtp,
        otpType: mockResponse.data.otpType,
        tokens: mockResponse.data.tokens,
        message: undefined
      }

      expect(processedResponse.hasEmail).toBe(true)
      expect(processedResponse.hasPhone).toBe(true)
      expect(processedResponse.requiresOtp).toBe(true)
      expect(processedResponse.userId).toBe('user-123')
      expect(processedResponse.role).toBe('admin')
    })

    it('should handle missing email/phone in response', () => {
      const mockResponse = {
        data: {
          userId: 'user-456',
          email: null,
          phoneNumber: '',
          requiresOtp: false,
          role: 'player',
          otpType: undefined,
          tokens: {
            accessToken: 'token123',
            refreshToken: 'refresh123'
          }
        }
      }

      const processedResponse = {
        userId: mockResponse.data.userId,
        hasEmail: !!mockResponse.data.email,
        hasPhone: !!mockResponse.data.phoneNumber,
        email: mockResponse.data.email,
        role: mockResponse.data.role,
        phoneNumber: mockResponse.data.phoneNumber,
        requiresOtp: mockResponse.data.requiresOtp,
        otpType: mockResponse.data.otpType,
        tokens: mockResponse.data.tokens,
        message: undefined
      }

      expect(processedResponse.hasEmail).toBe(false)
      expect(processedResponse.hasPhone).toBe(false)
      expect(processedResponse.requiresOtp).toBe(false)
      expect(processedResponse.tokens).toBeTruthy()
    })

    it('should handle different OTP types', () => {
      const otpTypes = ['EMAIL', 'SMS', 'BOTH']

      otpTypes.forEach(otpType => {
        const mockResponse = {
          data: {
            userId: 'user-789',
            requiresOtp: true,
            otpType: otpType
          }
        }

        const processedResponse = {
          requiresOtp: mockResponse.data.requiresOtp,
          otpType: mockResponse.data.otpType
        }

        expect(processedResponse.requiresOtp).toBe(true)
        expect(processedResponse.otpType).toBe(otpType)
      })
    })
  })

  describe('Token Management Logic', () => {
    it('should determine if tokens should be stored', () => {
      const testCases = [
        {
          tokens: { accessToken: 'token123', refreshToken: 'refresh123' },
          expected: true
        },
        {
          tokens: null,
          expected: false
        },
        {
          tokens: undefined,
          expected: false
        },
        {
          tokens: { accessToken: '', refreshToken: '' },
          expected: true // Truthy object, even with empty strings
        }
      ]

      testCases.forEach(({ tokens, expected }) => {
        const shouldStoreTokens = !!tokens
        expect(shouldStoreTokens).toBe(expected)
      })
    })

    it('should validate token structure', () => {
      const validTokens = {
        accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...',
        refreshToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
      }

      const invalidTokens = [
        { accessToken: 'token123' }, // Missing refreshToken
        { refreshToken: 'refresh123' }, // Missing accessToken
        {}, // Empty object
        { accessToken: null, refreshToken: null }
      ]

      // Valid tokens
      expect(validTokens.accessToken).toBeTruthy()
      expect(validTokens.refreshToken).toBeTruthy()

      // Invalid tokens
      invalidTokens.forEach(tokens => {
        const hasValidStructure = tokens.accessToken && tokens.refreshToken
        expect(hasValidStructure).toBeFalsy()
      })
    })
  })

  describe('User Data Validation Logic', () => {
    it('should validate user data structure', () => {
      const validUser = {
        id: 'user-123',
        email: 'test@example.com',
        role: { name: 'admin' },
        profile: { firstName: 'John', lastName: 'Doe' }
      }

      const invalidUsers = [
        null,
        undefined,
        {},
        { id: null },
        { email: '' },
        { role: null }
      ]

      // Valid user
      expect(validUser.id).toBeTruthy()
      expect(validUser.email).toBeTruthy()
      expect(validUser.role?.name).toBeTruthy()

      // Invalid users
      invalidUsers.forEach(user => {
        const isValidUser = user && (user as any).id && (user as any).email
        expect(isValidUser).toBeFalsy()
      })
    })

    it('should handle role object structure', () => {
      const testCases = [
        { user: { role: { name: 'admin' } }, expected: 'admin' },
        { user: { role: { name: 'player' } }, expected: 'player' },
        { user: { role: null }, expected: undefined },
        { user: { role: undefined }, expected: undefined },
        { user: {}, expected: undefined }
      ]

      testCases.forEach(({ user, expected }) => {
        const roleName = user.role?.name
        expect(roleName).toBe(expected)
      })
    })
  })

  describe('Error Handling Logic', () => {
    it('should handle authentication errors correctly', () => {
      const errorScenarios = [
        { error: { status: 401 }, shouldClearTokens: true },
        { error: { status: 403 }, shouldClearTokens: true },
        { error: { status: 500 }, shouldClearTokens: false },
        { error: { message: 'Network Error' }, shouldClearTokens: false }
      ]

      errorScenarios.forEach(({ error, shouldClearTokens }) => {
        // Simulate error handling logic
        const isAuthError = error.status === 401 || error.status === 403
        expect(isAuthError).toBe(shouldClearTokens)
      })
    })

    it('should determine when to clear user state', () => {
      const scenarios = [
        { hasToken: false, shouldClearUser: true },
        { hasToken: true, apiError: true, shouldClearUser: true },
        { hasToken: true, apiError: false, shouldClearUser: false }
      ]

      scenarios.forEach(({ hasToken, apiError, shouldClearUser }) => {
        const shouldClear = !hasToken || apiError
        expect(shouldClear).toBe(shouldClearUser)
      })
    })
  })
})
</file>

<file path="src/context/AuthContext.tsx">
import { createContext, useContext, useState, useEffect, useRef } from 'react';
import type { ReactNode } from 'react';
import { backendService } from '../backend/api.service';
import type { User, LoginCredentials } from '../backend/types';
import { toast } from 'sonner';
import { useQueryClient } from '@tanstack/react-query';
import { BackendRoute } from '../backend/constants';
import { sendHeartbeat } from '../backend/user.service';

interface LoginResponse {
  userId: string;
  hasEmail: boolean;
  hasPhone: boolean;
  email?: string;
  phoneNumber?: string;
  requiresOtp: boolean;
  role: string;
  otpType?: 'EMAIL' | 'SMS' | 'BOTH';
  message: string;
  tokens?: {
    accessToken: string;
    refreshToken: string;
  };
}

interface AuthContextType {
  user: User | null;
  isAuthenticated: boolean;
  isAdmin: boolean;
  isLoading: boolean;
  keepPlayingRedirect: boolean;
  setKeepPlayingRedirect: (value: boolean) => void;
  login: (credentials: LoginCredentials) => Promise<LoginResponse>;
  verifyOtp: (userId: string, otp: string) => Promise<User>;
  logout: () => void;
  refreshUser: () => Promise<User>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const AuthProvider = ({ children }: { children: ReactNode }) => {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [keepPlayingRedirect, setKeepPlayingRedirect] = useState(false);
  const queryClient = useQueryClient();
  const heartbeatIntervalRef = useRef<NodeJS.Timeout | null>(null);

  useEffect(() => {
    const token = localStorage.getItem('token');
    if (token) {
      refreshUser().catch(() => {
        localStorage.removeItem('token');
        localStorage.removeItem('refreshToken');
        setIsLoading(false);
      });
    } else {
      setIsLoading(false);
    }
  }, []);

  // Heartbeat effect - runs when user authentication status changes
  useEffect(() => {
    if (user && !isLoading) {
      // Start heartbeat interval when user is authenticated
      const startHeartbeat = () => {
        // Send initial heartbeat
        sendHeartbeat().catch(console.error);

        // Set up interval to send heartbeat every 60 seconds
        heartbeatIntervalRef.current = setInterval(() => {
          sendHeartbeat().catch(console.error);
        }, 60 * 1000); // 60 seconds
      };

      startHeartbeat();

      // Also send heartbeat on page visibility change (when user comes back to tab)
      const handleVisibilityChange = () => {
        if (!document.hidden && user) {
          sendHeartbeat().catch(console.error);
        }
      };

      document.addEventListener('visibilitychange', handleVisibilityChange);

      return () => {
        // Cleanup interval and event listener
        if (heartbeatIntervalRef.current) {
          clearInterval(heartbeatIntervalRef.current);
          heartbeatIntervalRef.current = null;
        }
        document.removeEventListener('visibilitychange', handleVisibilityChange);
      };
    } else {
      // Clear heartbeat when user is not authenticated
      if (heartbeatIntervalRef.current) {
        clearInterval(heartbeatIntervalRef.current);
        heartbeatIntervalRef.current = null;
      }
    }
  }, [user, isLoading]);

  const refreshUser = async (): Promise<User> => {
    try {
      setIsLoading(true);
      const userData = await backendService.get('/api/auth/me');
      setUser(userData.data as unknown as User);
      setIsLoading(false);
      return userData as unknown as User;
    } catch (error) {
      // Token might be invalid, clear tokens
      localStorage.removeItem('token');
      localStorage.removeItem('refreshToken');
      setUser(null);
      setIsLoading(false);
      throw error;
    }
  };

  const login = async (credentials: LoginCredentials): Promise<LoginResponse> => {
    const response = await backendService.post('/api/auth/login', credentials);
    const {
      userId,
      email,
      phoneNumber,
      requiresOtp,
      otpType,
      tokens,
      role
    } = response.data;


    //forto display mesage from backend
    const message = (response as any)?.message

    // If tokens are provided (no OTP case), save them and refresh user
    if (tokens) {
      localStorage.setItem('token', tokens.accessToken);
      localStorage.setItem('refreshToken', tokens.refreshToken);
      await refreshUser();
      // Invalidate stats to trigger a refetch
      queryClient.invalidateQueries({ queryKey: [BackendRoute.USER_STATS] });
    }

    return {
      userId,
      hasEmail: !!email,
      hasPhone: !!phoneNumber,
      email,
      role,
      phoneNumber,
      requiresOtp,
      otpType,
      tokens,
      message
    };
  };

  const verifyOtp = async (userId: string, otp: string): Promise<User> => {
    const response = await backendService.post('/api/auth/verify-otp', { userId, otp });
    const { accessToken, refreshToken } = response.data;
    localStorage.setItem('token', accessToken);
    localStorage.setItem('refreshToken', refreshToken);
    const userData = await refreshUser();
    // Invalidate stats to trigger a refetch
    queryClient.invalidateQueries({ queryKey: [BackendRoute.USER_STATS] });
    return userData;
  };

  const logout = () => {
    // Clear heartbeat interval on logout
    if (heartbeatIntervalRef.current) {
      clearInterval(heartbeatIntervalRef.current);
      heartbeatIntervalRef.current = null;
    }

    localStorage.removeItem('token');
    localStorage.removeItem('refreshToken');
    setUser(null);
    toast.success('Logged out successfully');
  };

  const isRoleIncluded = ['admin', 'superadmin'].includes(user?.role.name || '') || false;

  return (
    <AuthContext.Provider
      value={{
        user,
        isAuthenticated: !!user,
        isAdmin: isRoleIncluded,
        isLoading,
        keepPlayingRedirect,
        setKeepPlayingRedirect,
        login,
        verifyOtp,
        logout,
        refreshUser
      }}
    >
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
};
</file>

<file path="src/hooks/useHeartbeat.ts">
import { useEffect, useRef } from 'react';
import { useAuth } from '../context/AuthContext';
import { sendHeartbeat } from '../backend/user.service';


export const useHeartbeat = () => {
  const { isAuthenticated } = useAuth();
  const intervalRef = useRef<NodeJS.Timeout | null>(null);

  const sendManualHeartbeat = async () => {
    if (isAuthenticated) {
      try {
        await sendHeartbeat();
        return true;
      } catch (error) {
        console.error('Failed to send manual heartbeat:', error);
        return false;
      }
    }
    return false;
  };

  const startHeartbeat = (intervalMs: number = 60000) => {
    if (!isAuthenticated) return;
    stopHeartbeat();
    sendManualHeartbeat();
    intervalRef.current = setInterval(() => {
      sendManualHeartbeat();
    }, intervalMs);
  };


  const stopHeartbeat = () => {
    if (intervalRef.current) {
      clearInterval(intervalRef.current);
      intervalRef.current = null;
    }
  };

  // Cleanup on unmount
  useEffect(() => {
    return () => {
      stopHeartbeat();
    };
  }, []);

  return {
    sendManualHeartbeat,
    startHeartbeat,
    stopHeartbeat,
    isActive: !!intervalRef.current
  };
};
</file>

<file path="src/layout/AdminLayout.tsx">
import React, { useState, useEffect } from "react";
import { Outlet, useLocation } from "react-router-dom";
import AdminNavbar from "../components/single/AdminNavbar";
import { NavLink } from "react-router-dom";
import { IoGameControllerOutline } from "react-icons/io5";
import { FiHome } from "react-icons/fi";
import { MdOutlineCategory } from "react-icons/md";
import { FaRegUser } from "react-icons/fa6";
import { FaChartLine } from "react-icons/fa";
import { SlEqualizer } from "react-icons/sl";
import { RiTeamLine } from "react-icons/ri";
import { IoChevronBackOutline, IoChevronForwardOutline } from "react-icons/io5";



const menuItems = [
  {
    title: "Home",
    icon: <FiHome size={20} />,
    path: "/admin"
},
  {
    title: "Game Management",
    icon: <IoGameControllerOutline size={20} />,
    path: "/admin/game-management",
  },
  {
    title: "Game Category",
    icon: <MdOutlineCategory size={20} />,
    path: "/admin/categories",
  },
  { title: "User Management",
    icon: <FaRegUser size={20} />,
    path: "/admin/management"
},
  { title: "Team Management",
    icon: <RiTeamLine size={20} />,
    path: "/admin/team"
},
  {
    title: "Analytics",
    icon: <FaChartLine size={20} />,
    path: "/admin/analytics",
  },
  {
    title: "Configuration",
    icon: <SlEqualizer size={20} />,
    path: "/admin/config",
  },
];

const AdminLayout: React.FC = () => {
  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false);
  const location = useLocation();

  const toggleSidebar = () => {
    setIsSidebarCollapsed(!isSidebarCollapsed);
  };

  // Check if current route is admin route and manage cursor override
  useEffect(() => {
    const isAdminRoute = location.pathname.startsWith('/admin');

    if (isAdminRoute) {
      document.body.classList.add('admin-route');
    } else {
      document.body.classList.remove('admin-route');
    }

    // Cleanup function to remove class when component unmounts
    return () => {
      document.body.classList.remove('admin-route');
    };
  }, [location.pathname]);

  return (
    <div className="admin-layout min-h-screen bg-white dark:bg-[#0f1221] text-gray-900 dark:text-white transition-colors duration-300">
      {/* Fixed header */}
      <div className="fixed top-0 left-0 right-0 z-50">
        <AdminNavbar />
      </div>

      <div className="flex pt-[73px]"> {/* Add padding-top to account for fixed header */}
        {/* Fixed sidebar with overlay on mobile */}
        <div className={`fixed h-[calc(100vh-73px)] z-30 transition-all duration-300 transform ${
          isSidebarCollapsed
            ? '-translate-x-full lg:translate-x-0 w-16'
            : 'translate-x-0 w-60'
        }`}>
          <aside className="h-full bg-white/95 dark:bg-[#0f1221]/95 backdrop-blur-sm transition-colors duration-300">
            <div className="flex flex-col h-full relative">
              <nav className="flex-1">
                <ul className="space-y-5 px-2 py-4">
                  {menuItems.map((item, index) => (
                    <li key={index}>
                      <NavLink
                        to={item.path}
                        end={item.path === "/admin"}
                        className={({ isActive }) =>
                          `flex items-center p-2 rounded-lg transition-colors ${
                            isActive
                              ? "bg-[#D946EF] text-white"
                              : "hover:text-[#D946EF] hover:bg-[#F3E8FF] dark:text-white dark:hover:text-[#D946EF] text-[#121C2D]"
                          } ${isSidebarCollapsed ? 'justify-center' : ''}`
                        }
                      >
                        <span className={isSidebarCollapsed ? '' : 'mr-3'}>{item.icon}</span>
                        {!isSidebarCollapsed && <span className="text-xl">{item.title}</span>}
                      </NavLink>
                    </li>
                  ))}
                </ul>
              </nav>
              {/* Collapse toggle button */}
              <div className="border-t border-gray-200 dark:border-gray-800 p-4">
                <button
                  onClick={toggleSidebar}
                  className="absolute -right-4 bg-[#D946EF] dark:bg-[#D946EF] rounded-full p-1.5 text-white hover:bg-[#c026d3] dark:hover:bg-[#c026d3] shadow-lg transition-all duration-300"
                  style={{ bottom: '20px' }}
                >
                  {isSidebarCollapsed ?
                    <IoChevronForwardOutline size={18} /> :
                    <IoChevronBackOutline size={18} />
                  }
                </button>
              </div>
            </div>
          </aside>
        </div>

        {/* Main content with responsive margins */}
        <main
          className={`flex-1 transition-all duration-300 ${isSidebarCollapsed ? 'lg:ml-16' : 'ml-0 lg:ml-60'} bg-white dark:bg-[#0f1221] min-h-[calc(100vh-73px)] overflow-y-auto relative`}
          onClick={() => {
            if (!isSidebarCollapsed && window.innerWidth < 1024) {
              setIsSidebarCollapsed(true);
            }
          }}
        >
          <div className="p-6">
            <Outlet />
          </div>
        </main>
      </div>
    </div>
  );
};

export default AdminLayout;
</file>

<file path="src/layout/MainLayout.tsx">
import React from 'react';
import { Outlet, useLocation } from 'react-router-dom';
import Navbar from '../components/single/Navbar';

const MainLayout: React.FC = () => {
    const location = useLocation();
    const isGamePlay = location.pathname.includes('/gameplay/');
    return (
        <div className="min-h-screen bg-gray-900 text-white dark:bg-gray-100 dark:text-gray-900 transition-colors duration-300">
            <Navbar />
            <main className=" bg-white dark:bg-[#0f1221]">
                <Outlet />
            </main>
            {!isGamePlay && (
                <footer className="text-center text-white dark:white py-4 md:py-6 lg:py-8 bg-[#1E0420] dark:bg-[#1E0420] w-full">
                <div className='w-[90%] md:w-[85%] lg:w-[800px] mx-auto px-4 md:px-6'>
                    <p className='font-boogaloo mb-3 text-[11px] sm:text-xs md:text-sm'>These games are brought to you by Chareli, a web-based gaming platform.</p>

                    <p className='font-pincuk text-xl tracking-wider sm:text-sm mt-3 mb-3 leading-relaxed'>By using this service, you agree to the Chareli <span className='text-[#C026D3] underline cursor-pointer hover:text-[#db2ee8] transition-colors'>Terms of Service</span>. Chareli's <span className='text-[#C026D3] underline cursor-pointer hover:text-[#db2ee8] transition-colors'>Privacy Policy</span> sets out how we handle your data.
                    </p>

                    <p className='font-pincuk text-xl tracking-wider sm:text-sm leading-relaxed'>Chareli uses cookies to deliver and enhance the quality of its services, to analyze traffic, and to personalize the content that you see. Chareli uses analytics services to serve the content that you see. You can opt out of content personalization at
                        <span className='text-[#C026D3] underline cursor-pointer hover:text-[#db2ee8] transition-colors ml-1'>Personalization settings & cookies</span>. You can opt out of ads personalization with <span className='text-[#C026D3] underline cursor-pointer hover:text-[#db2ee8] transition-colors'>ad settings</span>. Note that this setting also affects ads personalization on other sites and apps that partner with Chareli. </p>
                </div>
                </footer>
            )}
        </div>
    );
};

export default MainLayout;
</file>

<file path="src/lib/utils.ts">
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
</file>

<file path="src/pages/About/About.tsx">
import { Button } from "../../components/ui/button";

const About: React.FC = () => {
  return (
    <div className="min-h-screen flex flex-col">
      <div className="flex-grow space-y-8 mx-auto pl-24 pr-24 pt-10 mb-32">

        <section className="bg-[#1E0420] p-6 rounded-lg dark:bg-[#1E0420] w-full">
          <h1 className="text-6xl font-bold text-white dark:text-gray-100 text-center font-boogaloo">About us</h1>
          <p className="mt-4 text-gray-300 dark:text-gray-300 text-center font-pincuk text-xl tracking-wider">
            Chareli is a web-based platform designed for users to discover and play simple HTML5 games, including card games, solitaire, and puzzle games. Our platform embeds each game with an intuitive interface that allows users to browse available games and play them instantly in their browser without any downloads. With a fully responsive design, Chareli ensures a seamless gaming experience across desktops, tablets, and mobile devices.
          </p>
        </section>

        <section className="bg-[#1E0420] p-6 rounded-lg dark:bg-[#1E0420] w-full">
          <h1 className="text-6xl font-bold text-white dark:text-gray-100 text-center font-boogaloo">Our Mission</h1>
          <p className="mt-4 text-gray-300 dark:text-gray-300 text-center font-pincuk text-xl tracking-wider">
            At Chareli, we believe gaming should be accessible, fun, and hassle-free. Our platform brings the joy of HTML5 games directly to your browser, no downloads required. Founded in 2025, our team of passionate gamers and developers work together to curate the best collection of browser games across various categories  from action-packed adventures to brain-teasing puzzles.
          </p>
        </section>

        <div className="flex justify-center">
          <Button className="bg-[#C026D3] border border-[#C026D3] text-white text-lg text-center">
            Join our Community
          </Button>
        </div>

      </div>
    </div>
  );
};

export default About;
</file>

<file path="src/pages/Admin/About/About.tsx">
// import React from 'react'

export default function About() {
  return (
    <div>About</div>
  )
}
</file>

<file path="src/pages/Admin/Analytics/Analytics.tsx">
import { DonutChart } from "../../../components/charts/donutChart";
import { Card } from "../../../components/ui/card";
import usersLine from "../../../assets/users-line.svg"
import HorizontalBarChart from "../../../components/charts/barChart";
import click from '../../../assets/click.svg'
import UserActivityLog from "./UserActivityLog";
import GameActivity from "./GameActivity";
import UserAgeBarChart from "../../../components/charts/barChart II";
import { useDashboardAnalytics } from "../../../backend/analytics.service";

export default function Analytics() {
  const { data: dashboardData } = useDashboardAnalytics();

  console.log('Dashboard Data:', dashboardData);
  const adultsCount = dashboardData?.adultsCount ?? 0;
  const minorsCount = dashboardData?.minorsCount ?? 0;
  const totalRegistered = adultsCount + minorsCount;
  console.log('Age Counts:', { adultsCount, minorsCount, totalRegistered });
  return (
    <div>
      {/* donut chart */}
       <div className="col-span-1 md:col-span-2 lg:col-span-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="justify-between items-center flex p-3">
            <p className="text-3xl">Registration insights</p>
          </div>
          {/* inner card */}
          <Card className="bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none mx-3 p-4">
            <div className="flex flex-col space-y-8">

              <div className="">
              <div className="justify-start flex items-center gap-4">
              <img src={usersLine} alt="users" className="w-10 h-10 dark:text-white" />
              <p className="text-lg text-[#64748A] dark:text-white">Total number of registered users</p>
              </div>

              <DonutChart />
              </div>
            </div>
          </Card>
        </Card>
      </div>
      {/* bar chart */}
       <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="justify-between items-center flex p-3">
            <p className="text-3xl">Click insights</p>
          </div>
          {/* inner card */}
          <Card className="bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none mx-3 p-4">
            <div className="flex flex-col space-y-8">

              <div className="">
              <div className="justify-start flex items-center gap-4">
              <img src={click} alt="users" className="w-10 h-10 dark:text-white" />
              <p className="text-lg text-[#64748A] dark:text-white">Total clicks on Sign-up form</p>
              </div>

              <HorizontalBarChart/>
              </div>
            </div>
          </Card>
        </Card>
      </div>

      {/* bar chart for user age */}
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="justify-between items-center flex p-3">
            <p className="text-3xl">User Age</p>
          </div>
          {/* inner card */}
          <Card className="bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none mx-3 p-4">
            <div className="flex flex-col space-y-8">

              <div className="">
              <div className="justify-start flex items-center gap-4">
              <div className="flex gap-4 items-center">
              <p className="font-bold text-3xl">{totalRegistered}</p>
              <p className="text-lg text-[#64748A] dark:text-white">Total registered users</p>
              </div>
              </div>

              <UserAgeBarChart
                adultsCount={adultsCount}
                minorsCount={minorsCount}
              />
              </div>
            </div>
          </Card>
        </Card>
      </div>


      <UserActivityLog />
      <GameActivity />
    </div>
  )
}
</file>

<file path="src/pages/Admin/Analytics/GameActivity.tsx">
import { useState } from "react";
import { Card } from "../../../components/ui/card";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "../../../components/ui/table";
import { FaChevronUp, FaChevronDown } from "react-icons/fa6";
import { RiGamepadLine } from "react-icons/ri";
import { useGamesWithPopularity } from "../../../backend/analytics.service";
import { NoResults } from "../../../components/single/NoResults";
import GameThumbnail from "./GameThumbnail";

export default function GameActivity() {
  const { data: gamesAnalytics, isError, isLoading } = useGamesWithPopularity();

  const gamesPerPage = 10;
  const [gamePage, setGamePage] = useState(1);

  if (isLoading) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full pl-4">
          <div className="justify-between items-center flex p-3">
            <p className="text-3xl">Game Activity</p>
          </div>
          <Table>
            <TableHeader>
              <TableRow className="text-lg font-bold">
                <TableHead>Game</TableHead>
                <TableHead>Total Plays</TableHead>
                <TableHead>Average Play Time</TableHead>
                <TableHead>Game Status</TableHead>
                <TableHead>Popularity</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              <TableRow>
                <TableCell colSpan={5} className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]">
                  <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF] mx-auto"></div>
                </TableCell>
              </TableRow>
            </TableBody>
          </Table>
        </Card>
      </div>
    );
  }

  if (isError) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full pl-4">
          <div className="justify-between items-center flex p-3">
            <p className="text-3xl">Game Activity</p>
          </div>
          <Table>
            <TableHeader>
              <TableRow className="text-lg font-bold">
                <TableHead>Game</TableHead>
                <TableHead>Total Plays</TableHead>
                <TableHead>Average Play Time</TableHead>
                <TableHead>Game Status</TableHead>
                <TableHead>Popularity</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
              <TableRow>
                <TableCell colSpan={5} className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]">
                  <div className="text-red-500">Error loading game activity data</div>
                </TableCell>
              </TableRow>
            </TableBody>
          </Table>
        </Card>
      </div>
    );
  }

  const allGames = gamesAnalytics?.data || [];
  const totalGamePages = Math.ceil(allGames.length / gamesPerPage);
  const startIdx = (gamePage - 1) * gamesPerPage;
  const endIdx = startIdx + gamesPerPage;
  const gamesToShow = allGames.slice(startIdx, endIdx);

  return (
    <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
      <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full pl-4">
        <div className="justify-between items-center flex p-3">
          <p className="text-3xl">Game Activity</p>
        </div>
        <Table>
          <TableHeader>
            <TableRow className="text-lg font-bold">
              <TableHead>Game</TableHead>
              <TableHead>Total Plays</TableHead>
              <TableHead>Average Play Time</TableHead>
              <TableHead>Game Status</TableHead>
              <TableHead>Popularity</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
          {!gamesToShow.length ? (
            <TableRow>
              <TableCell colSpan={5} className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]">
                <NoResults
                  title="No game activity"
                  message="There are no game activity records to display at this time."
                  icon={<RiGamepadLine className="w-12 h-12 text-gray-400" />}
                />
              </TableCell>
            </TableRow>
          ) : gamesToShow.map((game: any) => (
              <TableRow key={game.id} className="font-pincuk text-xl tracking-wider">
                <TableCell>
                  <div className="flex items-center gap-3">
                    <GameThumbnail src={game.thumbnailUrl} alt={game.title} />
                    <span className="font-bold">{game.title}</span>
                  </div>
                </TableCell>
                <TableCell>{game.metrics.totalPlays}</TableCell>
                <TableCell>{game.metrics.averagePlayTime} min</TableCell>
                <TableCell>
                  {game.status === "active" ? (
                    <span className="inline-flex items-center gap-2 p-1 rounded bg-[#419E6A] text-white font-pincuk text-xl tracking-wider">
                      <span className="w-2 h-2 bg-white rounded-full inline-block"></span>
                      Active
                    </span>
                  ) : (
                    <span className="inline-flex items-center gap-2 p-1 rounded bg-[#CBD5E0] text-[#22223B] font-pincuk text-xl tracking-wider">
                      <span className="w-2 h-2 bg-red-500 rounded-full inline-block"></span>
                      Inactive
                    </span>
                  )}
                </TableCell>
                <TableCell>
                  {game.metrics.popularity === "up" ? (
                    <span className="text-green-500 text-2xl"><FaChevronUp /></span>
                  ) : (
                    <span className="text-red-500 text-2xl"><FaChevronDown /></span>
                  )}
                </TableCell>
              </TableRow>
            ))}
          </TableBody>
        </Table>
        {gamesToShow.length > 0 && (
          <div className="flex justify-between items-center mt-4 pr-4">
            <span className="text-sm">
              Showing {startIdx + 1}-{Math.min(endIdx, allGames.length)} from {allGames.length} data
            </span>
            <div className="flex items-center gap-2 rounded-xl space-x-4 pr-1 pl-0.5 border border-[#D946EF] dark:text-white">
              {Array.from({ length: totalGamePages }, (_, i) => (
                <button
                  key={i + 1}
                  className={`w-7 h-7 rounded-full ${gamePage === i + 1 ? "bg-[#D946EF] text-white dark:bg-gray-400" : "bg-transparent text-[#D946EF] dark:text-gray-400 hover:bg-[#f3e8ff]"}`}
                  onClick={() => setGamePage(i + 1)}
                >
                  {i + 1}
                </button>
              ))}
            </div>
          </div>
        )}
      </Card>
    </div>
  );
}
</file>

<file path="src/pages/Admin/Analytics/GameThumbnail.tsx">
import { useState } from "react";

interface GameThumbnailProps {
  src: string;
  alt: string;
}

export default function GameThumbnail({ src, alt }: GameThumbnailProps) {
  const [hasError, setHasError] = useState(false);

  const fallbackImage = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='3' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Ccircle cx='8.5' cy='8.5' r='1.5'%3E%3C/circle%3E%3Cpolyline points='21 15 16 10 5 21'%3E%3C/polyline%3E%3C/svg%3E";

  return (
    <img
      src={hasError ? fallbackImage : src}
      alt={alt}
      className="w-12 h-12 rounded-lg object-cover bg-gray-100"
      onError={() => setHasError(true)}
    />
  );
}
</file>

<file path="src/pages/Admin/Analytics/UserActivityLog.tsx">
import { useState } from "react";
// import { Button } from "../../../components/ui/button";
import { Card } from "../../../components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "../../../components/ui/table";
import { NoResults } from "../../../components/single/NoResults";
import { FiActivity } from "react-icons/fi";
import { useUserActivityLog } from "../../../backend/analytics.service";
import ActivityLogExportModal from "../../../components/modals/AdminModals/ActivityLogExportModal";

export default function UserActivityLog() {
  const { data: activities, isLoading, error } = useUserActivityLog();
  const activitiesPerPage = 5;
  const [activityPage, setActivityPage] = useState(1);

  if (isLoading) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="p-4">Loading user activity data...</div>
        </Card>
      </div>
    );
  }

  if (error) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="p-4 text-red-500">
            Error loading user activity data
          </div>
        </Card>
      </div>
    );
  }

  const allActivities = activities || [];
  const totalActivityPages = Math.ceil(
    allActivities.length / activitiesPerPage
  );
  const startIdx = (activityPage - 1) * activitiesPerPage;
  const endIdx = startIdx + activitiesPerPage;
  const activitiesToShow = allActivities.slice(startIdx, endIdx);

  const formatTime = (timestamp: Date) => {
    return new Date(timestamp).toLocaleTimeString("en-US", {
      hour: "2-digit",
      minute: "2-digit",
      hour12: false,
    });
  };

  return (
    <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
      <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
        <div className="flex justify-between items-center p-4">
          <p className="text-3xl dark:text-[#D946EF]">User Activity Log</p>
          <div className="flex gap-3">
            {/* <Button
              variant="outline"
              className="border-[#475568] text-[#475568] flex items-center gap-2 dark:text-white py-2"
            >
              Filter
              <RiEqualizer2Line size={32} />
            </Button> */}
            <ActivityLogExportModal
              data={allActivities}
              title="Export Activity Log"
              description="Choose the format you'd like to export your activity log data"
            />
          </div>
        </div>
        <div className="px-4 pb-4">
          <Table>
            <TableHeader>
              <TableRow className="text-lg font-bold">
                <TableHead>Name</TableHead>
                <TableHead>User Status</TableHead>
                <TableHead>Activity</TableHead>
                <TableHead>Last Game Played</TableHead>
                <TableHead>Start Time</TableHead>
                <TableHead>End Time</TableHead>
              </TableRow>
            </TableHeader>
            <TableBody>
            {!activitiesToShow.length ? (
              <TableRow>
                <TableCell colSpan={6} className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]">
                  <NoResults
                    title="No activity logs"
                    message="There are no user activity records to display at this time."
                    icon={<FiActivity className="w-12 h-12 text-gray-400" />}
                  />
                </TableCell>
              </TableRow>
            ) : activitiesToShow.map((row: any, idx) => (
                <TableRow key={idx} className="font-pincuk text-xl tracking-wider">
                  <TableCell>{row.name?.trim() ? row.name : "-"}</TableCell>
                  <TableCell>
                    <span
                      className={`flex items-center gap-3 px-2 py-1 rounded-lg font-pincuk text-xl tracking-wider ${
                        row.userStatus === "Online"
                          ? "bg-[#4BA366] text-white"
                          : "bg-[#D3D8DF] text-white"
                      }`}
                      style={{ width: "75px", justifyContent: "center" }}
                    >
                      <div
                        className={`min-w-[8px] min-h-[8px] rounded-full ${
                          row.userStatus === "Online"
                            ? "bg-white"
                            : "bg-[#E74C3C]"
                        }`}
                        style={{ aspectRatio: '1/1' }}
                      />
                      {row.userStatus || "Offline"}
                    </span>
                  </TableCell>
                  <TableCell>{row.activity || "-"}</TableCell>
                  <TableCell>{row.lastGamePlayed || "-"}</TableCell>
                  <TableCell>
                    {row.startTime ? (
                      <span className="flex items-center gap-2 bg-[#AEB8C6] rounded-lg px-2 py-1 w-fit font-pincuk text-xl tracking-wider text-white">
                        <div
                          className="min-w-[8px] min-h-[8px] rounded-full bg-[#2ECC40]"
                          style={{ aspectRatio: '1/1' }}
                        />
                        {formatTime(row.startTime)}
                      </span>
                    ) : "-"}
                  </TableCell>
                  <TableCell>
                    {row.endTime ? (
                      <span className="flex items-center gap-2 bg-[#AEB8C6] rounded-lg px-2 py-1 w-fit font-pincuk text-xl tracking-wider text-white">
                        <div
                          className="min-w-[8px] min-h-[8px] rounded-full bg-[#E74C3C]"
                          style={{ aspectRatio: '1/1' }}
                        />
                        {formatTime(row.endTime)}
                      </span>
                    ) : "-"}
                  </TableCell>
                </TableRow>
              ))}
            </TableBody>
          </Table>
          {activitiesToShow.length > 0 && (
            <div className="flex justify-between items-center mt-4">
              <span className="text-sm">
                Showing {startIdx + 1}-{Math.min(endIdx, allActivities.length)} from {allActivities.length} data
              </span>
              <div className="flex items-center rounded-xl pr-1 pl-0.5 border border-[#D946EF] dark:text-white">
                {Array.from({ length: totalActivityPages }, (_, i) => (
                  <button
                    key={i + 1}
                    className={`w-7 h-7 rounded-full ${
                      activityPage === i + 1 ? "bg-[#D946EF] dark:text-white" : ""
                    } text-black dark:text-white`}
                    onClick={() => setActivityPage(i + 1)}
                  >
                    {i + 1}
                  </button>
                ))}
              </div>
            </div>
          )}
          </div>
      </Card>
    </div>
  );
}
</file>

<file path="src/pages/Admin/Category/GameCategories.tsx">
import { FiTrash2 } from "react-icons/fi";
import { CiEdit } from "react-icons/ci";
import { useState } from "react";
import CreateCategory from "../../../components/single/CreateCategory-Sheet";
import { EditCategory } from "../../../components/single/EditCategory-Sheet";
import { useCategories, useDeleteCategory } from "../../../backend/category.service";
import { useGames } from "../../../backend/games.service";
import { DeleteConfirmationModal } from "../../../components/modals/DeleteConfirmationModal";
import { toast } from "sonner";

export default function GameCategories() {
  const [createOpen, setCreateOpen] = useState(false);
  const [editOpen, setEditOpen] = useState(false);
  const [selectedCategoryId, setSelectedCategoryId] = useState<string | null>(null);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const { data: categories, isLoading: loadingCategories } = useCategories();
  const { data: games, isLoading: loadingGames } = useGames();
  const { mutateAsync: deleteCategory, isPending: issDeletingCategory } = useDeleteCategory();
  const isLoading = loadingCategories || loadingGames;


  const handleDelete = async () => {
    if (!selectedCategoryId) return;
    try {
      await deleteCategory(selectedCategoryId);
      toast.success("Category deleted successfully");
      setShowDeleteModal(false);
      setSelectedCategoryId(null);
      setEditOpen(false);
    } catch (error: any) {
       console.log(error)
    }
  };

  return (
    <div className="p-8">
      <div className="flex justify-between items-center mb-8">
        <h1 className="text-3xl font-boogaloo text-[#D946EF]">Game category</h1>
        <button
          className="bg-[#D946EF] text-white px-3 py-3 rounded-lg text-lg tracking-wide hover:bg-[#D946EF] transition"
          onClick={() => setCreateOpen(true)}
        >
          Create New Category
        </button>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {isLoading ? (
          <div className="col-span-full text-center py-8">Loading...</div>
        ) : !categories?.length ? (
          <div className="col-span-full text-center py-12">
            <p className="text-xl font-boogaloo text-[#475568] dark:text-white mb-2">No categories found</p>
            <p className="text-sm text-[#475568] dark:text-white">Click "Create New Category" to add your first category</p>
          </div>
        ) : categories.map((cat) => (
          <div
            key={cat.name}
            className="bg-[#F1F5F9] rounded-2xl p-6 shadow flex flex-col gap-2 relative min-h-[120px] dark:bg-[#121C2D]"
          >
            <div className="flex justify-between items-start mb-2">
              <h2 className="text-xl tracking-wide font-bold font-boogaloo text-[#232B3B] dark:text-white">
                {cat.name}
              </h2>
              <div className="flex gap-2">
                <button className="p-1 rounded transition">
                  <CiEdit
                    className="dark:text-white w-5 h-5 text-black"
                    onClick={() => {
                      setSelectedCategoryId(cat.id);
                      setEditOpen(true);
                    }}
                  />
                </button>
                <button className="p-1 rounded transition">
                  <FiTrash2
                    className="text-black w-5 h-5 dark:text-white"
                    onClick={() => {
                      setSelectedCategoryId(cat.id);
                      setShowDeleteModal(true);
                    }}
                  />
                </button>
              </div>
            </div>
            <p className="text-[#475568] mb-2 font-pincuk text-xl tracking-wider dark:text-white">
              {cat.description || 'No description'}
            </p>
            <span className="text-[#D946EF] font-bold text-sm shadow-none tracking-wider">
              {(games as any)?.filter((game: any) => game.categoryId === cat.id).length || 0} games
            </span>
          </div>
        ))}
      </div>
      <DeleteConfirmationModal
        open={showDeleteModal}
        onOpenChange={setShowDeleteModal}
        onConfirm={handleDelete}
        isDeleting={issDeletingCategory}
        title="Are you sure you want to Delete Category?"
        description="This action cannot be reversed"
      />
      <CreateCategory open={createOpen} onOpenChange={setCreateOpen} />
      {editOpen && selectedCategoryId && (
        <EditCategory
          open={editOpen}
          onOpenChange={setEditOpen}
          categoryId={selectedCategoryId}
        />
      )}
    </div>
  );
}
</file>

<file path="src/pages/Admin/Configuration/Configuration.tsx">
import { useState, useEffect } from 'react';
import { Checkbox } from '../../../components/ui/checkbox';
import { Label } from '../../../components/ui/label';
import { useCreateSystemConfig, useSystemConfigByKey } from '../../../backend/configuration.service';
import { toast } from 'sonner';
import { Loader2 } from 'lucide-react';

interface AuthMethodSettings {
  enabled: boolean;
  firstName: boolean;
  lastName: boolean;
}

interface AuthSettings {
  email: AuthMethodSettings;
  sms: AuthMethodSettings;
  both: {
    enabled: boolean;
    otpDeliveryMethod: 'email' | 'sms' | 'none';
  };
}

export default function Configuration() {
  const [authSettings, setAuthSettings] = useState<AuthSettings>({
    email: {
      enabled: true,
      firstName: false,
      lastName: false
    },
    sms: {
      enabled: false,
      firstName: false,
      lastName: false
    },
    both: {
      enabled: false,
      otpDeliveryMethod: 'none'
    }
  });

  const [isSubmitting, setIsSubmitting] = useState(false);
  const { mutateAsync: createConfig } = useCreateSystemConfig();
  const { data: configData, isLoading: isLoadingConfig } = useSystemConfigByKey('authentication_settings');

  // Load initial configuration
  useEffect(() => {
    if (configData?.value?.settings) {
      setAuthSettings(configData.value.settings);
    }
  }, [configData]);

  const handleEmailAuth = (checked: boolean) => {
    setAuthSettings({
      email: {
        enabled: checked,
        firstName: false,
        lastName: false
      },
      sms: {
        enabled: false,
        firstName: false,
        lastName: false
      },
      both: {
        enabled: false,
        otpDeliveryMethod: 'none'
      }
    });
  };

  const handleSmsAuth = (checked: boolean) => {
    setAuthSettings({
      email: {
        enabled: false,
        firstName: false,
        lastName: false
      },
      sms: {
        enabled: checked,
        firstName: false,
        lastName: false
      },
      both: {
        enabled: false,
        otpDeliveryMethod: 'none'
      }
    });
  };

  const handleBoth = (checked: boolean) => {
    setAuthSettings({
      email: {
        enabled: false,
        firstName: false,
        lastName: false
      },
      sms: {
        enabled: false,
        firstName: false,
        lastName: false
      },
      both: {
        enabled: checked,
        otpDeliveryMethod: 'none'
      }
    });
  };

  const handleEmailFirstName = (checked: boolean) => {
    setAuthSettings(prev => ({
      ...prev,
      email: {
        ...prev.email,
        firstName: checked
      }
    }));
  };

  const handleEmailLastName = (checked: boolean) => {
    setAuthSettings(prev => ({
      ...prev,
      email: {
        ...prev.email,
        lastName: checked
      }
    }));
  };

  const handleSmsFirstName = (checked: boolean) => {
    setAuthSettings(prev => ({
      ...prev,
      sms: {
        ...prev.sms,
        firstName: checked
      }
    }));
  };

  const handleSmsLastName = (checked: boolean) => {
    setAuthSettings(prev => ({
      ...prev,
      sms: {
        ...prev.sms,
        lastName: checked
      }
    }));
  };

  const handleOtpDeliveryMethod = (method: 'email' | 'sms' | 'none') => {
    setAuthSettings(prev => ({
      ...prev,
      both: {
        ...prev.both,
        otpDeliveryMethod: method
      }
    }));
  };

  const handleSave = async () => {
    setIsSubmitting(true);
    try {
      await createConfig({
        key: 'authentication_settings',
        value: {
          settings: authSettings
        }
      });
      toast.success('Authentication settings saved successfully!');
    } catch (error) {
      toast.error('Failed to save authentication settings');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="p-4 bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 relative">
      {isLoadingConfig && (
        <div className="absolute inset-0 bg-white/50 dark:bg-gray-900/50 flex items-center justify-center">
          <Loader2 className="h-8 w-8 animate-spin text-purple-600" />
        </div>
      )}
      <h1 className="text-3xl text-[#D946EF] mb-4">User Sign Up Configuration</h1>
      <div className="space-y-4">
        {/* Email Authentication Section */}
        <div className="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <div className="flex items-center mb-2">
            <Checkbox
              checked={authSettings.email.enabled}
              onCheckedChange={handleEmailAuth}
              id="email-auth"
              color="#D946EF"
              disabled={authSettings.both.enabled}
            />
            <Label htmlFor="email-auth" className="ml-2 text-lg font-medium text-black dark:text-white">
              Email Authentication
            </Label>
          </div>
          <div className="ml-6 space-y-2">
            <div className="flex items-center">
              <Checkbox
                checked={authSettings.email.firstName}
                onCheckedChange={handleEmailFirstName}
                id="first-name-email"
                disabled={!authSettings.email.enabled || authSettings.both.enabled}
                color="#D946EF"
              />
              <Label htmlFor="first-name-email" className="ml-2 text-base">
                First Name
              </Label>
            </div>
            <div className="flex items-center">
              <Checkbox
                checked={authSettings.email.lastName}
                onCheckedChange={handleEmailLastName}
                id="last-name-email"
                disabled={!authSettings.email.enabled || authSettings.both.enabled}
                color="#D946EF"
              />
              <Label htmlFor="last-name-email" className="ml-2 text-base">
                Last Name
              </Label>
            </div>
          </div>
        </div>

        {/* SMS Authentication Section */}
        <div className="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <div className="flex items-center mb-2">
            <Checkbox
              checked={authSettings.sms.enabled}
              onCheckedChange={handleSmsAuth}
              id="sms-auth"
              color="#D946EF"
              disabled={authSettings.both.enabled}
            />
            <Label htmlFor="sms-auth" className="ml-2 text-lg font-medium text-black dark:text-white">
              SMS Authentication
            </Label>
          </div>
          <div className="ml-6 space-y-2">
            <div className="flex items-center">
              <Checkbox
                checked={authSettings.sms.firstName}
                onCheckedChange={handleSmsFirstName}
                id="first-name-sms"
                disabled={!authSettings.sms.enabled || authSettings.both.enabled}
                color="#D946EF"
              />
              <Label htmlFor="first-name-sms" className="ml-2 text-base">
                First Name
              </Label>
            </div>
            <div className="flex items-center">
              <Checkbox
                checked={authSettings.sms.lastName}
                onCheckedChange={handleSmsLastName}
                id="last-name-sms"
                disabled={!authSettings.sms.enabled || authSettings.both.enabled}
                color="#D946EF"
              />
              <Label htmlFor="last-name-sms" className="ml-2 text-base">
                Last Name
              </Label>
            </div>
          </div>
        </div>

        {/* Both Section */}
        <div className="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
          <div className="flex items-center mb-2">
            <Checkbox
              checked={authSettings.both.enabled}
              onCheckedChange={handleBoth}
              id="both"
              color="#D946EF"
            />
            <Label htmlFor="both" className="ml-2 text-lg font-medium text-black dark:text-white">
              Both
            </Label>
          </div>

          {/* OTP Delivery Method Selection */}
          {authSettings.both.enabled && (
            <div className="ml-6 mt-4">
              <Label className="text-base font-medium text-black dark:text-white mb-3 block">
                OTP Delivery Method:
              </Label>
              <div className="space-y-2">
                <div className="flex items-center">
                  <input
                    type="radio"
                    id="otp-email"
                    name="otpDeliveryMethod"
                    value="email"
                    checked={authSettings.both.otpDeliveryMethod === 'email'}
                    onChange={() => handleOtpDeliveryMethod('email')}
                    className="w-4 h-4 text-[#D946EF] bg-gray-100 border-gray-300 dark:bg-gray-700 dark:border-gray-600"
                  />
                  <Label htmlFor="otp-email" className="ml-2 text-base">
                    Email
                  </Label>
                </div>
                <div className="flex items-center">
                  <input
                    type="radio"
                    id="otp-sms"
                    name="otpDeliveryMethod"
                    value="sms"
                    checked={authSettings.both.otpDeliveryMethod === 'sms'}
                    onChange={() => handleOtpDeliveryMethod('sms')}
                    className="w-4 h-4 text-[#D946EF] bg-gray-100 border-gray-300 dark:bg-gray-700 dark:border-gray-600"
                  />
                  <Label htmlFor="otp-sms" className="ml-2 text-base">
                    SMS
                  </Label>
                </div>
                <div className="flex items-center">
                  <input
                    type="radio"
                    id="otp-none"
                    name="otpDeliveryMethod"
                    value="none"
                    checked={authSettings.both.otpDeliveryMethod === 'none'}
                    onChange={() => handleOtpDeliveryMethod('none')}
                    className="w-4 h-4 text-[#D946EF] bg-gray-100 border-gray-300 dark:bg-gray-700 dark:border-gray-600"
                  />
                  <Label htmlFor="otp-none" className="ml-2 text-base">
                    None (No OTP required)
                  </Label>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
      <div className="flex justify-end mt-4">
        <button
          className="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
          onClick={handleSave}
          disabled={isSubmitting || isLoadingConfig}
        >
          {isSubmitting ? (
            <>
              <Loader2 className="h-4 w-4 animate-spin" />
              Saving...
            </>
          ) : (
            'Save Configuration'
          )}
        </button>
      </div>
    </div>
  );
}
</file>

<file path="src/pages/Admin/Home/Home.tsx">
import click from '../../../assets/click.svg'
import { Card } from "../../../components/ui/card";
import { Button } from "../../../components/ui/button";
import { PopUpSheet } from "../../../components/single/PopUp-Sheet";
import { AcceptInvitationModal } from "../../../components/modals/AdminModals/AcceptInvitationModal";
import StatsCard from "./StatsCard";
import PieChart from '../../../components/charts/piechart';
import { useState } from 'react';
import { useSignupAnalyticsData } from '../../../backend/signup.analytics.service';
import { useUsersAnalytics } from '../../../backend/analytics.service';
import AdminKeepPlayingModal from '../../../components/modals/AdminKeepPlayingModal';
import { MostPlayedGames } from './MostPlayedGames';
import { RecentUserActivity } from './RecentUserActivity';

export default function Home() {

  const [isAcceptInviteOpen, setIsAcceptInviteOpen] = useState(false);
  const [showKeepPlayingModal, setShowKeepPlayingModal] = useState(false);

  const handleShowPopup = () => {
    setShowKeepPlayingModal(true);
  };
  return (
    <div>
      <div className="px-6 pb-3">
      </div>
      <div className="px-6">
        <StatsCard />
        {/* pop up */}
        <div className="col-span-1 md:col-span-2 lg:col-span-4 my-6">
          <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
            <div className="justify-between items-center flex p-3">
              <p className="text-3xl dark:text-[#D946EF]">Dynamic Popup System</p>
              <PopUpSheet>
                <Button className="bg-[#D946EF] hover:bg-[#C026D3] text-white transition-colors duration-200">
                  Create New Pop-up
                </Button>
              </PopUpSheet>
            </div>
            {/* inner card */}
            <Card className="bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none mx-3 p-4">
              <div className="justify-end flex flex-col p-3 space-y-4">
                <p className="text-lg">User View</p>
                <Button
                  onClick={handleShowPopup}
                  className="w-32 bg-[#D946EF] hover:bg-[#C026D3] text-white transition-colors duration-200"
                >
                  Show Pop-up Now
                </Button>
              </div>
            </Card>
          </Card>
        </div>

        {/* insights */}
        <div className="col-span-1 md:col-span-2 lg:col-span-4 mb-6">
          <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
            <div className="justify-between items-center flex p-3">
              <p className="text-3xl">Click insights</p>
            </div>
            {/* inner card */}
            <Card className="bg-[#F8FAFC] dark:bg-[#0F1221] shadow-none border-none mx-3 p-4">
              <div className="flex flex-col space-y-8">

                <div className="">
                  <div className="justify-start flex items-center gap-4">
                    <img src={click} alt="click" className="w-10 h-10 dark:text-white" />
                    <p className="text-lg text-[#64748A] dark:text-white">Total clicks on Sign-up form</p>
                  </div>

                  <SignupClickInsights />
                </div>
              </div>
            </Card>
          </Card>
        </div>

        <div className="col-span-1 md:col-span-2 lg:col-span-4 mb-6">
          <MostPlayedGames />
        </div>

        <div className="col-span-1 md:col-span-2 lg:col-span-4 mb-6">
          <RecentUserActivity />
        </div>
      </div>

      <AcceptInvitationModal open={isAcceptInviteOpen} onOpenChange={setIsAcceptInviteOpen} isExistingUser={true} />
      <AdminKeepPlayingModal
        open={showKeepPlayingModal}
        onClose={() => setShowKeepPlayingModal(false)}
        isGameLoading={false}
      />
    </div>
  );
}

// Separate component for signup click insights
function SignupClickInsights() {
  const { data: signupAnalytics, isLoading: analyticsLoading } = useSignupAnalyticsData();
  const { data: usersWithAnalytics, isLoading: usersLoading } = useUsersAnalytics();

  if (analyticsLoading || usersLoading) {
    return <div className="text-center py-4">Loading...</div>;
  }

  if (!signupAnalytics || !usersWithAnalytics) {
    return <div className="text-center py-4">No data available</div>;
  }

  // Total registered users is the verified count
  const verifiedCount = usersWithAnalytics.length;
  const didntRegisterCount = signupAnalytics.totalClicks - verifiedCount;

  const chartData = [
    { name: "Didn't register", value: didntRegisterCount, fill: "#F3C7FA" },
    { name: "Verified users", value: verifiedCount, fill: "#D24CFB" }
  ];

  return <PieChart data={chartData} />;
}
</file>

<file path="src/pages/Admin/Home/MostPlayedGames.tsx">
import { Card } from "../../../components/ui/card";
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from "../../../components/ui/table";
import { useState, useMemo } from 'react';
import { useGamesAnalytics, type GameAnalytics } from '../../../backend/analytics.service';
import { formatTime } from '../../../utils/main';
import { NoResults } from '../../../components/single/NoResults';
import { RiGamepadLine } from 'react-icons/ri';

export function MostPlayedGames() {
  const { data: gamesWithAnalytics, isLoading } = useGamesAnalytics();

  // Sort games by total sessions (most played first)
  const allGames = useMemo<GameAnalytics[]>(() => {
    if (!gamesWithAnalytics) return [];
    return [...gamesWithAnalytics].sort((a, b) =>
      (b.analytics?.totalSessions || 0) - (a.analytics?.totalSessions || 0)
    );
  }, [gamesWithAnalytics]);

  // Pagination state
  const [currentPage, setCurrentPage] = useState(1);
  const gamesPerPage = 5;
  const totalPages = Math.ceil(allGames.length / gamesPerPage);

  const getGamesForPage = (page: number) => {
    const startIdx = (page - 1) * gamesPerPage;
    const endIdx = startIdx + gamesPerPage;
    return allGames.slice(startIdx, endIdx);
  };

  const gamesToShow = getGamesForPage(currentPage);

  return (
    <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
      <div className="flex justify-between p-4 text-3xl">
        <p className="text-3xl dark:text-[#D946EF]">Most Played Games</p>
      </div>
      <div className="px-4 pb-4">
        <Table>
          <TableHeader>
            <TableRow className="text-xl text-[]">
              <TableHead>Game</TableHead>
              <TableHead>Total Plays</TableHead>
              <TableHead>Minutes played</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            {isLoading ? (
              <TableRow>
                <TableCell colSpan={3} className="text-center py-6 hover:bg-transparent">
                  <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF] mx-auto"></div>
                </TableCell>
              </TableRow>
            ) : !gamesToShow.length ? (
              <TableRow>
                <TableCell colSpan={3} className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]">
                  <NoResults
                    title="No games played yet"
                    message="There are no game play records to display at this time."
                    icon={<RiGamepadLine className="w-12 h-12 text-gray-400" />}
                  />
                </TableCell>
              </TableRow>
            ) : (
              gamesToShow.map((game, idx) => (
                <TableRow key={idx}>
                  <TableCell>
                    <div className="flex items-center gap-3">
                      <img
                        src={game.thumbnailFile?.url}
                        alt={game.title}
                        className="w-12 h-12 rounded-lg object-cover"
                      />
                      <span className="font-semibold text-lg">{game.title}</span>
                    </div>
                  </TableCell>
                  <TableCell className="font-sans">{game.analytics?.totalSessions || 0}</TableCell>
                  <TableCell className="font-sans">{formatTime(game.analytics?.totalPlayTime || 0)}</TableCell>
                </TableRow>
              ))
            )}
          </TableBody>
        </Table>
        {gamesToShow.length > 0 && (
          <div className="flex justify-between items-center mt-4">
            <span className="text-sm">
              Showing {(currentPage - 1) * gamesPerPage + 1}-{Math.min(currentPage * gamesPerPage, allGames.length)} from {allGames.length} data
            </span>
            {totalPages > 1 && (
              <div className="flex items-center gap-1 rounded-full border border-[#D946EF] p-1">
                {Array.from({ length: totalPages }, (_, i) => (
                  <button
                    key={i + 1}
                    className={`w-8 h-8 rounded-full transition-colors ${
                      currentPage === i + 1
                        ? "bg-[#D946EF] text-white"
                        : "hover:bg-[#F3E8FF] text-black dark:text-white"
                    }`}
                    onClick={() => setCurrentPage(i + 1)}
                  >
                    {i + 1}
                  </button>
                ))}
              </div>
            )}
          </div>
        )}
      </div>
    </Card>
  );
}
</file>

<file path="src/pages/Admin/Home/RecentUserActivity.tsx">
import { Card } from "../../../components/ui/card";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "../../../components/ui/table";
import { useState, useMemo } from "react";
import {
  useUsersAnalytics,
  type UserAnalytics,
} from "../../../backend/analytics.service";
import { formatTime } from "../../../utils/main";
import { NoResults } from "../../../components/single/NoResults";
import { FiUsers } from "react-icons/fi";

export function RecentUserActivity() {
  const { data: usersWithAnalytics, isLoading } = useUsersAnalytics();
  const [currentPage, setCurrentPage] = useState(1);
  const usersPerPage = 5;

  // Sort users by lastLoggedIn (most recent first)
  const allUsers = useMemo<UserAnalytics[]>(() => {
    if (!usersWithAnalytics) return [];
    return [...usersWithAnalytics].sort(
      (a, b) =>
        new Date(b.lastLoggedIn).getTime() - new Date(a.lastLoggedIn).getTime()
    );
  }, [usersWithAnalytics]);

  const getUsersForPage = (page: number) => {
    const startIdx = (page - 1) * usersPerPage;
    const endIdx = startIdx + usersPerPage;
    return allUsers.slice(startIdx, endIdx);
  };

  const usersToShow = getUsersForPage(currentPage);
  const totalPages = Math.ceil(allUsers.length / usersPerPage);

  return (
    <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
      <div className="flex justify-between p-4 text-3xl">
        <p className="text-3xl dark:text-[#D946EF]">Recent User Activity</p>
      </div>
      <div className="px-4 pb-4">
        <Table>
          <TableHeader>
            <TableRow className="text-xl text-bold">
              <TableHead>Name</TableHead>
              <TableHead>Email</TableHead>
              <TableHead>Registration Date</TableHead>
              <TableHead>Games Played</TableHead>
              <TableHead>Time Played</TableHead>
              <TableHead>Session count</TableHead>
              <TableHead>Last Login</TableHead>
            </TableRow>
          </TableHeader>
          <TableBody>
            {isLoading ? (
              <TableRow>
                <TableCell
                  colSpan={7}
                  className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]"
                >
                  <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF] mx-auto"></div>
                </TableCell>
              </TableRow>
            ) : !usersToShow.length ? (
              <TableRow>
                <TableCell
                  colSpan={7}
                  className="text-center py-6 bg-[#F8FAFC] dark:bg-[#0F1221]"
                >
                  <NoResults
                    title="No user activity"
                    message="There are no user activity records to display at this time."
                    icon={<FiUsers className="w-12 h-12 text-gray-400" />}
                  />
                </TableCell>
              </TableRow>
            ) : (
              usersToShow.map((user, idx) => (
                <TableRow key={idx} className="font-sans">
                  <TableCell>{`${user.firstName || ""} ${
                    user.lastName || ""
                  }`}</TableCell>
                  <TableCell>{user.email}</TableCell>
                  <TableCell>
                    {new Date(user.createdAt).toLocaleDateString()}
                  </TableCell>
                  <TableCell>{user.analytics.totalGamesPlayed}</TableCell>
                  <TableCell>
                    {formatTime(user.analytics.totalTimePlayed)}
                  </TableCell>
                  <TableCell>{user.analytics.totalSessionCount}</TableCell>
                  <TableCell>
                    <span className="flex items-center gap-2">
                      <div className="bg-[#94A3B7] p-2 rounded-lg">
                        <span className="inline-block w-2 h-2 rounded-full bg-red-500" />
                        <span className="rounded px-2 py-1 text-white font-semibold text-sm">
                          {new Date(user.lastLoggedIn).toLocaleTimeString(
                            "en-US",
                            {
                              hour: "2-digit",
                              minute: "2-digit",
                              hour12: true,
                            }
                          )}
                        </span>
                      </div>
                    </span>
                  </TableCell>
                </TableRow>
              ))
            )}
          </TableBody>
        </Table>
        {usersToShow.length > 0 && (
          <div className="flex justify-between items-center mt-4">
            <span className="text-sm">
              Showing {(currentPage - 1) * usersPerPage + 1}-
              {Math.min(currentPage * usersPerPage, allUsers.length)} from{" "}
              {allUsers.length} data
            </span>
            {totalPages > 1 && (
              <div className="flex items-center gap-1 rounded-full border border-[#D946EF] p-1">
                {Array.from({ length: totalPages }, (_, i) => (
                  <button
                    key={i + 1}
                    className={`w-8 h-8 rounded-full transition-colors ${
                      currentPage === i + 1
                        ? "bg-[#D946EF] text-white"
                        : "hover:bg-[#F3E8FF] text-black dark:text-white"
                    }`}
                    onClick={() => setCurrentPage(i + 1)}
                  >
                    {i + 1}
                  </button>
                ))}
              </div>
            )}
          </div>
        )}
      </div>
    </Card>
  );
}
</file>

<file path="src/pages/Admin/Home/StatsCard.tsx">
import { FaRegClock, FaRegStar } from "react-icons/fa";
import { FaRegUser } from "react-icons/fa6";
import { IoGameControllerOutline } from "react-icons/io5";
import { IoHourglassOutline } from "react-icons/io5";
import { HiOutlineUsers } from "react-icons/hi2";
import { TbCalendarClock } from "react-icons/tb";
import { HiMiniArrowDownLeft, HiMiniArrowUpRight } from "react-icons/hi2";
import { useDashboardAnalytics } from "../../../backend/analytics.service";
import { Card } from "../../../components/ui/card";

import { formatTime } from "../../../utils/main";

export default function StatsCard() {
  const { data: dashboardAnalytics, isError, isLoading } = useDashboardAnalytics();

  if (isLoading) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="p-4">Loading dashboard data...</div>
        </Card>
      </div>
    );
  }

  if (isError) {
    return (
      <div className="col-span-1 md:col-span-2 lg:col-span-4 mt-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="p-4 text-red-500">Error loading dashboard data</div>
        </Card>
      </div>
    );
  }

  const data = dashboardAnalytics as any;
  const cardData = [
    {
      title: "Total Users",
      value: data.totalUsers.current,
      icon: <FaRegUser size={32} />,
      change: `${data.totalUsers.percentageChange ?? 0}%`,
      changeType: data.totalUsers.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Registered Users",
      value: data.totalRegisteredUsers.current,
      icon: <HiOutlineUsers size={32} />,
      change: `${data.totalRegisteredUsers.percentageChange ?? 0}%`,
      changeType: data.totalRegisteredUsers.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Total Games",
      value: data.totalGames.current,
      icon: <IoGameControllerOutline size={32} />,
      change: `${data.totalGames.percentageChange ?? 0}%`,
      changeType: data.totalGames.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Sessions",
      value: data.totalSessions.current,
      icon: <TbCalendarClock size={36} />,
      change: `${data.totalSessions.percentageChange ?? 0}%`,
      changeType: data.totalSessions.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Time played",
      value: formatTime(data.totalTimePlayed.current),
      icon: <FaRegClock size={32} className="dark:text-white" />,
      change: `${data.totalTimePlayed.percentageChange ?? 0}%`,
      changeType: data.totalTimePlayed.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Most Played",
      value: data.mostPlayedGame?.title || "No games played",
      icon: <FaRegStar size={32} />,
      change: `${data.mostPlayedGame?.percentageChange ?? 0}%`,
      changeType: data.mostPlayedGame?.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "User Retention",
      value: `${Math.round(data.retentionRate) ?? 0}%`,
      icon: <TbCalendarClock size={36} />,
      change: "0%",
      changeType: "up",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
    {
      title: "Avg. Session Duration",
      value: formatTime(data.avgSessionDuration.current),
      icon: <IoHourglassOutline size={32} />,
      change: `${data.avgSessionDuration.percentageChange ?? 0}%`,
      changeType: data.avgSessionDuration.percentageChange >= 0 ? "up" : "down",
      description: "Over the last 24 hours",
      color: "text-[#D946EF] dark:text-[#F0ABFC]",
    },
  ];

  return (
    <div className="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      {cardData.map((card, idx) => (
        <div
          key={idx}
          className="dark:bg-[#334154] bg-[#F1F5F9] rounded-xl p-4 flex flex-col gap-2"
        >
          <div className="tracking-widest">
            {/* top */}
            <div className="flex justify-between mb-6">
              <div className="">
                <span className="font-semibold text-[#64748A] dark:text-white text-base">{card.title}</span>
                <div className={`font-bold text-xl ${card.color}`}>{card.value}</div>
              </div>
              <span className="text-3xl text-[#64748A] dark:text-white">{card.icon}</span>
            </div>

            {/* bottom */}
            <div className="flex md:flex-1 justify-between items-center pr-2">
              <div className={`flex flex-row gap-1 items-center text-[14px] ${
                card.changeType === "up"
                  ? "text-white bg-[#D946EF] pl-1 pr-1 pt-1 pb-1 rounded-lg dark:bg-[#64748A]"
                  : "text-white bg-[#D946EF] dark:bg-[#64748A] pl-2 pr-2 pt-1 pb-1 rounded-lg"
              }`}>
                {card.changeType === "up" ? <HiMiniArrowUpRight /> : <HiMiniArrowDownLeft />}
                <span>{card.change}</span>
              </div>
              <span className="text-gray-400 text-[13px] font-pincuk text-xl tracking-wider dark:text-white">{card.description}</span>
            </div>
          </div>
        </div>
      ))}
    </div>
  );
}
</file>

<file path="src/pages/Admin/Management/GameManagement.tsx">
/* eslint-disable @typescript-eslint/no-explicit-any */
import { useState } from "react";
import { Card } from "../../../components/ui/card";
import { Button } from "../../../components/ui/button";
import { DeleteConfirmationModal } from "../../../components/modals/DeleteConfirmationModal";
import { toast } from "sonner";
import { useDeleteGame } from "../../../backend/games.service";
import { useGamesAnalytics } from "../../../backend/analytics.service";
import type { GameStatus } from "../../../backend/types";
import { NoResults } from "../../../components/single/NoResults";
import { RiGamepadLine } from "react-icons/ri";
import { useQueryClient } from "@tanstack/react-query";
import { BackendRoute } from "../../../backend/constants";
import { FilterSheet } from "../../../components/single/Filter-Sheet";
import { IoEyeOutline, IoEyeOffOutline } from "react-icons/io5";
import { CiEdit } from "react-icons/ci";
import { RiDeleteBin6Line } from "react-icons/ri";
import { RiEqualizer2Line } from "react-icons/ri";
import { CreateGameSheet } from "../../../components/single/CreateGame-Sheet";
import { useNavigate } from "react-router-dom";
import { EditSheet } from "../../../components/single/Edit-Sheet";
import { cn } from "../../../lib/utils";
import { formatTime } from "../../../utils/main";
import GameThumbnail from "../Analytics/GameThumbnail";

const pageSize = 10;

export default function GameManagement() {
  const [page, setPage] = useState(1);
  const [filters, setFilters] = useState<{
    categoryId?: string;
    status?: GameStatus;
  }>();
  const navigate = useNavigate();

  const [editOpen, setEditOpen] = useState(false);
  const [deleteModalOpen, setDeleteModalOpen] = useState(false);
  const [selectedGameId, setSelectedGameId] = useState<string | null>(null);
  const queryClient = useQueryClient();
  const { data: gamesWithAnalytics, isLoading } = useGamesAnalytics();
  const deleteGame = useDeleteGame();

  // Apply filters
  const filteredGames = (gamesWithAnalytics ?? []).filter((game) => {
    if (filters?.categoryId && game.category?.id !== filters.categoryId)
      return false;
    if (filters?.status && game.status !== filters.status) return false;
    return true;
  });

  const handleDelete = async () => {
    if (!selectedGameId) return;
    try {
      await deleteGame.mutateAsync(selectedGameId);
      queryClient.invalidateQueries({
        queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS],
      });
      toast.success("Game deleted successfully");
      setDeleteModalOpen(false);
      setEditOpen(false); // Close edit sheet
      setSelectedGameId(null); // Clear selected game
    } catch (error: any) {
      // Check if it's a "not found" error, which means the game was already deleted
      if (error?.response?.data?.error?.message?.includes("not found")) {
        queryClient.invalidateQueries({
          queryKey: [BackendRoute.ADMIN_GAMES_ANALYTICS],
        });
        toast.success("Game deleted successfully");
        setDeleteModalOpen(false);
        setEditOpen(false); // Close edit sheet
        setSelectedGameId(null); // Clear selected game
      } else {
        toast.error("Failed to delete game");
      }
    }
  };

  const totalGames = filteredGames.length;
  const totalPages = Math.ceil(totalGames / pageSize);

  return (
    <div className="p-6">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-[#D946EF] text-3xl font-boogaloo">All Games</h1>
        <div className="flex gap-3">
          <FilterSheet
            onFilter={setFilters}
            onReset={() => setFilters(undefined)}
          >
            <Button
              variant="outline"
              className="border-[#475568] text-[#475568] flex items-center gap-2 dark:text-white"
            >
              Filter
              <RiEqualizer2Line size={32} />
            </Button>
          </FilterSheet>
          <CreateGameSheet>
            <Button className="bg-[#D946EF] text-white font-bold hover:bg-[#c026d3] tracking-wider">
              Create New Game
            </Button>
          </CreateGameSheet>
        </div>
      </div>
      <Card className="p-0 overflow-x-auto shadow-none border border-none bg-[#F1F5F9] dark:bg-[#18192b]">
        <table className="min-w-full bg-transparent">
          <thead>
            <tr className="dark:bg-[#18192b] text-xl tracking-wide font-light">
              <th className="px-4 py-3 text-left">Game</th>
              <th className="px-4 py-3 text-left">Category</th>
              <th className="px-4 py-3 text-left">Minutes played</th>
              <th className="px-4 py-3 text-left">Game Status</th>
              <th className="px-4 py-3 text-left">Action</th>
            </tr>
          </thead>
          <tbody>
            {isLoading ? (
              <tr>
                <td colSpan={5} className="px-4 py-3 text-center">
                  Loading...
                </td>
              </tr>
            ) : !filteredGames.length ? (
              <tr>
                <td colSpan={5}>
                  <NoResults
                    title={
                      gamesWithAnalytics?.length
                        ? "No matching results"
                        : "No games found"
                    }
                    message={
                      gamesWithAnalytics?.length
                        ? "Try adjusting your filters"
                        : "No games have been added to the system yet"
                    }
                    icon={<RiGamepadLine className="w-12 h-12 text-gray-400" />}
                  />
                </td>
              </tr>
            ) : (
              filteredGames.map((game, idx) => (
                <tr
                  key={game.id}
                  className={cn(
                    "border-b dark:border-[#23243a] hover:bg-[#f3e8ff]/40 dark:hover:bg-[#23243a]/40 transition",
                    idx % 2 === 0 ? "dark:bg-[#18192b]" : "dark:bg-[#23243a]"
                  )}
                >
                  <td className="px-4 py-3 flex items-center gap-3">
                    <GameThumbnail
                      src={(game.thumbnailFile as any)?.url || ""}
                      alt={game.title}
                    />
                    <span className="text-lg font-light">{game.title}</span>
                  </td>
                  <td className="px-4 py-3 font-pincuk text-xl tracking-wider">
                    {game.category?.name || "Uncategorized"}
                  </td>
                  <td className="px-4 py-3 font-pincuk text-xl tracking-wider">
                    {game.analytics?.totalPlayTime != null
                      ? formatTime(game.analytics.totalPlayTime || 0)
                      : "-"}
                  </td>
                  <td className="px-4 py-3">
                    {game.status === "active" ? (
                      <span className="inline-flex items-center gap-2 p-1 rounded bg-[#419E6A] text-white font-pincuk text-lg tracking-wider">
                        <span className="w-2 h-2 bg-white rounded-full inline-block"></span>
                        Active
                      </span>
                    ) : (
                      <span className="inline-flex items-center gap-2  p-1 rounded bg-[#CBD5E0] text-[#22223B] font-pincuk text-lg tracking-wider">
                        <span className="w-2 h-2 bg-red-500 rounded-full inline-block"></span>
                        Inactive
                      </span>
                    )}
                  </td>
                  <td className="px-4 py-3">
                    <div className="flex gap-3 items-cente">
                      <button
                        className="text-black hover:text-black p-1 dark:text-white"
                        title="Edit"
                        onClick={() => {
                          setSelectedGameId(game.id);
                          setEditOpen(true);
                        }}
                      >
                        <CiEdit />
                      </button>
                      <button
                        className="text-black hover:text-black p-1 dark:text-white"
                        title="View"
                        onClick={() => navigate(`/admin/view-game/${game.id}`)}
                      >
                        {game.status === "active" ? (
                          <IoEyeOutline />
                        ) : (
                          <IoEyeOffOutline />
                        )}
                      </button>
                      <button
                        className="text-black hover:text-black p-1 dark:text-white"
                        title="Delete"
                        onClick={() => {
                          setSelectedGameId(game.id);
                          setDeleteModalOpen(true);
                        }}
                      >
                        <RiDeleteBin6Line />
                      </button>
                    </div>
                  </td>
                </tr>
              ))
            )}
          </tbody>
        </table>
        {/* Pagination */}
        {filteredGames.length > 0 && (
          <div className="flex justify-between items-center px-4 py-3 bg-[#F1F5F9] dark:bg-[#18192b] rounded-b-xl ">
            <span className="text-sm">
              Showing {(page - 1) * pageSize + 1}-
              {Math.min(page * pageSize, totalGames)} from {totalGames} data
            </span>
            <div className="flex items-center gap-2 rounded-xl space-x-4 pr-1 pl-0.5 border border-[#D946EF] dark:text-white">
              {Array.from({ length: totalPages }, (_, i) => (
                <button
                  key={i + 1}
                  className={`w-7 h-7 rounded-full transition-colors  ${
                    page === i + 1
                      ? "bg-[#D946EF] text-white dark:bg-gray-400"
                      : "bg-transparent text-[#D946EF] dark:text-gray-400 hover:bg-[#f3e8ff]"
                  }`}
                  onClick={() => setPage(i + 1)}
                >
                  {i + 1}
                </button>
              ))}
            </div>
          </div>
        )}
      </Card>

      {editOpen && selectedGameId && (
        <EditSheet
          open={editOpen}
          onOpenChange={setEditOpen}
          gameId={selectedGameId}
        />
      )}

      {/* Delete Confirmation Modal */}
      <DeleteConfirmationModal
        open={deleteModalOpen}
        onOpenChange={setDeleteModalOpen}
        onConfirm={handleDelete}
        isDeleting={deleteGame.isPending}
      />
    </div>
  );
}
</file>

<file path="src/pages/Admin/Team/TeamManagement.tsx">
import { useState } from "react";
import { MdOutlineCancel } from "react-icons/md";
import { InviteSheet } from "../../../components/single/Invite-Sheet";
import { useAllTeamMembers, useRevokeRole, useTeamInvitations, useDeleteTeamInvitation } from "../../../backend/teams.service";
import { DeleteConfirmationModal } from "../../../components/modals/DeleteConfirmationModal";
import { NoResults } from '../../../components/single/NoResults';
import { RiTeamLine } from 'react-icons/ri';
import { toast } from "sonner";
import type { User } from "../../../backend/types";
import { format } from "date-fns";
// import { getErrorMessage } from "../../../utils/errorHandling";

export default function TeamManagement() {
  const [activeTab, setActiveTab] = useState<'members' | 'invitations'>('members');
  const { data: teamData, isLoading, error } = useAllTeamMembers();
  const { data: invitationsData, isLoading: isLoadingInvitations, error: invitationsError } = useTeamInvitations();
  const revokeRole = useRevokeRole();
  const deleteInvitation = useDeleteTeamInvitation();

  const [selectedUser, setSelectedUser] = useState<User | null>(null);
  const [selectedInvitationId, setSelectedInvitationId] = useState<string | null>(null);
  const [isConfirmOpen, setIsConfirmOpen] = useState(false);
  const [isDeleteInviteConfirmOpen, setIsDeleteInviteConfirmOpen] = useState(false);


  const handleRevokeClick = (user: User) => {
    setSelectedUser(user);
    setIsConfirmOpen(true);
  };

  const handleConfirmRevoke = async () => {
    if (!selectedUser) return;

    try {
      await revokeRole.mutateAsync(selectedUser.id);
      toast.success(`${selectedUser.firstName}'s role has been revoked`);
      setIsConfirmOpen(false);
      setSelectedUser(null);
    } catch (error: any) {
      console.log(error, "revoke error")
      // const { message, type } = getErrorMessage(error, 'Failed to revoke role');
      // if (type === 'warning') {
      //   toast.warning(message);
      // } else {
      //   toast.error(message);
      // }
    }
  };

  const handleDeleteInviteClick = (id: string) => {
    setSelectedInvitationId(id);
    setIsDeleteInviteConfirmOpen(true);
  };

  const handleConfirmDeleteInvite = async () => {
    if (!selectedInvitationId) return;

    try {
      await deleteInvitation.mutateAsync(selectedInvitationId);
      toast.success('Invitation has been deleted');
      setIsDeleteInviteConfirmOpen(false);
      setSelectedInvitationId(null);
    } catch (error: any) {
      console.log(error)
      // const { message, type } = getErrorMessage(error, 'Failed to delete invitation');
      // if (type === 'warning') {
      //   toast.warning(message);
      // } else {
      //   toast.error(message);
      // }
    }
  };

  return (
    <div className="px-4 sm:px-8">
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <h1 className="text-[#D946EF] text-3xl font-boogaloo font-bold">Team Management</h1>
        <InviteSheet>
          <button className="bg-[#D946EF] text-white px-3 sm:px-4 py-2 sm:py-3 rounded-lg hover:bg-[#c026d3] transition-all text-sm sm:text-base w-full sm:w-auto">
            Invite Team Member
          </button>
        </InviteSheet>
      </div>

      <div className="flex gap-2 sm:gap-4 mb-6 overflow-x-auto">
        <button
          onClick={() => setActiveTab('members')}
          className={`px-3 sm:px-4 py-2 rounded-lg transition-all whitespace-nowrap text-sm sm:text-base ${
            activeTab === 'members'
              ? 'bg-[#D946EF] text-white'
              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200'
          }`}
        >
          Team Members
        </button>
        <button
          onClick={() => setActiveTab('invitations')}
          className={`px-3 sm:px-4 py-2 rounded-lg transition-all whitespace-nowrap text-sm sm:text-base ${
            activeTab === 'invitations'
              ? 'bg-[#D946EF] text-white'
              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200'
          }`}
        >
          Pending Invitations
        </button>
      </div>
      {activeTab === 'members' ? (
      <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl shadow-none border-none w-full p-6 overflow-x-auto">
        <div className="min-w-[650px]">
          <table className="w-full text-left">
          <thead>
            <tr className="text-xl font-bold text-[#121C2D] dark:text-white tracking-wide dark:font-none dark:tracking-wider">
              <th className="pb-4">Name</th>
              <th className="pb-4">Email</th>
              <th className="pb-4">Role</th>
              <th className="pb-4">Action</th>
            </tr>
          </thead>
          <tbody>
            {error ? (
              <tr>
                <td colSpan={4} className="text-center py-6 text-red-500">
                  Failed to load team members. Please try again.
                </td>
              </tr>
            ) : isLoading ? (
              <tr>
                <td colSpan={4} className="text-center py-6">
                  <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF] mx-auto"></div>
                </td>
              </tr>
            ) : !teamData?.filter((member: User) =>
              member.role.name.toLowerCase() !== 'player'
            )?.length ? (
              <tr>
                <td colSpan={4} className="text-center py-6">
                  <NoResults
                    title="No team members found"
                    message="Your team doesn't have any members yet. Click 'Invite Team Member' to add someone."
                    icon={<RiTeamLine className="w-12 h-12 text-gray-400" />}
                  />
                </td>
              </tr>
            ) : teamData?.filter((member: User) =>
              member.role.name.toLowerCase() !== 'player'
            )?.map((member: User) => (
              <tr
                key={member.id}
                className="border-t border-[#d8d9da] text-md font-pincuk text-lg tracking-wider"
              >
                <td className="py-6 text-[#121C2D] dark:text-white">
                  {member.firstName || ""} {member.lastName || ""}
                </td>
                <td className="py-6 text-[#121C2D] dark:text-white">{member.email}</td>
                <td className="py-6">
                  {member.role.name.toLowerCase() === "admin" ? (
                    <span className="bg-[#D946EF] text-white px-3 py-2 rounded-lg text-md">
                      Admin
                    </span>
                  ) : (
                    <span className="bg-[#334154] text-white px-3 py-2 rounded-lg text-md">
                      {member.role.name}
                    </span>
                  )}
                </td>
                <td className="py-6">
                  <button
                    onClick={() => handleRevokeClick(member)}
                    className="flex items-center gap-2 bg-[#EF4444] hover:bg-[#dc2626] text-white px-3 py-1 rounded-lg text-md transition-all"
                    disabled={revokeRole.isPending && selectedUser?.id === member.id}
                  >
                    <span className="text-xl"><MdOutlineCancel className="w-4 h-4" /></span>
                    {revokeRole.isPending && selectedUser?.id === member.id ? 'Revoking...' : 'Revoke'}
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
          </table>
        </div>
        </div>
      ) : (
        <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl shadow-none border-none w-full p-6 overflow-x-auto">
          <div className="min-w-[750px]">
            <table className="w-full text-left">
            <thead>
              <tr className="text-xl font-bold text-[#121C2D] dark:text-white tracking-wide dark:font-none dark:tracking-wider">
                <th className="pb-4">Email</th>
                <th className="pb-4">Role</th>
                <th className="pb-4">Status</th>
                <th className="pb-4">Invited By</th>
                <th className="pb-4">Expires At</th>
                <th className="pb-4">Action</th>
              </tr>
            </thead>
            <tbody>
              {invitationsError ? (
                <tr>
                  <td colSpan={6} className="text-center py-6 text-red-500">
                    Failed to load invitations. Please try again.
                  </td>
                </tr>
              ) : isLoadingInvitations ? (
                <tr>
                  <td colSpan={6} className="text-center py-6">
                    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF] mx-auto"></div>
                  </td>
                </tr>
              ) : !invitationsData?.data?.filter((invitation: any) => !invitation.isAccepted)?.length ? (
                <tr>
                  <td colSpan={6} className="text-center py-6">
                    <NoResults
                      title="No pending invitations"
                      message="There are no pending team invitations at the moment."
                      icon={<RiTeamLine className="w-12 h-12 text-gray-400" />}
                    />
                  </td>
                </tr>
              ) : (
                invitationsData.data.filter((invitation: any) => !invitation.isAccepted).map((invitation: any) => (
                  <tr
                    key={invitation.id}
                    className="border-t border-[#d8d9da] text-md font-pincuk text-lg tracking-wider"
                  >
                    <td className="py-6 text-[#121C2D] dark:text-white">
                      {invitation.email}
                    </td>
                    <td className="py-6">
                      <span className={`px-3 py-2 rounded-lg text-md ${
                        invitation.role.name.toLowerCase() === "admin"
                          ? "bg-[#D946EF] text-white"
                          : "bg-[#334154] text-white"
                      }`}>
                        {invitation.role.name}
                      </span>
                    </td>
                    <td className="py-6">
                      <span className={`px-3 py-2 rounded-lg text-md ${
                        invitation.isAccepted
                          ? "bg-green-500 text-white"
                          : "bg-yellow-500 text-white"
                      }`}>
                        {invitation.isAccepted ? 'Accepted' : 'Pending'}
                      </span>
                    </td>
                    <td className="py-6 text-[#121C2D] dark:text-white">
                      {invitation.invitedBy.firstName} {invitation.invitedBy.lastName}
                    </td>
                    <td className="py-6 text-[#121C2D] dark:text-white">
                      {format(new Date(invitation.expiresAt), 'MMM d, yyyy h:mm a')}
                    </td>
                    <td className="py-6">
                      <button
                        onClick={() => handleDeleteInviteClick(invitation.id)}
                        className="flex items-center gap-2 bg-[#EF4444] hover:bg-[#dc2626] text-white px-3 py-1 rounded-lg text-md transition-all"
                        disabled={deleteInvitation.isPending && selectedInvitationId === invitation.id}
                      >
                        <span className="text-xl"><MdOutlineCancel className="w-4 h-4" /></span>
                        {deleteInvitation.isPending && selectedInvitationId === invitation.id ? 'Deleting...' : 'Delete'}
                      </button>
                    </td>
                  </tr>
                ))
              )}
            </tbody>
            </table>
          </div>
        </div>
      )}

      <DeleteConfirmationModal
        open={isConfirmOpen}
        onOpenChange={setIsConfirmOpen}
        onConfirm={handleConfirmRevoke}
        isDeleting={revokeRole.isPending}
        title="Revoke Team Member Role?"
        description={selectedUser ? `Are you sure you want to revoke ${selectedUser.firstName}'s ${selectedUser.role.name} role? They will be changed to a player.` : ''}
        confirmButtonText="Revoke"
        loadingText="Revoking..."
      />

      <DeleteConfirmationModal
        open={isDeleteInviteConfirmOpen}
        onOpenChange={setIsDeleteInviteConfirmOpen}
        onConfirm={handleConfirmDeleteInvite}
        isDeleting={deleteInvitation.isPending}
        title="Delete Team Invitation?"
        description="Are you sure you want to delete this invitation? This action cannot be undone."
        confirmButtonText="Delete"
        loadingText="Deleting..."
      />
    </div>
  );
}
</file>

<file path="src/pages/Admin/UserManagement/UserManagement.tsx">
import { useState } from "react";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "../../../components/ui/table";
import { Card } from "../../../components/ui/card";
import { UserManagementFilterSheet } from "../../../components/single/UserMgtFilter-Sheet";
import { Button } from "../../../components/ui/button";
import { RiEqualizer2Line } from "react-icons/ri";
import ExportModal from "../../../components/modals/AdminModals/ExportModal";
import { useNavigate } from "react-router-dom";
import {
  useUsersAnalytics,
  useGamesAnalytics,
} from "../../../backend/analytics.service";
import type {
  FilterState,
  GameAnalytics,
} from "../../../backend/analytics.service";
import { NoResults } from "../../../components/single/NoResults";
import { formatTime } from "../../../utils/main";

export default function UserManagement() {
  const navigate = useNavigate();
  const [page, setPage] = useState(1);
  const [filters, setFilters] = useState<FilterState>({
    registrationDates: {
      startDate: "",
      endDate: "",
    },
    sessionCount: "",
    timePlayed: {
      min: 0,
      max: 0,
    },
    gameTitle: '',
    gameCategory: '',
    sortByMaxTimePlayed: false
  });

  const { data: users, isLoading } = useUsersAnalytics(filters);
  const { data: games } = useGamesAnalytics();
  const usersPerPage = 12;

  console.log("users for analytics", users);

  const handleFiltersChange = (newFilters: FilterState) => {
    setFilters(newFilters);
    setPage(1); // Reset to first page when filters change
  };

  const handleFilterReset = () => {
    setFilters({
      registrationDates: {
        startDate: "",
        endDate: "",
      },
      sessionCount: "",
      timePlayed: {
        min: 0,
        max: 0,
      },
      gameTitle: '',
      gameCategory: '',
      sortByMaxTimePlayed: false
    });
    setPage(1);
  };

  // Filter users based on criteria
  let filteredUsers = users?.filter(user => {
    if (filters.registrationDates.startDate && new Date(user.createdAt) < new Date(filters.registrationDates.startDate)) return false;
    if (filters.registrationDates.endDate && new Date(user.createdAt) > new Date(filters.registrationDates.endDate)) return false;
    if (filters.sessionCount && user.analytics?.totalSessionCount < parseInt(filters.sessionCount)) return false;
    if (filters.timePlayed.min && (user.analytics?.totalTimePlayed || 0) / 60 < filters.timePlayed.min) return false;
    if (filters.timePlayed.max && (user.analytics?.totalTimePlayed || 0) / 60 > filters.timePlayed.max) return false;
    if (filters.gameCategory && user.analytics?.mostPlayedGame?.gameId && !games?.find((g: GameAnalytics) => g.id === user.analytics?.mostPlayedGame?.gameId && g.category?.name === filters.gameCategory)) return false;
    if (filters.gameTitle && user.analytics?.mostPlayedGame?.gameTitle !== filters.gameTitle) return false;
    return true;
  });

  if (filters.sortByMaxTimePlayed && filteredUsers) {
    filteredUsers = [...filteredUsers].sort(
      (a, b) => (b.analytics?.totalTimePlayed || 0) - (a.analytics?.totalTimePlayed || 0)
    );
  }


  return (
    <div className="px-3">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-[#D946EF] text-3xl font-boogaloo">
          User Management
        </h1>
        <div className="flex gap-3">
          <UserManagementFilterSheet
            filters={filters}
            onFiltersChange={handleFiltersChange}
            onReset={handleFilterReset}
          >
            <Button
              variant="outline"
              className="border-[#475568] text-[#475568] flex items-center gap-2 dark:text-white py-5"
            >
              Filter
              <div className='text-[#D946EF] bg-[#FAE8FF] px-3 py-1 rounded-full'>
                {Object.entries(filters).filter(([, value]) =>
                  typeof value === 'object'
                    ? Object.values(value).some(v => v !== '' && v !== 0)
                    : typeof value === 'boolean'
                      ? value === true
                      : value !== ''
                ).length}
              </div>
              <RiEqualizer2Line size={32} />
            </Button>
          </UserManagementFilterSheet>
          <ExportModal
            data={filteredUsers || []}
            title="Export User Data"
            description="Choose the format you'd like to export your user data"
          />
        </div>
      </div>
      <div className="col-span-1 md:col-span-2 lg:col-span-4">
        <Card className="bg-[#F1F5F9] dark:bg-[#121C2D] shadow-none border-none w-full">
          <div className="flex justify-between p-4 text-3xl">
            <p className="text-3xl dark:text-[#D946EF]">Recent User Activity</p>
            {/* <p className="text-xl cursor-pointer">View All</p> */}
          </div>
          {/* table */}
          <div className="px-4 pb-4">
            {isLoading ? (
              <div className="text-center py-4">Loading...</div>
            ) : !filteredUsers?.length ? (
              <NoResults
                title={users?.length ? "No matching results" : "No users found"}
                message={
                  users?.length
                    ? "Try adjusting your filters or search criteria"
                    : "There are no users in the system yet"
                }
              />
            ) : (
              <>
                <Table>
                  <TableHeader>
                    <TableRow className="text-xl text-bold">
                      <TableHead>Name</TableHead>
                      <TableHead>Email</TableHead>
                      <TableHead>Phone</TableHead>
                      <TableHead>Registration Date</TableHead>
                      <TableHead>Games Played</TableHead>
                      <TableHead>Time Played</TableHead>
                      <TableHead>Session count</TableHead>
                      <TableHead>Last Login</TableHead>
                    </TableRow>
                  </TableHeader>
                  <TableBody>
                    {filteredUsers &&
                      filteredUsers
                        .slice((page - 1) * usersPerPage, page * usersPerPage)
                        .map((user, idx) => (
                          <TableRow
                            key={idx}
                            className="font-pincuk text-md tracking-wider cursor-pointer hover:bg-[#f3e8ff] dark:hover:bg-[#23243a]"
                            onClick={() =>
                              navigate(`/admin/management/${user.id}`, {
                                state: { user },
                              })
                            }
                          >
                            <TableCell className="text-lg">{`${
                              user.firstName || ""
                            } ${user.lastName || ""}`}</TableCell>
                            <TableCell className="text-lg">
                              {user.email || "-"}
                            </TableCell>
                            <TableCell className="">
                              {user.phoneNumber || "-"}
                            </TableCell>
                            <TableCell>
                              {new Date(user.createdAt).toLocaleDateString()}
                            </TableCell>
                            <TableCell>
                              {user.analytics?.totalGamesPlayed || 0}
                            </TableCell>
                            <TableCell className="text-lg">
                              {formatTime(user.analytics?.totalTimePlayed || 0)}
                            </TableCell>
                            <TableCell>
                              {user.analytics?.totalSessionCount || 0}
                            </TableCell>
                            <TableCell>
                              <span className="flex items-center gap-2">
                                <div className="bg-[#94A3B7] p-2 rounded-lg">
                                  <span
                                    className={`inline-block w-2 h-2 rounded-full ${
                                      user.lastLoggedIn
                                        ? "bg-green-500"
                                        : "bg-red-500"
                                    }`}
                                  />
                                  <span className="rounded px-2 py-1 text-white font-semibold text-sm">
                                    {user.lastLoggedIn
                                      ? new Date(
                                          user.lastLoggedIn
                                        ).toLocaleTimeString("en-US", {
                                          hour: "2-digit",
                                          minute: "2-digit",
                                          hour12: true,
                                        })
                                      : "Never logged in"}
                                  </span>
                                </div>
                              </span>
                            </TableCell>
                          </TableRow>
                        ))}
                  </TableBody>
                </Table>
                <div className="flex justify-between items-center mt-4">
                  <span className="text-sm">
                    Showing {(page - 1) * usersPerPage + 1}-
                    {Math.min(page * usersPerPage, filteredUsers?.length || 0)}{" "}
                    from {filteredUsers?.length || 0} data
                  </span>
                  <div className="flex items-center gap-2 rounded-xl space-x-4 pr-1 pl-0.5 border border-[#D946EF] dark:text-white">
                    {Array.from(
                      {
                        length: Math.ceil(
                          (filteredUsers?.length || 0) / usersPerPage
                        ),
                      },
                      (_, i) => (
                        <button
                          key={i + 1}
                          className={`w-7 h-7 rounded-full ${
                            page === i + 1
                              ? "bg-[#D946EF] text-white"
                              : "bg-transparent text-[#D946EF]"
                          } hover:bg-[#f3e8ff]`}
                          onClick={() => setPage(i + 1)}
                        >
                          {i + 1}
                        </button>
                      )
                    )}
                  </div>
                </div>
              </>
            )}
          </div>
        </Card>
      </div>
    </div>
  );
}
</file>

<file path="src/pages/Admin/Settings.tsx">
import React, { useState } from "react";
import { FaChevronRight } from "react-icons/fa";
import { FaRegUser } from "react-icons/fa6";
import { MdLockOutline } from "react-icons/md";
import { IoDocumentTextOutline } from "react-icons/io5";
import { useNavigate } from "react-router-dom";
import ChangePasswordSheet from "../../components/single/ChangePassword-Sheet";
import { TermsSheet } from "../../components/single/Terms-Sheet";

const Settings: React.FC = () => {
  const [showChangePassword, setShowChangePassword] = useState(false);
  const [showTerms, setShowTerms] = useState(false);
  const navigate = useNavigate();

  const settings = [
    {
      icon: <FaRegUser size={16} />,
      title: "Profile",
      description: "Update your Profile",
      action: "Update",
      onClick: () => {
        navigate("/admin/view-profile");
      },
    },
    {
      icon: <MdLockOutline size={16} />,
      title: "Change Password",
      description: "Update your Password",
      action: "Update",
      onClick: () => {
        setShowChangePassword(true);
      },
    },
    {
      icon: <IoDocumentTextOutline size={16} />,
      title: "Accept Terms of Use",
      description: "Upload",
      action: "Upload",
      onClick: () => {
        setShowTerms(true);
      },
    },
  ];

  return (
    <div className="px-8">
      <h1 className="text-3xl font-bold text-[#D946EF] mb-8">Settings</h1>
      <div className="flex flex-col gap-6">
        {settings.map((item, _idx) => (
          <div
            key={item.title}
            onClick={item.onClick}
            className="bg-[#F5F7FB] dark:bg-[#181B2A] rounded-2xl px-6 py-6 flex items-center justify-between hover:bg-gray-200 cursor-pointer"
          >
            <div className="flex items-center gap-4">
              <div className="bg-[#F0ABFC] flex items-center justify-center rounded-full w-12 h-12 text-2xl text-white">
                {item.icon}
              </div>
              <div>
                <div className="text-md text-gray-900 dark:text-white">{item.title}</div>
                <div className="text-gray-500 font-pincuk text-lg tracking-wider dark:text-white">{item.description}</div>
              </div>
            </div>
            <FaChevronRight className="text-gray-900 dark:text-white"/>
          </div>
        ))}
      </div>
      <ChangePasswordSheet
        open={showChangePassword}
        onOpenChange={setShowChangePassword}
      />
      <TermsSheet
        open={showTerms}
        onOpenChange={setShowTerms}
      />
    </div>
  );
};

export default Settings;
</file>

<file path="src/pages/Admin/UserMgtView.tsx">
import { useState } from "react";
import { IoChevronBack } from "react-icons/io5";
import { useNavigate, useParams } from "react-router-dom";
import { LuGamepad2 } from "react-icons/lu";
import { FiClock } from "react-icons/fi";
import { TbCalendarClock } from "react-icons/tb";
import { useUserAnalyticsById } from "../../backend/analytics.service";
import { formatTime } from "../../utils/main";

const PAGE_SIZE = 5;

interface GameActivity {
  gameId: string;
  gameTitle: string;
  thumbnailUrl: string | null;
  sessionCount: number;
  totalPlayTime: number;
  lastPlayed: string;
}

const UserManagementView = () => {
  const navigate = useNavigate();
  const { userId } = useParams();
  const [page, setPage] = useState(1);
  const { data, isLoading, isError } = useUserAnalyticsById(userId || "");
  const response = data as any;

  const handleBack = () => {
    navigate("/admin/management");
  };

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="w-8 h-8 border-4 border-[#D946EF] border-t-transparent rounded-full animate-spin"></div>
      </div>
    );
  }

  if (isError || !response) {
    return (
      <div className="flex items-center justify-center h-screen">
        <div className="text-xl text-red-500">Failed to load user data</div>
      </div>
    );
  }

  // Get games array and handle pagination
  const games = response?.analytics?.gameActivity || [];
  const paginatedGames = games.slice((page - 1) * PAGE_SIZE, page * PAGE_SIZE);

  return (
    <div className="px-2 sm:px-4">
      <button
        className="flex items-center justify-center gap-2 text-[#475568] mb-2 border border-[#475568] rounded-lg w-auto py-2 px-3 shadow-md hover:bg-accent dark:text-white"
        onClick={handleBack}
      >
        <IoChevronBack />
        <p>Back</p>
      </button>
      <div className="flex flex-col lg:flex-row gap-6 py-6">
        <div className="w-full lg:w-72 flex flex-col items-center">
          <div className="w-full lg:w-72 bg-[#F1F5F9] rounded-2xl p-6 flex flex-col items-center mb-8 dark:bg-[#121C2D]">
            <img
              src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y"
              alt="Profile"
              className="w-20 h-20 rounded-full border-2 border-[#D946EF]"
            />
            <div className="flex flex-col sm:flex-row gap-3 items-center mt-4 text-center sm:text-left">
              <h2 className="mb-0 text-xl font-bold text-[#121C2D] dark:text-white tracking-wide break-all">
                {`${response.user.firstName || ""} ${
                  response.user.lastName || ""
                }`}
              </h2>
              <div className="flex items-center gap-2 flex-shrink-0">
                <span
                  className={`${
                    response.user.isActive ? "text-green-500" : "text-red-500"
                  } font-bold text-lg`}
                >
                  
                </span>
                <span className="text-gray-700  dark:text-white font-pincuk text-lg tracking-wider">
                  {response.user.role.name}
                </span>
              </div>
            </div>
            <div className="mt-2 text-sm text-gray-500 font-sans font-semibold dark:text-white flex flex-col sm:flex-row items-center gap-2 text-center sm:text-left">
              last login:{" "}
              <div className="flex items-center">
                <span className="bg-indigo-100 px-2 py-0 rounded text-gray-700 dark:bg-[#94A3B7] font-pincuk text-xl tracking-wider">
                  <span className="text-yellow-500 font-bold text-lg"></span>
                  {response.user.lastLoggedIn
                    ? new Date(response.user.lastLoggedIn).toLocaleTimeString(
                        "en-US",
                        {
                          hour: "2-digit",
                          minute: "2-digit",
                          hour12: true,
                        }
                      )
                    : "Never"}
                </span>
              </div>
            </div>
          </div>
          {/* Stats Cards */}
          <div className="w-full space-y-3">
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex gap-4">
              <div className="bg-[#F0ABFC] rounded-full px-3 py-3 items-center">
                <FiClock className="w-8 h-8  text-white dark:text-[#OF1621]" />
              </div>
              <div className="flex flex-col justify-start">
                <span className="text-[#475568] text-lg font mb-1 dark:text-white">
                  Minutes Played
                </span>
                <span className=" text-[#475568] font-pincuk text-lg tracking-wider dark:text-white">
                  {formatTime(response.analytics?.totalTimePlayed || 0)}
                </span>
              </div>
            </div>
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex gap-4">
              <div className="bg-[#F0ABFC] rounded-full px-3 py-3">
                <LuGamepad2 className="w-8 h-8 text-white dark:text-[#OF1621]" />
              </div>
              <div className="flex flex-col justify-start">
                <span className="text-[#475568] text-lg font mb-1 dark:text-white">
                  Total Plays
                </span>
                <span className=" text-[#475568] font-pincuk text-lg tracking-wider dark:text-white">
                  {response.analytics?.totalGamesPlayed || 0}
                </span>
              </div>
            </div>
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex-1 flex gap-4">
              <div className="bg-[#F0ABFC] rounded-full px-3 py-3">
                <TbCalendarClock className="w-8 h-8 text-white dark:text-[#OF1621]" />
              </div>
              <div className="flex flex-col justify-start">
                <span className="text-[#475568] text-lg font mb-1 dark:text-white">
                  Sessions
                </span>
                <span className=" text-[#475568] font-pincuk text-lg tracking-wider dark:text-white">
                  {response.analytics?.totalSessionCount || 0}
                </span>
              </div>
            </div>
          </div>
        </div>
        {/* RIGHT SIDE */}
        <div className="flex-1">
          {/* Profile Details */}
          <div className="bg-[#f6f8fc] rounded-2xl p-4 sm:p-6 mb-6 dark:bg-[#121C2D]">
            <h3 className="text-lg font-bold mb-4 text-[#121C2D] tracking-wide dark:text-white">
              Profile Details
            </h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-y-6 md:gap-x-16 lg:gap-x-96 space-y-border-b dark:text-white">
              <div className="text-fuchsia-500  tracking-wide">Name</div>
              <div className="text-[#334154] font-pincuk text-lg tracking-wider dark:text-white">{`${response.user.firstName} ${response.user.lastName}`}</div>
              <div className="text-fuchsia-500  tracking-wide">Email</div>
              <div className="text-[#334154] font-pincuk text-lg tracking-wider dark:text-white">
                {response.user.email}
              </div>
              <div className="text-fuchsia-500  tracking-wide">
                Mobile number
              </div>
              <div className="text-[#334154] font-pincuk text-lg tracking-wider dark:text-white">
                {response.user.phoneNumber || "-"}
              </div>
              <div className="text-fuchsia-500  tracking-wide">Country</div>
              <div className="text-[#334154] font-pincuk text-lg tracking-wider dark:text-white">
                {response?.user?.country || "-"}
              </div>
            </div>
          </div>
          {/* Games */}
          <div className="bg-[#f6f8fc] rounded-2xl p-4 sm:p-6 dark:bg-[#121C2D]">
            <div className="overflow-x-auto">
              <table className="w-full border-collapse min-w-[600px]">
                <thead>
                  <tr>
                    <th className="text-left pb-2 text-[#121C2D] text-lg tracking-wider dark:text-white">
                      Games
                    </th>
                    <th className="text-left pb-2 text-[#121C2D] text-lg tracking-wider dark:text-white">
                      Minutes played
                    </th>
                  </tr>
                </thead>
                <tbody>
                  {!games.length ? (
                    <tr>
                      <td colSpan={2} className="text-center py-8">
                        <div className="flex flex-col items-center gap-2">
                          <LuGamepad2 className="w-12 h-12 text-gray-400" />
                          <p className="text-lg font-semibold text-gray-500">
                            No games played yet
                          </p>
                          <p className="text-gray-400">
                            This user hasn't played any games yet.
                          </p>
                        </div>
                      </td>
                    </tr>
                  ) : (
                    paginatedGames.map((game: GameActivity, idx: number) => (
                      <tr key={idx} className="border-t border-gray-200">
                        <td className="flex items-center gap-3 py-2">
                          {/* Default game icon */}
                          <div className="w-10 h-10 rounded-lg bg-gray-200 flex items-center justify-center">
                            <LuGamepad2 className="w-6 h-6 text-gray-400" />
                          </div>
                          <span className="text-[#121C2D] text-lg tracking-wider dark:text-white">
                            {game.gameTitle || "Unknown Game"}
                          </span>
                        </td>
                        <td className="py-2 text-lg text-[#334154] font-pincuk tracking-wider dark:text-white">
                          {formatTime(game.totalPlayTime || 0)}
                        </td>
                      </tr>
                    ))
                  )}
                </tbody>
              </table>
            </div>
            {games.length > 0 && (
              <div className="flex flex-col sm:flex-row justify-between items-center gap-4 px-4 py-3 bg-[#F1F5F9] dark:bg-[#121C2D] rounded-b-xl mt-4">
                <span className="text-sm text-[#121C2D] dark:text-white">
                  Showing {(page - 1) * PAGE_SIZE + 1}-
                  {Math.min(page * PAGE_SIZE, games.length)} from {games.length}{" "}
                  data
                </span>
                {Math.ceil(games.length / PAGE_SIZE) > 1 && (
                  <div className="flex items-center gap-2 rounded-xl space-x-4 pr-1 pl-0.5 border border-[#D946EF] dark:text-white">
                    {Array.from(
                      { length: Math.ceil(games.length / PAGE_SIZE) },
                      (_, i) => (
                        <button
                          key={i + 1}
                          className={`w-7 h-7 rounded-full transition-colors ${
                            page === i + 1
                              ? "bg-[#D946EF] text-white dark:bg-gray-400"
                              : "bg-transparent text-[#D946EF] dark:text-gray-400 hover:bg-[#f3e8ff]"
                          }`}
                          onClick={() => setPage(i + 1)}
                        >
                          {i + 1}
                        </button>
                      )
                    )}
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
};

export default UserManagementView;
</file>

<file path="src/pages/Admin/ViewGame.tsx">
import { IoEyeOutline } from "react-icons/io5";
import { RiDeleteBin6Line } from "react-icons/ri";
import { CiEdit } from "react-icons/ci";
import { Button } from "../../components/ui/button";
import gameImg from "@/assets/gamesImg/1.svg";
import { IoChevronBack } from "react-icons/io5";
import { FiClock } from "react-icons/fi";
import { LuGamepad2 } from "react-icons/lu";
import { TbCalendarClock } from "react-icons/tb";
import { useNavigate, useParams } from "react-router-dom";
import { useGameAnalyticsById } from "../../backend/analytics.service";
import { useToggleGameStatus, useDeleteGame } from "../../backend/games.service";
import { toast } from "sonner";
import { DeleteConfirmationModal } from "../../components/modals/DeleteConfirmationModal";
import { ToggleGameStatusModal } from "../../components/modals/ToggleGameStatusModal";
import { useState } from "react";
import { EditSheet } from "../../components/single/Edit-Sheet";
import { formatTime } from "../../utils/main";

export default function ViewGame() {
  const { gameId } = useParams();
  const navigate = useNavigate();
  const { data: game, isLoading } = useGameAnalyticsById(gameId || '');
  const toggleStatus = useToggleGameStatus();
  const deleteGame = useDeleteGame();

  const handleBack = () => {
    navigate("/admin/game-management");
  };

  const [editOpen, setEditOpen] = useState(false);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [showDisableModal, setShowDisableModal] = useState(false);

  if (isLoading) {
    return (
      <div className="p-8 flex justify-center items-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-[#D946EF]"></div>
      </div>
    );
  }

  console.log("game data", game)

  return (
    <div className="p-8 flex flex-col gap-6">
      <button className="flex items-center justify-center gap-2 text-[#475568] mb-2 border border-[#475568] rounded-lg w-22 py-2 px-1 shadow-md hover:bg-accent dark:text-white" onClick={handleBack}>
        <IoChevronBack />
        <p>Back</p>
      </button>
      <div className="flex flex-col md:flex-row gap-6">
        {/* Left: Game Card */}
        <div className="bg-[#F1F5F9] dark:bg-[#334154] rounded-2xl p-6 flex flex-col items-center w-full md:w-1/3">
          <img
            src={(game as any)?.game.thumbnailFile?.url || gameImg}
            alt={(game as any).game?.description || 'Game'}
            className="w-28 h-28 rounded-full object-cover mb-4"
          />
          <div className="flex gap-2 items-center">
          <h2 className="text-xl font-bold font-boogaloo mb-2 text-[#121C2D] tracking-wider dark:text-white">{(game as any).game?.title || "-"}</h2>
          <span className={`inline-flex items-center gap-2 px-3 py-1 rounded font-pincuk text-xl tracking-wider mb-2 ${(game as any).game?.status === "active" ? "bg-[#D946EF]/20 dark:bg-[#E879F9] text-[#121C2D]" : "bg-[#CBD5E0] text-[#121C2D]"}`}>
            <span className={`w-2 h-2 rounded inline-block ${(game as any).game?.status === "active" ? "bg-[#419E6A]" : "bg-red-500"}`}></span>
            {(game as any).game?.status === "active" ? "Active" : "Inactive"}
          </span>
          <RiDeleteBin6Line className="text-[#121C2D] w-4 h-6 dark:text-white" />
          </div>
          {/* <p className="text-center text-[#475568] mb-4 text-sm dark:text-white tracking-wider font-pincuk text-xl tracking-wider">{(game as any).game?.description || "N/A"}</p> */}
          <div className="flex flex-col gap-2 w-full">
            <Button
              variant="outline"
              className="flex items-center justify-center gap-2 w-full border-2 border-[white] text-[#475568] bg-transparent dark:border-2 dark:border-white dark:text-white"
              onClick={() => setEditOpen(true)}
            >
              Edit <CiEdit className="dark:text-white" />
            </Button>
            <Button
              className="flex items-center justify-center gap-2 w-full bg-[#D946EF] text-white tracking-wider hover:bg-[#c026d3]"
              onClick={() => setShowDisableModal(true)}
            >
              {(game as any).game?.status === "active" ? "Disable" : "Enable"} <IoEyeOutline />
            </Button>
            <Button className="flex items-center justify-center gap-2 w-full bg-[#EF4444] text-white tracking-wider hover:bg-[#dc2626]"
              onClick={() => setShowDeleteModal(true)}
            >
              Delete <RiDeleteBin6Line />
            </Button>
          </div>
        </div>
        {/* Right: Details */}
        <div className="flex-1 flex flex-col gap-6">
          <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-6">
            <h3 className="text-xl font-bold mb-2 text-[#475568] tracking-wider dark:text-white">Overview</h3>
            <p className="text-[#475568]  whitespace-pre-line dark:text-white  font-pincuk text-lg tracking-wider">{(game as any).game?.description || "-"}</p>
          </div>
          <div className="flex flex-col md:flex-row gap-4">
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex-1">
              <h4 className="font-bold mb-1 text-[#475568] tracking-wider text-lg dark:text-white">Game Category</h4>
              <p className=" text-[#475568] dark:text-white  font-pincuk text-lg tracking-wider">{(game as any).game?.category?.name || "-"}</p>
            </div>
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex-1">
              <h4 className="font-bold mb-1 text-[#475568] dark:text-white">Game Code</h4>
              <a href={(game as any).game?.gameFile?.url || "#"} className="text-[#475568]  underline dark:text-white  font-pincuk text-lg tracking-wider" target="_blank" rel="noopener noreferrer">{(game as any).game?.gameFile?.url || "#"}</a>
            </div>
          </div>
          <div>
            <p className="text-[#18192b] text-xl border-b dark:text-white">Game Metrics</p>
          </div>
          <div className="flex flex-col md:flex-row gap-4">

            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex gap-4">
              <div className="bg-[#F0ABFC] rounded-full px-3 py-3 items-center">
              <FiClock className='w-8 h-8  text-white dark:text-[#OF1621]' />
              </div>
              <div className="flex flex-col justify-start">
              <span className="text-[#475568] text-lg font mb-1 dark:text-white">Minutes Played</span>
              <span className="text-sm text-[#475568] font-sans dark:text-white">{formatTime(game?.analytics?.totalPlayTime || 0)}</span>
              </div>
            </div>
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex gap-4">
              <div className="bg-[#F0ABFC] rounded-full px-3 py-3">
              <LuGamepad2 className='w-8 h-8 text-white dark:text-[#OF1621]' />
              </div>
              <div className="flex flex-col justify-start">
              <span className="text-[#475568] text-lg font mb-1 dark:text-white">Total Plays</span>
              <span className="text-sm text-[#475568] font-sans dark:text-white">{game?.analytics?.uniquePlayers ?? "-"}</span>
              </div>
            </div>
            <div className="bg-[#F1F5F9] dark:bg-[#121C2D] rounded-2xl p-4 flex-1 flex gap-4">
               <div className="bg-[#F0ABFC] rounded-full px-3 py-3">
               <TbCalendarClock className='w-8 h-8 text-white dark:text-[#OF1621]'/>
               </div>
             <div className="flex flex-col justify-start">
              <span className="text-[#475568] text-lg font mb-1 dark:text-white">Sessions</span>
              <span className="text-sm text-[#475568] font-sans dark:text-white">{game?.analytics?.totalSessions ?? "-"}</span>
             </div>
            </div>

          </div>
        </div>
      </div>

      {/* Toggle Game Status Modal */}
      <ToggleGameStatusModal
        open={showDisableModal}
        onOpenChange={setShowDisableModal}
        gameStatus={(game as any)?.game?.status || 'disabled'}
        gameTitle={(game as any)?.game?.title || 'this game'}
        isToggling={toggleStatus.isPending}
        onConfirm={async () => {
          try {
            await toggleStatus.mutateAsync({
              gameId: gameId || '',
              currentStatus: (game as any)?.game?.status || 'disabled'
            });
            toast.success(`Game ${(game as any)?.game?.status === "active" ? "disabled" : "enabled"} successfully`);
            setShowDisableModal(false);
          } catch (error) {
            toast.error("Failed to update game status");
          }
        }}
      />

      {/* Delete Confirmation Modal */}
      <DeleteConfirmationModal
        open={showDeleteModal}
        onOpenChange={setShowDeleteModal}
        onConfirm={async () => {
          try {
            await deleteGame.mutateAsync(gameId || '');
            toast.success("Game deleted successfully");
            navigate("/admin/game-management");
          } catch (error) {
            toast.error("Failed to delete game");
          }
        }}
        isDeleting={deleteGame.isPending}
      />

      {/* Edit Sheet */}
      <EditSheet
        open={editOpen}
        onOpenChange={setEditOpen}
        gameId={gameId || ''}
      />
    </div>
  );
}
</file>

<file path="src/pages/Admin/ViewProfile.tsx">
import { CiEdit } from "react-icons/ci";
import { Button } from "../../components/ui/button";
import { IoChevronBack } from "react-icons/io5";
import { useNavigate } from "react-router-dom";
import EditProfileSheet from "../../components/single/EditProfile-Sheet";
import { useState } from "react";
import { useUserData } from "../../backend/user.service";

export default function ViewProfile() {
  const { data: user, isLoading } = useUserData();
  const navigate = useNavigate();
  const [editOpen, setEditOpen] = useState(false);

  const handleBack = () => {
    navigate("/admin/settings");
  };

  if (isLoading) {
    return (
      <div className="px-8 flex items-center justify-center h-96">
        <div className="w-8 h-8 border-4 border-[#D946EF] border-t-transparent rounded-full animate-spin"></div>
      </div>
    );
  }

  if (!user) {
    return (
      <div className="px-8 flex items-center justify-center h-96">
        <p className="text-gray-500">Failed to load profile</p>
      </div>
    );
  }

  return (
    <div className="px-8 flex flex-col gap-6">
      <Button
        className="flex items-center justify-center gap-2 text-[#121C2D] mb-2 border border-gray-400 rounded-lg w-22 py-2 px-1 hover:bg-transparent bg-transparent dark:text-white"
        onClick={handleBack}
      >
        <IoChevronBack />
        <p>Back</p>
      </Button>
      <div className="flex flex-col md:flex-row gap-8">
        {/* LEFT: Profile Card */}
        <div className="flex flex-col items-center">
          <div className="w-96 bg-[#f6f8fc] rounded-2xl p-6 flex flex-col items-center mb-8 dark:bg-[#334154]">
            <img
              src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y"
              alt="Profile"
              className="w-20 h-20 rounded-full border-2 border-[#D946EF]"
            />
            <div className="flex gap-3 items-center mt-4">
              <h2 className="mb-0 text-xl font-semibold text-[#121C2D] dark:text-white tracking-wider">
                {user.firstName} {user.lastName}
              </h2>
              <div className="flex items-center gap-2">
                <span className="text-green-500 font-bold text-lg"></span>
                <span className="text-gray-700 dark:text-white font-pincuk text-lg tracking-wider">{user.role?.name || 'User'}</span>
              </div>
            </div>
            <Button
                className="w-full mt-3 border border-white bg-transparent shadow-none text-[#121C2D] h-14 hover:bg-[#3b495d] dark:text-white"
                onClick={() => setEditOpen(true)}
            >
                Edit <CiEdit />
            </Button>
            <EditProfileSheet
                open={editOpen}
                onOpenChange={setEditOpen}
                profile={{
                    firstName: user.firstName,
                    lastName: user.lastName,
                    email: user.email,
                    phone: user.phoneNumber || '',
                }}
            />
          </div>
        </div>
        {/* RIGHT: Profile Details */}
        <div className="flex-1 flex flex-col items-center md:items-start ">
          <div className="bg-[#f6f8fc] rounded-2xl p-8 mb-6 dark:bg-[#121C2D] w-full">
            <h3 className="text-xl mb-4 text-[#121C2D] tracking-wide dark:text-white">Profile Details</h3>
            <div className="grid grid-cols-2 gap-y-6 gap-x-8 dark:text-white space-y-6">
              <div className="text-fuchsia-500 tracking-wide text-lg">Name</div>
              <div className="text-[#334154] font-pincuk text-xl tracking-wider dark:text-white whitespace-pre-line">
                {user.firstName} {user.lastName}
              </div>
              <div className="text-fuchsia-500 tracking-wide text-lg">Email</div>
              <div className="text-[#334154] font-pincuk text-xl tracking-wider dark:text-white">{user.email}</div>
              <div className="text-fuchsia-500 tracking-wide text-lg">Mobile number</div>
              <div className="text-[#334154] font-pincuk text-xl tracking-wider dark:text-white">{user.phoneNumber || 'Not provided'}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/pages/Categories/Categories.tsx">
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { useCategories } from '../../backend/category.service';
import { useGames } from '../../backend/games.service';
import GamesSkeleton from '../../components/single/GamesSkeleton';
import type { Category } from '../../backend/types';

import emptyGameImg from "../../assets/empty-game.png";

const secondary = [
  "Recently Added", "Popular", "Recommended for you"
];

export default function Categories() {
  const navigate = useNavigate();
  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);
  const [selectedSecondary, setSelectedSecondary] = useState<string | null>(null);
  const [showMobileCategories, setShowMobileCategories] = useState(false);

  const { data: categoriesData, isLoading: categoriesLoading, error: categoriesError } = useCategories();
  const { data: gamesData, isLoading: gamesLoading, error: gamesError } = useGames({
    categoryId: selectedCategory || undefined,
    filter: selectedSecondary ?
      selectedSecondary === "Recently Added" ? "recently_added" :
      selectedSecondary === "Popular" ? "popular" :
      selectedSecondary === "Recommended for you" ? "recommended" :
      undefined
    : undefined,
    status: "active"
  });


  const categories = (categoriesData || []) as Category[];
  const games: any = gamesData || [];

  return (
    <div className="flex flex-col lg:flex-row min-h-[calc(100vh-80px)] bg-white dark:bg-[#0f1221]">
      {/* Mobile Category Selector */}
      <div className="lg:hidden bg-transparent py-4 px-4 border-b border-gray-200 dark:border-gray-700">
        {categoriesLoading ? (
          <div className="text-center text-sm">Loading categories...</div>
        ) : categoriesError ? (
          <div className="text-center text-red-500 text-sm">Error loading categories</div>
        ) : (
          <div className="space-y-3">
            {/* Current Selection Display & Toggle */}
            <button
              onClick={() => setShowMobileCategories(!showMobileCategories)}
              className="w-full flex items-center justify-between px-4 py-3 bg-gray-100 dark:bg-gray-800 rounded-lg text-left"
            >
              <span className="font-semibold text-[#121C2D] dark:text-white">
                {selectedCategory
                  ? categories.find(cat => cat.id === selectedCategory)?.name
                  : selectedSecondary
                  ? selectedSecondary
                  : "All Categories"}
              </span>
              <svg
                className={`w-5 h-5 text-[#121C2D] dark:text-white transition-transform ${showMobileCategories ? 'rotate-180' : ''}`}
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
              </svg>
            </button>

            {/* Collapsible Category List */}
            {showMobileCategories && (
              <div className="bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 shadow-lg max-h-80 overflow-y-auto">
                <div className="p-2">
                  {/* All Categories Option */}
                  <button
                    className={`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition
                      ${!selectedCategory && !selectedSecondary
                        ? 'bg-[#D946EF] text-white'
                        : 'text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white dark:hover:bg-gray-800'}
                    `}
                    onClick={() => {
                      setSelectedCategory(null);
                      setSelectedSecondary(null);
                      setShowMobileCategories(false);
                    }}
                  >
                    All Categories
                  </button>

                  {/* Category Divider */}
                  {categories.length > 0 && (
                    <div className="border-t border-gray-200 dark:border-gray-700 my-2" />
                  )}

                  {/* Primary Categories */}
                  {categories.map(cat => (
                    <button
                      key={cat.id}
                      className={`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition
                        ${selectedCategory === cat.id
                          ? 'bg-[#D946EF] text-white'
                          : 'text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white dark:hover:bg-gray-800'}
                      `}
                      onClick={() => {
                        setSelectedCategory(cat.id);
                        setSelectedSecondary(null);
                        setShowMobileCategories(false);
                      }}
                    >
                      {cat.name}
                    </button>
                  ))}

                  {/* Secondary Categories Divider */}
                  <div className="border-t border-gray-200 dark:border-gray-700 my-2" />

                  {/* Secondary Categories */}
                  {secondary.map(sec => (
                    <button
                      key={sec}
                      className={`w-full text-left px-3 py-2 rounded-md text-sm font-medium transition
                        ${selectedSecondary === sec
                          ? 'bg-[#D946EF] text-white'
                          : 'text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white dark:hover:bg-gray-800'}
                      `}
                      onClick={() => {
                        setSelectedSecondary(sec);
                        setSelectedCategory(null);
                        setShowMobileCategories(false);
                      }}
                    >
                      {sec}
                    </button>
                  ))}
                </div>
              </div>
            )}
          </div>
        )}
      </div>

      {/* Desktop Sidebar */}
      <aside className="hidden lg:flex w-56 min-w-[220px] bg-transparent py-6 px-2 flex-col gap-2">
        {categoriesLoading ? (
          <div className="p-4 text-center">Loading categories...</div>
        ) : categoriesError ? (
          <div className="p-4 text-center text-red-500">Error loading categories</div>
        ) : (
          <div>
            <nav>
              <ul className="flex flex-col gap-1">
                <li>
                  <button
                    className={`w-full flex items-center gap-2 px-4 py-2 text-2xl rounded-lg font-bold tracking-widest transition
                      ${!selectedCategory && !selectedSecondary
                        ? 'bg-[#D946EF] text-white dark:text-white tracking-wider'
                        : 'bg-transparent text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white tracking-wider'}
                    `}
                    onClick={() => { setSelectedCategory(null); setSelectedSecondary(null); }}
                  >
                    All
                  </button>
                </li>
                {categories.map(cat => (
                  <li key={cat.id}>
                    <button
                      className={`w-full text-left text-2xl px-4 py-2 rounded-lg font-semibold transition
                        ${selectedCategory === cat.id
                          ? 'bg-[#D946EF] text-white shadow dark:text-white tracking-wider'
                          : 'text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white tracking-wider'}
                      `}
                      onClick={() => { setSelectedCategory(cat.id); setSelectedSecondary(null); }}
                    >
                      {cat.name}
                    </button>
                  </li>
                ))}
              </ul>
            </nav>
            <div className="border-t border-[#E5E7EB] my-4" />
            <nav>
              <ul className="flex flex-col gap-1 tracking-widest">
                {secondary.map(sec => (
                  <li key={sec}>
                    <button
                      className={`w-full text-left text-2xl px-4 py-2 rounded-lg font-semibold text-[#121C2D] hover:bg-[#F3E8FF] hover:text-[#D946EF] dark:text-white tracking-wider transition ${selectedSecondary === sec ? 'bg-[#D946EF] text-white' : ''}`}
                      onClick={() => { setSelectedSecondary(sec); setSelectedCategory(null); }}
                    >
                      {sec}
                    </button>
                  </li>
                ))}
              </ul>
            </nav>
          </div>
        )}
      </aside>
      {/* Main Content */}
      <div className="flex-1 p-4 lg:p-8">
        {gamesLoading ? (
          <GamesSkeleton count={9} showCategories={true} />
        ) : gamesError ? (
          <div className="text-center py-8 text-red-500">Error loading games</div>
        ) : (
          <div className="flex flex-col">
            {games.length === 0 ? (
              <div className="text-center py-8 min-h-[60vh] flex flex-col items-center justify-center gap-4 text-[#C026D3] text-2xl lg:text-4xl">
                  <img src={emptyGameImg} alt="No games" className="w-40 h-40 lg:w-80 lg:h-80 object-contain" />
                No games found {selectedCategory ? "in this category" : selectedSecondary ? "for this filter" : ""}
              </div>
            ) : (
              <div className="grid gap-3 lg:gap-4 w-full grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
              {games.map((game: any, index: number) => {
                const spans = [1, 1.3, 1.1];
                const spanIndex = index % spans.length;
                const rowSpan = spans[spanIndex];

                return (
                  <div
                    key={game.id}
                    className="relative group cursor-pointer"
                    style={{ gridRow: `span ${Math.round(rowSpan * 2)}` }}
                    onClick={() => navigate(`/gameplay/${game.id}`)}
                  >
                    <div className="relative h-full overflow-hidden rounded-[20px]">
                      <img
                        src={game.thumbnailFile?.s3Key}
                        alt={game.title}
                        loading="lazy"
                        className="w-full h-full object-cover border-4 border-transparent group-hover:border-[#D946EF] transition-all duration-300 ease-in-out group-hover:scale-105 group-hover:shadow-[0_0_20px_rgba(217,70,239,0.3)]"
                      />
                      <div className="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent">
                        <span className="absolute bottom-3 left-4 text-white font-bold text-lg lg:text-xl drop-shadow-lg">
                          {game.title}
                        </span>
                      </div>
                    </div>
                  </div>
                );
              })}
              </div>
            )}
          </div>
        )}
      </div>
    </div>
  );
}
</file>

<file path="src/pages/GamePlay/GamePlay.tsx">
import { useState, useEffect, useRef } from "react";
import { useAuth } from "../../context/AuthContext";
import { Card } from "../../components/ui/card";
import { LuExpand, LuX } from "react-icons/lu";
import KeepPlayingModal from "../../components/modals/KeepPlayingModal";
import { useParams, useNavigate, useLocation } from "react-router-dom";
import { useGameById } from "../../backend/games.service";
import {
  useCreateAnalytics,
  useUpdateAnalytics,
} from "../../backend/analytics.service";
import type { SimilarGame } from "../../backend/types";
import GameLoadingScreen from "../../components/single/GameLoadingScreen";

export default function GamePlay() {
  const { gameId } = useParams();
  const navigate = useNavigate();
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [isSignUpModalOpen, setIsSignUpModalOpen] = useState(false);
  const { data: game, isLoading, error } = useGameById(gameId || "");
  const { mutate: createAnalytics } = useCreateAnalytics();
  const analyticsIdRef = useRef<string | null>(null);

  const handleOpenSignUpModal = () => {
    setIsSignUpModalOpen(true);
  };

  const [expanded, setExpanded] = useState(false);
  const [isGameLoading, setIsGameLoading] = useState(true);
  const [loadProgress, setLoadProgress] = useState(0);
  const [timeRemaining, setTimeRemaining] = useState<number | null>(null);
  const { isAuthenticated } = useAuth();

  console.log(isSignUpModalOpen, timeRemaining);

  useEffect(() => {
    if (game?.gameFile?.s3Key) {
      const timer = setTimeout(() => {
        setIsGameLoading(false);
        setLoadProgress(100);
      }, 5000);

      return () => clearTimeout(timer);
    }
  }, [game]);

  // Timer for non-authenticated users - starts after game is loaded
  useEffect(() => {
    let timer: NodeJS.Timeout;

    if (game && !isAuthenticated && game.config > 0 && !isGameLoading) {
      setIsModalOpen(false);
      setTimeRemaining(game.config * 60);

      timer = setInterval(() => {
        setTimeRemaining(prev => {
          if (prev === null || prev <= 0) {
            clearInterval(timer);
            setIsModalOpen(true);
            return 0;
          }
          return prev - 1;
        });
      }, 1000);
    }

    return () => {
      if (timer) {
        clearInterval(timer);
        setIsModalOpen(false);
      }
    };
  }, [game, isAuthenticated, isGameLoading]);

  // Create analytics record when game starts
  useEffect(() => {
    if (game && isAuthenticated) {
      createAnalytics(
        {
          gameId: game.id,
          activityType: "game_session",
          startTime: new Date(),
        },
        {
          onSuccess: (response) => {
            analyticsIdRef.current = response.id;
          },
        }
      );
    }
  }, [game, isAuthenticated, createAnalytics]);

  const location = useLocation();
  const { mutate: updateAnalytics } = useUpdateAnalytics();

  // Function to update end time
  const updateEndTime = async () => {
    if (!analyticsIdRef.current) return;

    try {
      const endTime = new Date();
      await updateAnalytics({
        id: analyticsIdRef.current,
        endTime,
      });
      // Clear ID after successful update to prevent duplicate updates
      analyticsIdRef.current = null;
    } catch (error) {
      console.error('Failed to update analytics:', error);
    }
  };

  // Handle route changes
  useEffect(() => {
    if (analyticsIdRef.current) {
      updateEndTime();
    }
  }, [location]);

  // Handle tab visibility and cleanup
  useEffect(() => {
    const handleVisibilityChange = () => {
      if (document.hidden && analyticsIdRef.current) {
        updateEndTime();
      }
    };

    const handleBeforeUnload = () => {
      if (analyticsIdRef.current) {
        const endTime = new Date();
        const baseURL = import.meta.env.VITE_API_URL ?? 'http://localhost:5000';
        const url = `${baseURL}/api/analytics/${analyticsIdRef.current}/end`;
        const data = new Blob([JSON.stringify({ endTime })], {
          type: 'application/json',
        });
        navigator.sendBeacon(url, data);
        analyticsIdRef.current = null;
      }
    };

    document.addEventListener("visibilitychange", handleVisibilityChange);
    window.addEventListener('beforeunload', handleBeforeUnload);

    return () => {
      if (analyticsIdRef.current) {
        updateEndTime();
      }
      document.removeEventListener("visibilitychange", handleVisibilityChange);
      window.removeEventListener('beforeunload', handleBeforeUnload);

      const iframe = document.querySelector<HTMLIFrameElement>("#gameIframe");
      if (iframe) {
        iframe.src = "about:blank";
      }
    };
  }, []);

  // Handle game loading progress
  const handleLoadProgress = (progress: number) => {
    setLoadProgress(progress);
  };

  return (
    <div>
      {isLoading ? (
        <div className="flex items-center justify-center h-[80vh]">
          <span className="text-xl">Loading game...</span>
        </div>
      ) : error ? (
        <div className="flex items-center justify-center h-[80vh]">
          <span className="text-xl text-red-500">
            {error instanceof Error ? error.message : "Error loading game"}
          </span>
        </div>
      ) : game?.gameFile?.s3Key ? (
        <>
          <div className={expanded ? "fixed inset-0 z-40 bg-black" : "relative"}>
            <div
              className={`relative ${
                expanded
                  ? "h-screen w-full"
                  : "w-full"
              } overflow-hidden`}
              // style={{ background: "#18181b" }}
            >
              {isGameLoading && (
                <GameLoadingScreen
                  game={game}
                  onProgress={handleLoadProgress}
                  progress={loadProgress}
                />
              )}
              <iframe
                src={`${game.gameFile.s3Key}`}
                className={`w-full`}
                style={{
                  display: "block",
                  // background: "transparent",
                  height: expanded ? "calc(100% - 60px)" : "100vh",
                  border: "none"
                }}
                sandbox="allow-scripts allow-same-origin allow-forms allow-popups"
                title={game.title}
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                scrolling="no"
                onLoad={() => {
                  setLoadProgress(100);
                }}
              />
              <KeepPlayingModal
                open={isModalOpen}
                openSignUpModal={handleOpenSignUpModal}
                isGameLoading={isGameLoading}
              />
              {expanded && (
                <div className="absolute bottom-0 left-0 right-0 flex items-center justify-between px-6 py-2 bg-[#2d0036] border-t border-purple-400 z-50">
                  <span className="text-white text-sm font-semibold">
                    {game.title}
                  </span>
                  <div className="flex items-center space-x-4">
                    <div className="flex items-center space-x-2">
                      <span role="img" aria-label="smile" className="text-xl">
                        
                      </span>
                      <span role="img" aria-label="smile" className="text-xl">
                        
                      </span>
                    </div>
                    <div className="flex items-center space-x-3">
                      <button
                        className="text-white hover:text-purple-400 transition-colors"
                        onClick={() => setExpanded((e) => !e)}
                        title={expanded ? "Exit Fullscreen" : "Expand"}
                      >
                        <LuExpand className="w-5 h-5" />
                      </button>
                      <button
                        className="text-white hover:text-purple-400 transition-colors"
                        onClick={() => {
                          if (analyticsIdRef.current) {
                            updateEndTime();
                          }
                          navigate(-1);
                        }}
                        title="Close Game"
                      >
                        <LuX className="w-5 h-5" />
                      </button>
                    </div>
                  </div>
                </div>
              )}
            </div>
            {!expanded && (
              <div className="flex items-center justify-between px-6 py-2 bg-[#2d0036] border-t border-purple-400 rounded-b-2xl">
                <span className="text-white text-sm font-semibold">
                  {game.title}
                </span>
                <div className="flex items-center space-x-4">
                  <div className="flex items-center space-x-2">
                    <span role="img" aria-label="smile" className="text-xl">
                      
                    </span>
                    <span role="img" aria-label="smile" className="text-xl">
                      
                    </span>
                  </div>
                  <div className="flex items-center space-x-3">
                    <button
                      className="text-white hover:text-purple-400 transition-colors"
                      onClick={() => setExpanded((e) => !e)}
                      title={expanded ? "Exit Fullscreen" : "Expand"}
                    >
                      <LuExpand className="w-5 h-5" />
                    </button>
                    <button
                      className="text-white hover:text-purple-400 transition-colors"
                      onClick={() => {
                        if (analyticsIdRef.current) {
                          updateEndTime();
                        }
                        navigate(-1);
                      }}
                      title="Close Game"
                    >
                      <LuX className="w-5 h-5" />
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>

          {/* Similar Games section */}
          {!expanded && game.similarGames && game.similarGames.length > 0 && (
            <div className="dark:bg-[#18181b] p-2">
              <h2 className="text-2xl font-semibold dark:text-white text-[#18181b] mb-4 px-4">
                Similar Games
              </h2>
              <Card className="border-hidden shadow-none p-0 bg-transparent">
                <div className="grid gap-[8px] w-full grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-5 justify-items-center">
                  {game.similarGames.map((similarGame: SimilarGame) => (
                    <div key={similarGame.id} className="relative p-[10px] group cursor-pointer w-full max-w-[360px]">
                      <img
                        src={similarGame.thumbnailFile?.s3Key}
                        alt={similarGame.title}
                        loading="lazy"
                        className="w-full h-[290px] min-h-[290px] max-h-[290px] object-cover rounded-[18px] border-4 border-transparent group-hover:border-[#D946EF] transition-all duration-300 ease-in-out group-hover:scale-105 group-hover:shadow-[0_0_20px_rgba(217,70,239,0.3)]"
                        onClick={() => {
                          if (analyticsIdRef.current) {
                            updateEndTime();
                          }
                          navigate(`/gameplay/${similarGame.id}`);
                        }}
                      />
                    </div>
                  ))}
                </div>
              </Card>
            </div>
          )}
        </>
      ) : (
        <div className="flex items-center justify-center h-[80vh]">
          <span className="text-xl">
            Game not found or no game file available
          </span>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/pages/Home/Home.tsx">
import { useState, useEffect } from 'react';
import AllGamesSection from '../../components/single/AllGamesSection'
import PopularSection from '../../components/single/PopularSection'
import { SignUpModal } from '../../components/modals/SignUpModal';
import { LoginModal } from '../../components/modals/LoginModal';
import { useAuth } from '../../context/AuthContext';

function Home() {
  const [isSignUpModalOpen, setIsSignUpModalOpen] = useState(false);
  const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);
  const [searchQuery, setSearchQuery] = useState("");
  const { keepPlayingRedirect, setKeepPlayingRedirect } = useAuth();

  useEffect(() => {
    if (keepPlayingRedirect) {
      setIsSignUpModalOpen(true);
      setKeepPlayingRedirect(false);
    }
  }, [keepPlayingRedirect, setKeepPlayingRedirect]);

  const handleOpenSignUpModal = () => {
    setIsSignUpModalOpen(true);
  };


  const handleOpenLoginModal = () => {
    setIsSignUpModalOpen(false);
    setIsLoginModalOpen(true);
  };

  return (
    <div className='font-boogaloo'>
      <PopularSection searchQuery={searchQuery} setSearchQuery={setSearchQuery} />
      <AllGamesSection searchQuery={searchQuery} />
      <SignUpModal
        open={isSignUpModalOpen}
        onOpenChange={setIsSignUpModalOpen}
        openLoginModal={handleOpenLoginModal}
      />
      <LoginModal
        open={isLoginModalOpen}
        onOpenChange={setIsLoginModalOpen}
        openSignUpModal={handleOpenSignUpModal}
      />
    </div>
  )
}

export default Home
</file>

<file path="src/pages/PrivacyPolicy/Privacy.tsx">
export default function Privacy() {
  return (
    <div>Privacy</div>
  )
}
</file>

<file path="src/pages/RegisterInvitation/index.ts">
export { RegisterInvitationPage } from './RegisterInvitationPage';
</file>

<file path="src/pages/RegisterInvitation/RegisterForm.tsx">
import { useState } from 'react';
import { Formik, Form, Field, ErrorMessage } from 'formik';
import type { FieldProps } from 'formik';
import * as Yup from 'yup';
import { Input } from '../../components/ui/input';
import { Button } from '../../components/ui/button';
import { Label } from '../../components/ui/label';
import { useRegisterFromInvitation } from '../../backend/teams.service';
import { passwordSchema, confirmPasswordSchema } from '../../validation/password';
import PhoneInput from 'react-phone-input-2';
import 'react-phone-input-2/lib/style.css';
import '../../styles/phone-input.css';
import { FaEye, FaEyeSlash } from 'react-icons/fa';

interface RegisterFormProps {
  email: string;
  token: string;
  onSuccess: () => void;
}

const validationSchema = Yup.object({
  firstName: Yup.string().trim().required('First name is required'),
  lastName: Yup.string().trim().required('Last name is required'),
  password: passwordSchema,
  confirmPassword: confirmPasswordSchema,
  phoneNumber: Yup.string().required('Phone number is required')
});

interface FormValues {
  firstName: string;
  lastName: string;
  password: string;
  confirmPassword: string;
  phoneNumber: string;
}

// Format phone number
const formatPhoneNumber = (value?: string) => (value ? `+${value}` : value);

export function RegisterForm({ email, token, onSuccess }: RegisterFormProps) {
  const { mutate: register, isPending } = useRegisterFromInvitation();
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  const togglePasswordVisibility = () => setShowPassword(!showPassword);
  const toggleConfirmPasswordVisibility = () => setShowConfirmPassword(!showConfirmPassword);

  const initialValues: FormValues = {
    firstName: '',
    lastName: '',
    password: '',
    confirmPassword: '',
    phoneNumber: ''
  };

  const handleSubmit = (values: FormValues) => {
    register(
      {
        token,
        data: {
          ...values,
          email
        }
      },
      {
        onSuccess
      }
    );
  };

  return (
    <Formik
      initialValues={initialValues}
      validationSchema={validationSchema}
      onSubmit={handleSubmit}
    >
      {({ isSubmitting }) => (
        <Form className="space-y-6">
          <div>
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              value={email}
              disabled
              className="mt-1 w-full bg-gray-100 dark:bg-[#1F2937]"
            />
          </div>

          <div>
            <Label htmlFor="firstName">First Name</Label>
            <Field
              as={Input}
              id="firstName"
              name="firstName"
              type="text"
              className="mt-1 w-full"
            />
            <ErrorMessage
              name="firstName"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <div>
            <Label htmlFor="lastName">Last Name</Label>
            <Field
              as={Input}
              id="lastName"
              name="lastName"
              type="text"
              className="mt-1 w-full"
            />
            <ErrorMessage
              name="lastName"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <div>
            <Label htmlFor="phoneNumber">Phone Number</Label>
            <Field name="phoneNumber">
              {({ field, form }: FieldProps) => (
                <div className="w-full mt-1">
                  <PhoneInput
                    country="us"
                    value={field.value}
                    onChange={(value) => form.setFieldValue('phoneNumber', formatPhoneNumber(value))}
                    inputStyle={{
                      width: "100%",
                      height: "48px",
                      backgroundColor: "#E2E8F0",
                      border: "0",
                      borderRadius: "0.375rem",
                      fontFamily: "pincuk",
                      fontSize: "11px"
                    }}
                    containerClass="dark:bg-[#191c2b] z-[999]"
                    buttonStyle={{
                      backgroundColor: "#E2E8F0",
                      border: "0",
                      borderRadius: "0.375rem 0 0 0.375rem"
                    }}
                    dropdownStyle={{
                      backgroundColor: "#E2E8F0",
                      color: "#000"
                    }}
                    searchStyle={{
                      backgroundColor: "#E2E8F0",
                      color: "#000"
                    }}
                    enableAreaCodeStretch
                    autoFormat
                    enableSearch
                    disableSearchIcon
                    autocompleteSearch
                    countryCodeEditable={false}
                  />
                </div>
              )}
            </Field>
            <ErrorMessage
              name="phoneNumber"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <div>
            <Label htmlFor="password">Password</Label>
            <div className="relative">
              <button
                type="button"
                onClick={togglePasswordVisibility}
                className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                aria-label={showPassword ? "Hide password" : "Show password"}
              >
                {showPassword ? (
                  <FaEyeSlash size={15} />
                ) : (
                  <FaEye size={15} />
                )}
              </button>
              <Field
                as={Input}
                id="password"
                name="password"
                type={showPassword ? "text" : "password"}
                className="mt-1 w-full pl-10"
              />
            </div>
            <ErrorMessage
              name="password"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <div>
            <Label htmlFor="confirmPassword">Confirm Password</Label>
            <div className="relative">
              <button
                type="button"
                onClick={toggleConfirmPasswordVisibility}
                className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                aria-label={showConfirmPassword ? "Hide password" : "Show password"}
              >
                {showConfirmPassword ? (
                  <FaEyeSlash size={15} />
                ) : (
                  <FaEye size={15} />
                )}
              </button>
              <Field
                as={Input}
                id="confirmPassword"
                name="confirmPassword"
                type={showConfirmPassword ? "text" : "password"}
                className="mt-1 w-full pl-10"
              />
            </div>
            <ErrorMessage
              name="confirmPassword"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <Button
            type="submit"
            className="w-full bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
            disabled={isSubmitting || isPending}
          >
            {isSubmitting || isPending ? 'Creating Account...' : 'Create Account'}
          </Button>
        </Form>
      )}
    </Formik>
  );
}
</file>

<file path="src/pages/RegisterInvitation/RegisterInvitationPage.tsx">
import React from 'react';
import { useParams, useNavigate } from 'react-router-dom';
import { useVerifyInvitation } from '../../backend/teams.service';
import { ResetPasswordForm } from './ResetPasswordForm';
import { RegisterForm } from './RegisterForm';
import { toast } from 'sonner';
import { Button } from '../../components/ui/button';
import { LoginModal } from '../../components/modals/LoginModal';

export function RegisterInvitationPage() {
  const { token } = useParams();
  const navigate = useNavigate();
  const { data, isLoading } = useVerifyInvitation(token || '');
  const [isLoginModalOpen, setIsLoginModalOpen] = React.useState(false);
  const [isSuccess, setIsSuccess] = React.useState(false);

  console.log(data)

  if (isLoading) {
    return (
      <div className="flex items-center justify-center min-h-screen bg-gray-50 dark:bg-[#0F1621]">
        <div className="text-center">
          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"></div>
          <p className="mt-4 text-gray-600 dark:text-gray-300">Verifying invitation...</p>
        </div>
      </div>
    );
  }

  if (!(data as any)?.email) {
    return (
      <div className="flex items-center justify-center min-h-screen bg-gray-50 dark:bg-[#0F1621]">
        <div className="w-full max-w-md">
          <div className="bg-white dark:bg-[#121C2D] rounded-lg shadow-lg p-8 text-center">
            <h1 className="text-3xl font-boogaloo mb-4">Invalid Invitation</h1>
            <p className="text-gray-600 dark:text-gray-300 mb-6">
              This invitation link is invalid or has expired.
            </p>
            <Button
              onClick={() => navigate('/')}
              className="bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
            >
              Return to Home
            </Button>
          </div>
        </div>
      </div>
    );
  }

  return (
    <>
      <div className="flex items-center justify-center min-h-screen bg-gray-50 dark:bg-[#0F1621] p-4">
        <div className="w-full max-w-md">
          <div className="bg-white dark:bg-[#121C2D] rounded-lg shadow-lg p-8">
            <h1 className="text-3xl font-boogaloo text-center mb-8">
              {(data as any)?.userExists ? 'Reset Password' : 'Complete Registration'}
            </h1>

            {isSuccess ? (
              <div className="text-center">
                <p className="text-gray-600 dark:text-gray-300 mb-6">
                  {(data as any)?.userExists
                    ? 'Your password has been reset successfully.'
                    : 'Your account has been created successfully.'}
                </p>
                <div className="space-y-4">
                  <Button
                    onClick={() => setIsLoginModalOpen(true)}
                    className="w-full bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
                  >
                    Log In Now
                  </Button>
                  <Button
                    onClick={() => navigate('/')}
                    variant="outline"
                    className="w-full"
                  >
                    Return to Home
                  </Button>
                </div>
              </div>
            ) : (
              <>
                {(data as any)?.userExists ? (
                  <ResetPasswordForm
                    email={(data as any)?.email || ''}
                    token={token || ''}
                    onSuccess={() => {
                      toast.success('Password reset successful. Please log in.');
                      setIsSuccess(true);
                      setIsLoginModalOpen(true);
                    }}
                  />
                ) : (
                  <RegisterForm
                    email={(data as any)?.email || ''}
                    token={token || ''}
                    onSuccess={() => {
                      toast.success('Registration successful. Please log in.');
                      setIsSuccess(true);
                      setIsLoginModalOpen(true);
                    }}
                  />
                )}
              </>
            )}
          </div>
        </div>
      </div>

      <LoginModal
        open={isLoginModalOpen}
        onOpenChange={setIsLoginModalOpen}
        openSignUpModal={() => { }} // Not needed since we're in the registration flow
        defaultEmail={(data as any)?.email || ''}
        hideSignUpLink={true}
      />
    </>
  );
}
</file>

<file path="src/pages/RegisterInvitation/ResetPasswordForm.tsx">
import React, { useState } from 'react';
import { Formik, Form, Field, ErrorMessage } from 'formik';
import * as Yup from 'yup';
import { Input } from '../../components/ui/input';
import { Button } from '../../components/ui/button';
import { Label } from '../../components/ui/label';
import { useResetPasswordFromInvitation } from '../../backend/teams.service';
import { passwordSchema, confirmPasswordSchema } from '../../validation/password';
import { toast } from 'sonner';
import { FaEye, FaEyeSlash } from 'react-icons/fa';

interface ResetPasswordFormProps {
  email: string;
  token: string;
  onSuccess: () => void;
}

const validationSchema = Yup.object({
  password: passwordSchema,
  confirmPassword: confirmPasswordSchema
});

interface FormValues {
  password: string;
  confirmPassword: string;
}

export function ResetPasswordForm({ email, token, onSuccess }: ResetPasswordFormProps) {
  const { mutate: resetPassword, isPending, error } = useResetPasswordFromInvitation();
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);

  const togglePasswordVisibility = () => setShowPassword(!showPassword);
  const toggleConfirmPasswordVisibility = () => setShowConfirmPassword(!showConfirmPassword);

  React.useEffect(() => {
    if (error) {
      toast.error((error as any)?.message || 'Failed to reset password');
    }
  }, [error]);

  const initialValues: FormValues = {
    password: '',
    confirmPassword: ''
  };

  const handleSubmit = (values: FormValues) => {
    resetPassword(
      {
        token,
        data: values
      },
      {
        onSuccess,
        onError: (error) => {
          toast.error((error as any)?.message || 'Failed to reset password');
        }
      }
    );
  };

  return (
    <Formik
      initialValues={initialValues}
      validationSchema={validationSchema}
      onSubmit={handleSubmit}
    >
      {({ isSubmitting }) => (
        <Form className="space-y-6">
          <div>
            <Label htmlFor="email">Email</Label>
            <Input
              id="email"
              type="email"
              value={email}
              disabled
              className="mt-1 w-full bg-gray-100 dark:bg-[#1F2937]"
            />
          </div>

          <div>
            <Label htmlFor="password">New Password</Label>
            <div className="relative">
              <button
                type="button"
                onClick={togglePasswordVisibility}
                className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                aria-label={showPassword ? "Hide password" : "Show password"}
              >
                {showPassword ? (
                  <FaEyeSlash size={15} />
                ) : (
                  <FaEye size={15} />
                )}
              </button>
              <Field
                as={Input}
                id="password"
                name="password"
                type={showPassword ? "text" : "password"}
                className="mt-1 w-full pl-10"
              />
            </div>
            <ErrorMessage
              name="password"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <div>
            <Label htmlFor="confirmPassword">Confirm Password</Label>
            <div className="relative">
              <button
                type="button"
                onClick={toggleConfirmPasswordVisibility}
                className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                aria-label={showConfirmPassword ? "Hide password" : "Show password"}
              >
                {showConfirmPassword ? (
                  <FaEyeSlash size={15} />
                ) : (
                  <FaEye size={15} />
                )}
              </button>
              <Field
                as={Input}
                id="confirmPassword"
                name="confirmPassword"
                type={showConfirmPassword ? "text" : "password"}
                className="mt-1 w-full pl-10"
              />
            </div>
            <ErrorMessage
              name="confirmPassword"
              component="div"
              className="text-red-500 text-sm mt-1"
            />
          </div>

          <Button
            type="submit"
            className="w-full bg-[#D946EF] dark:text-white hover:text-[#D946EF] hover:bg-[#F3E8FF]"
            disabled={isSubmitting || isPending}
          >
            {isSubmitting || isPending ? 'Resetting Password...' : 'Reset Password'}
          </Button>
        </Form>
      )}
    </Formik>
  );
}
</file>

<file path="src/pages/ResetPassword/ResetPasswordPage.tsx">
import { useState, useEffect, useRef } from "react";
import { useParams, useNavigate } from "react-router-dom";
import { Formik, Form, Field, ErrorMessage } from "formik";
import * as Yup from "yup";
import { passwordSchema, confirmPasswordSchema } from "../../validation/password";
import { useResetPassword } from "../../backend/auth.service";
import { backendService } from "../../backend/api.service";
import { BackendRoute } from "../../backend/constants";
import { toast } from "sonner";
import { Button } from "../../components/ui/button";
import { Input } from "../../components/ui/input";
import { Label } from "../../components/ui/label";
import { FaEye, FaEyeSlash } from "react-icons/fa";
import { LoginModal } from "../../components/modals/LoginModal";

const validationSchema = Yup.object({
  password: passwordSchema,
  confirmPassword: confirmPasswordSchema,
});

const initialValues = {
  password: "",
  confirmPassword: "",
};

export function ResetPasswordPage() {
  const { token, userId } = useParams<{ token?: string; userId?: string }>();
  const isPhoneFlow = !!userId;
  const [showPassword, setShowPassword] = useState(false);
  const [showConfirmPassword, setShowConfirmPassword] = useState(false);
  const [isTokenValid, setIsTokenValid] = useState(false);
  const [isTokenChecking, setIsTokenChecking] = useState(true); // Start with true to show loading state
  const [isSuccess, setIsSuccess] = useState(false);
  const [isLoginModalOpen, setIsLoginModalOpen] = useState(false);
  const navigate = useNavigate();
  const resetPassword = useResetPassword();

  const togglePasswordVisibility = () => setShowPassword(!showPassword);
  const toggleConfirmPasswordVisibility = () => setShowConfirmPassword(!showConfirmPassword);

  // Use a ref to track if we've already verified the token
  const hasVerifiedToken = useRef(false);

  useEffect(() => {
    if (!token && !userId) {
      navigate("/");
      return;
    }

    if (isPhoneFlow) {
      // For phone flow, we don't need to verify anything since OTP was already verified
      setIsTokenValid(true);
      setIsTokenChecking(false);
      return;
    }

    if (!hasVerifiedToken.current) {
      hasVerifiedToken.current = true;

      const verifyTokenDirectly = async () => {
        try {
          // Add cache-busting parameter to prevent 304 responses
          const response = await backendService.get(`${BackendRoute.AUTH_RESET_PASSWORD}/${token}?_=${Date.now()}`);
          console.log("Token verification response:", response);

          setIsTokenValid(true);
          setIsTokenChecking(false);
        } catch (error) {
          setIsTokenValid(false);
          setIsTokenChecking(false);
          console.log(error)
          // toast.error("Invalid or expired reset token");
        }
      };

      verifyTokenDirectly();
    }
  }, [token, userId, navigate, isPhoneFlow]);


  const handleSubmit = async (values: typeof initialValues) => {
    try {
      await resetPassword.mutateAsync({
        token: isPhoneFlow ? undefined : token,
        userId: isPhoneFlow ? userId : undefined,
        password: values.password,
        confirmPassword: values.confirmPassword,
      });
      setIsSuccess(true);
      toast.success("Password reset successful");
    } catch (error: any) {
      console.log(error)
    }
  };

  const openLoginModal = () => {
    setIsLoginModalOpen(true);
  };

  const requestNewResetLink = () => {
    navigate("/");
    // We need to wait a bit before opening the forgot password modal
    setTimeout(() => {
      const forgotPasswordButton = document.querySelector('[data-forgot-password-trigger]');
      if (forgotPasswordButton) {
        (forgotPasswordButton as HTMLElement).click();
      }
    }, 500);
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-200">
      <div className="bg-white dark:bg-[#0F1221] rounded-lg shadow-xl p-8 max-w-md w-full">
        <h1 className="text-3xl font-bold mb-6 text-center text-[#E328AF] font-boogaloo">
          {isSuccess ? "Password Reset Successful" : "Reset Your Password"}
        </h1>

        {isTokenChecking ? (
          <div className="flex flex-col items-center justify-center py-8">
            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-[#E328AF]"></div>
            <p className="mt-4  text-black dark:text-white font-pincuk text-lg tracking-wider">
              {isPhoneFlow ? "Preparing reset form..." : "Verifying your reset token..."}
            </p>
          </div>
        ) : !isTokenValid ? (
          <div className="space-y-4 py-4">
            <p className=" text-center text-black dark:text-white font-pincuk text-lg tracking-wider">
              {isPhoneFlow
                ? "Unable to process your password reset request."
                : "The password reset link is invalid or has expired."}
            </p>
            <p className=" text-center text-black dark:text-white font-pincuk text-lg tracking-wider">
              Please request a new password reset link.
            </p>
            <div className="flex flex-col space-y-2 mt-4">
              <Button
                type="button"
                onClick={requestNewResetLink}
                className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
              >
                Request New Reset Link
              </Button>
              <Button
                type="button"
                onClick={() => navigate("/")}
                className="w-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-700 font-boogaloo"
              >
                Return to Home
              </Button>
            </div>
          </div>
        ) : isSuccess ? (
          <div className="space-y-4 py-4">
            <p className=" text-center text-black dark:text-white font-pincuk text-lg tracking-wider">
              Your password has been reset successfully.
            </p>
            <p className=" text-center text-black dark:text-white font-pincuk text-lg tracking-wider">
              You can now log in with your new password.
            </p>
            <div className="flex flex-col space-y-2 mt-4">
              <Button
                type="button"
                onClick={openLoginModal}
                className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
              >
                Log In
              </Button>
            </div>
          </div>
        ) : (
          <Formik
            initialValues={initialValues}
            validationSchema={validationSchema}
            onSubmit={handleSubmit}
          >
            {({ isSubmitting }) => (
              <Form className="space-y-4">
                <p className=" text-center text-black dark:text-white font-pincuk text-lg tracking-wider mb-4">
                  Enter your new password below.
                </p>
                <div className="relative">
                  <Label
                    htmlFor="password"
                    className="font-boogaloo text-base text-black dark:text-white"
                  >
                    New Password
                  </Label>
                  <div className="relative">
                    <button
                      type="button"
                      onClick={togglePasswordVisibility}
                      className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                      aria-label={
                        showPassword ? "Hide password" : "Show password"
                      }
                    >
                      {showPassword ? (
                        <FaEyeSlash size={15} />
                      ) : (
                        <FaEye size={15} />
                      )}
                    </button>
                    <Field
                      as={Input}
                      id="password"
                      name="password"
                      type={showPassword ? "text" : "password"}
                      placeholder="New password"
                      className="mt-1 bg-[#E2E8F0] dark:bg-[#191c2b] border-0 pl-10 font-pincuk text-xl tracking-wider text-[11px] font-normal h-[48px]"
                    />
                  </div>
                  <ErrorMessage
                    name="password"
                    component="div"
                    className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                  />
                </div>
                <div className="relative">
                  <Label
                    htmlFor="confirmPassword"
                    className="font-boogaloo text-base text-black dark:text-white"
                  >
                    Confirm Password
                  </Label>
                  <div className="relative">
                    <button
                      type="button"
                      onClick={toggleConfirmPasswordVisibility}
                      className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 z-10"
                      aria-label={
                        showConfirmPassword ? "Hide password" : "Show password"
                      }
                    >
                      {showConfirmPassword ? (
                        <FaEyeSlash size={15} />
                      ) : (
                        <FaEye size={15} />
                      )}
                    </button>
                    <Field
                      as={Input}
                      id="confirmPassword"
                      name="confirmPassword"
                      type={showConfirmPassword ? "text" : "password"}
                      placeholder="Confirm password"
                      className="mt-1 bg-[#E2E8F0] dark:bg-[#191c2b] border-0 pl-10 font-pincuk text-xl tracking-wider text-[11px] font-normal h-[48px]"
                    />
                  </div>
                  <ErrorMessage
                    name="confirmPassword"
                    component="div"
                    className="text-red-500 mt-1 font-pincuk text-xl tracking-wider"
                  />
                </div>
                <div className="space-y-2">
                  <Button
                    type="submit"
                    disabled={isSubmitting}
                    className="w-full bg-[#D946EF] hover:bg-[#C026D3] text-white font-boogaloo"
                  >
                    {isSubmitting ? "Resetting..." : "Reset Password"}
                  </Button>
                  <Button
                    type="button"
                    onClick={() => navigate("/")}
                    className="w-full bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-black dark:text-white border border-gray-300 dark:border-gray-700 font-boogaloo"
                  >
                    Return to Home
                  </Button>
                </div>
              </Form>
            )}
          </Formik>
        )}
      </div>

      <LoginModal
        open={isLoginModalOpen}
        onOpenChange={setIsLoginModalOpen}
        openSignUpModal={() => {
          setIsLoginModalOpen(false);
          navigate("/");
        }}
      />
    </div>
  );
}
</file>

<file path="src/pages/TermsOfService/Terms.tsx">
import React from 'react';

const TermsOfService: React.FC = () => {
  return (
    <div className="px-32 py-6 h-screen font-pincuk">
      <h1 className="text-5xl font-bold mb-4 text-[#C026D3] font-boogaloo">Terms and Conditions</h1>

      <h2 className="text-2xl text-[#132F41] font-semibold font-boogaloo mb-4">Your Agreement</h2>

      <p className="text-gray-600 text-xl mb-3">
        Last Revised: December 16, 2013
      </p>

      <p className="text-gray-600 mb-6 text-xl">
        Welcome to www.lorem-ipsum.info. This site is provided as a service to our visitors and may be used for informational purposes only.
        Because the Terms and Conditions contain legal obligations, please read them carefully.
      </p>

      <h3 className="text-2xl text-gray-600 font-semibold mb-3">1. YOUR AGREEMENT</h3>
      <p className="text-gray-600 mb-6 text-xl">
        By using this Site, you agree to be bound by, and to comply with, these Terms and Conditions. If you do not agree to these Terms and Conditions,
        please do not use this site.
      </p>

      <p className="text-gray-600 mb-6 text-xl">
        PLEASE NOTE: We reserve the right, at our sole discretion, to change, modify or otherwise alter these Terms and Conditions at any time. Unless
        otherwise indicated, amendments will become effective immediately. Please review these Terms and Conditions periodically. Your continued use of
        the Site following the posting of changes and/or modifications will constitute your acceptance of the revised Terms and Conditions and the
        reasonableness of these standards for notice of changes. For your information, this page was last updated as of the date at the top of these
        terms and conditions.
      </p>

      <h3 className="text-2xl text-gray-600 font-semibold mb-3">2. PRIVACY</h3>
      <p className="text-gray-600 mb-6 text-xl">
        Please review our Privacy Policy, which also governs your visit to this Site, to understand our practices.
      </p>

      <h3 className="text-2xl text-gray-600 font-semibold mb-3">3. LINKED SITES</h3>
      <p className="text-gray-600 mb-6 text-xl">
        This Site may contain links to other independent third-party Web sites ('Linked Sites'). These Linked Sites are provided solely as a convenience
        to our visitors. Such Linked Sites are not under our control, and we are not responsible for and does not endorse the content of such Linked Sites,
        including any information or materials contained on such Linked Sites. You will need to make your own independent judgment regarding your
        interaction with these.
      </p>
    </div>
  );
};

export default TermsOfService;
</file>

<file path="src/pages/ErrorPage.tsx">
const ErrorPage = () => {

  return (
    <div className="">
      Error Page
    </div>
  );
};

export default ErrorPage;
</file>

<file path="src/routing/__tests__/ProtectedRoute.logic.test.ts">
import { describe, it, expect } from 'vitest'

describe('ProtectedRoute Access Control Logic', () => {
  describe('Route Access Decision Logic', () => {
    it('should allow access when authenticated and no admin required', () => {
      const authState = {
        isAuthenticated: true,
        isAdmin: false,
        isLoading: false
      }
      const requireAdmin = false

      const shouldAllowAccess = authState.isAuthenticated && (!requireAdmin || authState.isAdmin)
      const shouldRedirect = !authState.isAuthenticated || (requireAdmin && !authState.isAdmin)

      expect(shouldAllowAccess).toBe(true)
      expect(shouldRedirect).toBe(false)
    })

    it('should allow access when authenticated admin and admin required', () => {
      const authState = {
        isAuthenticated: true,
        isAdmin: true,
        isLoading: false
      }
      const requireAdmin = true

      const shouldAllowAccess = authState.isAuthenticated && (!requireAdmin || authState.isAdmin)
      const shouldRedirect = !authState.isAuthenticated || (requireAdmin && !authState.isAdmin)

      expect(shouldAllowAccess).toBe(true)
      expect(shouldRedirect).toBe(false)
    })

    it('should deny access when not authenticated', () => {
      const authState = {
        isAuthenticated: false,
        isAdmin: false,
        isLoading: false
      }
      const requireAdmin = false

      const shouldAllowAccess = authState.isAuthenticated && (!requireAdmin || authState.isAdmin)
      const shouldRedirect = !authState.isAuthenticated || (requireAdmin && !authState.isAdmin)

      expect(shouldAllowAccess).toBe(false)
      expect(shouldRedirect).toBe(true)
    })

    it('should deny access when authenticated but not admin and admin required', () => {
      const authState = {
        isAuthenticated: true,
        isAdmin: false,
        isLoading: false
      }
      const requireAdmin = true

      const shouldAllowAccess = authState.isAuthenticated && (!requireAdmin || authState.isAdmin)
      const shouldRedirect = !authState.isAuthenticated || (requireAdmin && !authState.isAdmin)

      expect(shouldAllowAccess).toBe(false)
      expect(shouldRedirect).toBe(true)
    })

    it('should show loading when authentication is in progress', () => {
      const authState = {
        isAuthenticated: false,
        isAdmin: false,
        isLoading: true
      }

      const shouldShowLoading = authState.isLoading
      const shouldProcessAuth = !authState.isLoading

      expect(shouldShowLoading).toBe(true)
      expect(shouldProcessAuth).toBe(false)
    })
  })

  describe('Access Control Matrix', () => {
    it('should handle all possible authentication scenarios', () => {
      const scenarios = [
        // [isAuthenticated, isAdmin, requireAdmin, isLoading, expectedAction]
        [true, true, true, false, 'allow'],     // Admin accessing admin route
        [true, true, false, false, 'allow'],    // Admin accessing regular route
        [true, false, false, false, 'allow'],   // User accessing regular route
        [true, false, true, false, 'redirect'], // User accessing admin route
        [false, false, false, false, 'redirect'], // Unauthenticated accessing regular route
        [false, false, true, false, 'redirect'], // Unauthenticated accessing admin route
        [false, false, false, true, 'loading'], // Loading state
        [true, true, true, true, 'loading'],    // Loading state (auth values irrelevant)
      ]

      scenarios.forEach(([isAuthenticated, isAdmin, requireAdmin, isLoading, expected]) => {
        if (isLoading) {
          expect('loading').toBe(expected)
        } else if (!isAuthenticated) {
          expect('redirect').toBe(expected)
        } else if (requireAdmin && !isAdmin) {
          expect('redirect').toBe(expected)
        } else {
          expect('allow').toBe(expected)
        }
      })
    })
  })

  describe('Navigation Logic', () => {
    it('should determine correct redirect path', () => {
      const redirectPath = '/'

      // All unauthorized access should redirect to home
      const testCases = [
        { reason: 'not authenticated', path: redirectPath },
        { reason: 'not admin', path: redirectPath },
        { reason: 'insufficient permissions', path: redirectPath }
      ]

      testCases.forEach(({ path }) => {
        expect(path).toBe('/')
      })
    })

    it('should handle replace navigation correctly', () => {
      const navigationOptions = { replace: true }

      // Should always use replace to prevent back button issues
      expect(navigationOptions.replace).toBe(true)
    })
  })

  describe('Admin Requirement Logic', () => {
    it('should handle optional admin requirement parameter', () => {
      const testCases = [
        { requireAdmin: undefined, expected: false },
        { requireAdmin: false, expected: false },
        { requireAdmin: true, expected: true }
      ]

      testCases.forEach(({ requireAdmin, expected }) => {
        const adminRequired = requireAdmin || false
        expect(adminRequired).toBe(expected)
      })
    })

    it('should validate admin requirement with different auth states', () => {
      const adminStates = [
        { isAdmin: true, requireAdmin: true, shouldPass: true },
        { isAdmin: false, requireAdmin: true, shouldPass: false },
        { isAdmin: true, requireAdmin: false, shouldPass: true },
        { isAdmin: false, requireAdmin: false, shouldPass: true }
      ]

      adminStates.forEach(({ isAdmin, requireAdmin, shouldPass }) => {
        const hasAdminAccess = !requireAdmin || isAdmin
        expect(hasAdminAccess).toBe(shouldPass)
      })
    })
  })

  describe('Loading State Logic', () => {
    it('should prioritize loading state over other conditions', () => {
      const loadingScenarios = [
        { isLoading: true, isAuthenticated: true, shouldShowLoading: true },
        { isLoading: true, isAuthenticated: false, shouldShowLoading: true },
        { isLoading: false, isAuthenticated: true, shouldShowLoading: false },
        { isLoading: false, isAuthenticated: false, shouldShowLoading: false }
      ]

      loadingScenarios.forEach(({ isLoading, shouldShowLoading }) => {
        expect(isLoading).toBe(shouldShowLoading)
      })
    })

    it('should handle loading state transitions', () => {
      const transitions = [
        { from: 'loading', to: 'authenticated', valid: true },
        { from: 'loading', to: 'unauthenticated', valid: true },
        { from: 'authenticated', to: 'loading', valid: false }, // Shouldn't go back to loading
        { from: 'unauthenticated', to: 'loading', valid: false }
      ]

      transitions.forEach(({ from, valid }) => {
        if (from === 'loading') {
          expect(valid).toBe(true) // Loading can transition to any state
        } else {
          expect(valid).toBe(false) // Other states shouldn't go back to loading
        }
      })
    })
  })

  describe('Security Edge Cases', () => {
    it('should handle malicious auth state manipulation', () => {
      const maliciousStates = [
        { isAuthenticated: 'true', isAdmin: 'true' }, // String instead of boolean
        { isAuthenticated: 1, isAdmin: 1 }, // Number instead of boolean
        { isAuthenticated: {}, isAdmin: {} }, // Object instead of boolean
        { isAuthenticated: null, isAdmin: null }, // Null values
      ]

      maliciousStates.forEach(state => {
        // Convert to boolean for security
        const safeAuth = !!state.isAuthenticated
        const safeAdmin = !!state.isAdmin

        // Verify conversion works correctly
        expect(typeof safeAuth).toBe('boolean')
        expect(typeof safeAdmin).toBe('boolean')
      })
    })

    it('should handle undefined auth context', () => {
      const undefinedStates = [
        { isAuthenticated: undefined, isAdmin: undefined, isLoading: undefined },
        {}, // Empty object
        null,
        undefined
      ]

      undefinedStates.forEach(state => {
        const safeAuth = !!(state?.isAuthenticated)
        const safeAdmin = !!(state?.isAdmin)
        const safeLoading = !!(state?.isLoading)

        expect(safeAuth).toBe(false)
        expect(safeAdmin).toBe(false)
        expect(safeLoading).toBe(false)
      })
    })
  })
})
</file>

<file path="src/routing/main.ts">
// Export all routing-related modules
export * from './routes';
// Add more exports as needed
</file>

<file path="src/routing/ProtectedRoute.tsx">
import { Navigate, Outlet } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';

interface ProtectedRouteProps {
  requireAdmin?: boolean;
}

export const ProtectedRoute = ({ requireAdmin = false }: ProtectedRouteProps) => {
  const { isAuthenticated, isAdmin, isLoading } = useAuth();

  if (isLoading) {
    return <div className="flex items-center justify-center h-screen">
      <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#E328AF]"></div>
    </div>;
  }

  if (!isAuthenticated) {
    return <Navigate to="/" replace />;
  }

  if (requireAdmin && !isAdmin) {
    return <Navigate to="/" replace />;
  }

  return <Outlet />;
};
</file>

<file path="src/routing/RequireAdminAuth.tsx">
import { useState } from 'react';
import { Outlet } from 'react-router-dom';
import LoginModal from '../components/modals/AdminModals/LoginModal';

// Dummy authentication check (replace with real logic)
const isAuthenticated = () => {
  // For example, check localStorage or context for a token
  return !!localStorage.getItem('admin_token');
};

export default function RequireAdminAuth() {
  const [loginOpen, setLoginOpen] = useState(!isAuthenticated());

  if (!isAuthenticated()) {
    return (
      <>
        <LoginModal open={loginOpen} onClose={() => setLoginOpen(false)} />
        {/* Optionally, block the UI or redirect */}
      </>
    );
  }

  return <Outlet />;
}
</file>

<file path="src/routing/routes.tsx">
import { Routes, Route } from 'react-router-dom';
import ErrorPage from '../pages/ErrorPage';
import Home from '../pages/Home/Home';
import About from '../pages/About/About';
import { RegisterInvitationPage } from '../pages/RegisterInvitation';
import MainLayout from '../layout/MainLayout';
import GamePlay from '../pages/GamePlay/GamePlay';
import Categories from '../pages/Categories/Categories';
import { ResetPasswordPage } from '../pages/ResetPassword/ResetPasswordPage';
import { ProtectedRoute } from './ProtectedRoute';
import AdminLayout from '../layout/AdminLayout';
import AdminHome from '../pages/Admin/Home/Home';
import GameManagement from '../pages/Admin/Management/GameManagement';
import UserManagement from '../pages/Admin/UserManagement/UserManagement';
import Analytics from '../pages/Admin/Analytics/Analytics';
import Configuration from '../pages/Admin/Configuration/Configuration';
import ViewGame from '../pages/Admin/ViewGame';
import GameCategories from '../pages/Admin/Category/GameCategories';
import UserManagementView from '../pages/Admin/UserMgtView';
import TeamManagement from '../pages/Admin/Team/TeamManagement';
import Settings from '../pages/Admin/Settings';
import ViewProfile from '../pages/Admin/ViewProfile';
import Terms from '../pages/TermsOfService/Terms';
import Privacy from '../pages/PrivacyPolicy/Privacy';


export const AppRoutes = () => {
  return (
    <Routes>

      <Route path="/">
        <Route element={<MainLayout />}>

          <Route index element={<Home />} />
          <Route path="about" element={<About />} />
          <Route path="categories" element={<Categories />} />
          <Route path="gameplay/:gameId" element={<GamePlay />} />
          <Route path="terms" element={<Terms />} />
          <Route path="privacy" element={<Privacy />} />


          <Route path="*" element={<ErrorPage />} />
        </Route>
      </Route>

        <Route path="reset-password">
          <Route path=":token" element={<ResetPasswordPage />} />
          <Route path="phone/:userId" element={<ResetPasswordPage />} />
        </Route>
        <Route path="register-invitation/:token" element={<RegisterInvitationPage />} />

        <Route path="admin/" element={<ProtectedRoute requireAdmin={true} />}>
          <Route element={<AdminLayout />}>
            <Route index element={<AdminHome />} />
            {/* <Route path="about" element={<AdminAbout />} />*/}
            <Route path="game-management" element={<GameManagement />} />
            <Route path="categories" element={<GameCategories />} />
            <Route path="management" element={<UserManagement />} />
            <Route path="management/:userId" element={<UserManagementView />} />
            <Route path="team" element={<TeamManagement />} />
            <Route path="analytics" element={<Analytics />} />
            <Route path="config" element={<Configuration />} />
            <Route path="view-game/:gameId" element={<ViewGame />} />

            {/* settings */}
            <Route path="settings" element={<Settings />} />
            <Route path="view-profile" element={<ViewProfile />} />
          </Route>
        </Route>

            <Route path="*" element={<ErrorPage />} />

    </Routes>
  );
};

export default AppRoutes;
</file>

<file path="src/store/index.ts">
// import { configureStore } from '@reduxjs/toolkit';
// import ChareliReducer from '../store/slice;';

// export const store = configureStore({
//   reducer: {
//     slice: ChareliReducer,
//   },
// });

// // Infer the `RootState` and `AppDispatch` types from the store itself
// export type RootState = ReturnType<typeof store.getState>;
// export type AppDispatch = typeof store.dispatch;
</file>

<file path="src/store/slice.ts">
// import { createSlice, PayloadAction } from '@reduxjs/toolkit';

// // Define the type for your slice state
// interface YourState {
//   value: number;
// }

// // Initial state
// const initialState: YourState = {
//   value: 0,
// };

// // Create the slice
// const slice = createSlice({
//   name: 'slice',
//   initialState,
//   reducers: {
//     increment: (state) => {
//       state.value += 1;
//     },
//     decrement: (state) => {
//       state.value -= 1;
//     },
//     setValue: (state, action: PayloadAction<number>) => {
//       state.value = action.payload;
//     },
//   },
// });

// // Export actions and reducer
// export const { increment, decrement, setValue } = slice.actions;
// export default slice.reducer;
</file>

<file path="src/styles/phone-input.css">
/* Dark mode styles for react-phone-input-2 */
.dark .react-tel-input .form-control {
  background-color: #191c2b !important;
  color: white !important;
}

.dark .react-tel-input .flag-dropdown {
  background-color: #191c2b !important;
}

.dark .react-tel-input .selected-flag {
  background-color: #191c2b !important;
}

.dark .react-tel-input .country-list {
  background-color: #191c2b !important;
  color: white !important;
}

.dark .react-tel-input .country-list .country.highlight {
  background-color: #252a3d !important;
}

.dark .react-tel-input .country-list .country:hover {
  background-color: #252a3d !important;
}

.dark .react-tel-input .country-list .search-box {
  background-color: #191c2b !important;
  color: white !important;
}

.dark .react-tel-input .country-list .search-box input {
  background-color: #191c2b !important;
  color: white !important;
}
</file>

<file path="src/test/setup.ts">
import '@testing-library/jest-dom'
</file>

<file path="src/utils/__tests__/errorHandling.test.ts">
import { describe, it, expect } from 'vitest'
import { getErrorMessage } from '../errorHandling'

describe('Error Handling Utils', () => {
  describe('getErrorMessage', () => {
    it('should handle basic error message', () => {
      const error = {
        response: {
          data: {
            message: 'Invalid credentials'
          }
        }
      }

      const result = getErrorMessage(error)

      expect(result.message).toBe('Invalid credentials')
      expect(result.type).toBe('error')
    })

    it('should handle permission errors', () => {
      const error = {
        response: {
          data: {
            message: 'You do not have permission to perform this action'
          }
        }
      }

      const result = getErrorMessage(error)

      expect(result.message).toBe("You don't have permission to perform this action. Contact your administrator.")
      expect(result.type).toBe('error')
    })

    it('should handle role assignment warnings', () => {
      const error = {
        response: {
          data: {
            message: 'User already has this role'
          }
        }
      }

      const result = getErrorMessage(error)

      expect(result.message).toBe('This user already has the selected role.')
      expect(result.type).toBe('warning')
    })

    it('should use default message when no error message found', () => {
      const error = {}

      const result = getErrorMessage(error)

      expect(result.message).toBe('An error occurred')
      expect(result.type).toBe('error')
    })

    it('should use custom default message', () => {
      const error = {}
      const customDefault = 'Custom error message'

      const result = getErrorMessage(error, customDefault)

      expect(result.message).toBe(customDefault)
      expect(result.type).toBe('error')
    })
  })
})
</file>

<file path="src/utils/__tests__/main.test.ts">
import { describe, it, expect } from 'vitest'
import { isValidRole } from '../main'

describe('Utils - Main', () => {
  describe('isValidRole', () => {
    it('should return true for admin role', () => {
      expect(isValidRole('admin')).toBe(true)
    })

    it('should return true for superadmin role', () => {
      expect(isValidRole('superadmin')).toBe(true)
    })

    it('should return false for player role', () => {
      expect(isValidRole('player')).toBe(false)
    })

    it('should return false for editor role', () => {
      expect(isValidRole('editor')).toBe(false)
    })

    it('should return false for invalid role', () => {
      expect(isValidRole('invalid')).toBe(false)
    })

    it('should return false for empty string', () => {
      expect(isValidRole('')).toBe(false)
    })

    it('should return false for null', () => {
      expect(isValidRole(null as any)).toBe(false)
    })

    it('should return false for undefined', () => {
      expect(isValidRole(undefined as any)).toBe(false)
    })
  })
})
</file>

<file path="src/utils/errorHandling.ts">
/**
 * General utility function to handle API error messages and provide better user feedback
 * Can be used anywhere in the application for consistent error handling
 */
export function getErrorMessage(error: any, defaultMessage: string = "An error occurred"): { message: string; type: 'error' | 'warning' } {
  const errorMessage = error?.response?.data?.message || error?.message || defaultMessage;

  // Handle specific error cases with better messaging
  // These can be used across different parts of the application

  // Permission-related errors
  if (errorMessage.includes("You do not have permission")) {
    return {
      message: "You don't have permission to perform this action. Contact your administrator.",
      type: 'error'
    };
  }

  if (errorMessage.includes("Only admin and superadmin")) {
    return {
      message: "You don't have permission to perform this action. Contact your administrator.",
      type: 'error'
    };
  }

  // Invitation-specific errors
  if (errorMessage.includes("User already has this role")) {
    return {
      message: "This user already has the selected role.",
      type: 'warning'
    };
  }

  if (errorMessage.includes("Active invitation for this email already exists")) {
    return {
      message: "An active invitation for this email already exists. Please wait for it to expire or delete the existing invitation first.",
      type: 'warning'
    };
  }

  if (errorMessage.includes("Invitation for this email already exists")) {
    return {
      message: "An invitation for this email already exists. Please check pending invitations.",
      type: 'warning'
    };
  }

  // Role management errors
  if (errorMessage.includes("Admin can only invite editor and player roles")) {
    return {
      message: "As an admin, you can only invite editors and players.",
      type: 'error'
    };
  }

  if (errorMessage.includes("You cannot revoke your own role")) {
    return {
      message: "You cannot revoke your own role.",
      type: 'warning'
    };
  }

  if (errorMessage.includes("Admin can only revoke editor roles")) {
    return {
      message: "As an admin, you can only revoke editor roles.",
      type: 'error'
    };
  }

  // Validation errors
  if (errorMessage.includes("All fields are required")) {
    return {
      message: "Please fill in all required fields.",
      type: 'error'
    };
  }

  if (errorMessage.includes("Invalid role")) {
    return {
      message: "The selected role is invalid. Please choose a valid role.",
      type: 'error'
    };
  }

  // Default case - return original message
  return {
    message: errorMessage,
    type: 'error'
  };
}
</file>

<file path="src/utils/main.ts">
export function formatTime(seconds: number): string {
  if (!seconds || isNaN(seconds)) return "0 seconds";
  const displayMinutes = Math.floor(seconds / 60);
  const displaySeconds = Math.floor(seconds % 60);

  const minuteText = displayMinutes === 1 ? 'minute' : 'minutes';
  const secondText = displaySeconds === 1 ? 'second' : 'seconds';

  if (displayMinutes === 0) {
    return `${displaySeconds} ${secondText}`;
  }

  return `${displayMinutes} ${minuteText} ${displaySeconds} ${secondText}`;
}


export type RoleType = "admin" | "superadmin" | "editor" | "player";
export type AdminRoleType = "admin" | "superadmin";


const validRoles: RoleType[] = ["admin", "superadmin"];

export function isValidRole(role: string): role is RoleType {
  return validRoles.includes(role as RoleType);
}
</file>

<file path="src/utils/sessionUtils.ts">
/**
 * Utility functions for session management
 */

/**
 * Generate or retrieve a visitor session ID
 * This ID persists across browser sessions and is used for analytics tracking
 * @returns {string} The visitor session ID
 */
export const getVisitorSessionId = (): string => {
  let sessionId = sessionStorage.getItem('visitor_session_id');
  if (!sessionId) {
    sessionId = crypto.randomUUID();
    sessionStorage.setItem('visitor_session_id', sessionId);
  }
  return sessionId;
};
</file>

<file path="src/validation/__tests__/password.test.ts">
import { describe, it, expect } from 'vitest'
import * as Yup from 'yup'
import { passwordSchema, confirmPasswordSchema, PASSWORD_REQUIREMENTS } from '../password'

describe('Password Validation', () => {
  describe('passwordSchema', () => {
    it('should accept valid password', async () => {
      const validPassword = 'Password123!'

      const result = await passwordSchema.isValid(validPassword)

      expect(result).toBe(true)
    })

    it('should reject password shorter than 8 characters', async () => {
      const shortPassword = 'Pass1!'

      try {
        await passwordSchema.validate(shortPassword)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.MIN_LENGTH)
      }
    })

    it('should reject password without uppercase letter', async () => {
      const noUppercase = 'password123!'

      try {
        await passwordSchema.validate(noUppercase)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.UPPERCASE)
      }
    })

    it('should reject password without lowercase letter', async () => {
      const noLowercase = 'PASSWORD123!'

      try {
        await passwordSchema.validate(noLowercase)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.LOWERCASE)
      }
    })

    it('should reject password without number', async () => {
      const noNumber = 'Password!'

      try {
        await passwordSchema.validate(noNumber)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.NUMBER)
      }
    })

    it('should reject password without special character', async () => {
      const noSpecial = 'Password123'

      try {
        await passwordSchema.validate(noSpecial)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.SPECIAL)
      }
    })

    it('should reject empty password', async () => {
      const emptyPassword = ''

      try {
        await passwordSchema.validate(emptyPassword)
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.MIN_LENGTH)
      }
    })

    it('should accept password with various special characters', async () => {
      const passwords = [
        'Password123!',
        'Password123@',
        'Password123#',
        'Password123$',
        'Password123%',
        'Password123^',
        'Password123&',
        'Password123*'
      ]

      for (const password of passwords) {
        const result = await passwordSchema.isValid(password)
        expect(result).toBe(true)
      }
    })

    it('should accept minimum length password with all requirements', async () => {
      const minValidPassword = 'Pass123!'

      const result = await passwordSchema.isValid(minValidPassword)

      expect(result).toBe(true)
    })
  })

  describe('confirmPasswordSchema', () => {
    it('should accept matching passwords', async () => {
      const formData = { password: 'Password123!', confirmPassword: 'Password123!' }

      // Create a schema for the entire form to properly validate the reference
      const formSchema = Yup.object({
        password: passwordSchema,
        confirmPassword: confirmPasswordSchema
      })

      const result = await formSchema.isValid(formData)

      expect(result).toBe(true)
    })

    it('should reject non-matching passwords', async () => {
      const formData = { password: 'Password123!', confirmPassword: 'DifferentPass123!' }

      try {
        await confirmPasswordSchema.validate(formData.confirmPassword, { context: formData })
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.MATCH)
      }
    })

    it('should reject empty confirm password', async () => {
      const formData = { password: 'Password123!', confirmPassword: '' }

      try {
        await confirmPasswordSchema.validate(formData.confirmPassword, { context: formData })
        expect.fail('Should have thrown validation error')
      } catch (error: any) {
        expect(error.message).toBe(PASSWORD_REQUIREMENTS.MESSAGES.MATCH)
      }
    })
  })

  describe('PASSWORD_REQUIREMENTS constants', () => {
    it('should have correct minimum length', () => {
      expect(PASSWORD_REQUIREMENTS.MIN_LENGTH).toBe(8)
    })

    it('should have all required error messages', () => {
      expect(PASSWORD_REQUIREMENTS.MESSAGES.MIN_LENGTH).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.UPPERCASE).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.LOWERCASE).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.NUMBER).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.SPECIAL).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.REQUIRED).toBeDefined()
      expect(PASSWORD_REQUIREMENTS.MESSAGES.MATCH).toBeDefined()
    })
  })
})
</file>

<file path="src/validation/password.ts">
import * as Yup from 'yup';

export const PASSWORD_REQUIREMENTS = {
  MIN_LENGTH: 8,
  MESSAGES: {
    MIN_LENGTH: 'Password must be at least 8 characters',
    UPPERCASE: 'Password must contain at least one uppercase letter',
    LOWERCASE: 'Password must contain at least one lowercase letter',
    NUMBER: 'Password must contain at least one number',
    SPECIAL: 'Password must contain at least one special character',
    REQUIRED: 'Password is required',
    MATCH: 'Passwords must match'
  }
};

export const passwordSchema = Yup.string()
  .min(PASSWORD_REQUIREMENTS.MIN_LENGTH, PASSWORD_REQUIREMENTS.MESSAGES.MIN_LENGTH)
  .matches(/[A-Z]/, PASSWORD_REQUIREMENTS.MESSAGES.UPPERCASE)
  .matches(/[a-z]/, PASSWORD_REQUIREMENTS.MESSAGES.LOWERCASE)
  .matches(/[0-9]/, PASSWORD_REQUIREMENTS.MESSAGES.NUMBER)
  .matches(/[^A-Za-z0-9]/, PASSWORD_REQUIREMENTS.MESSAGES.SPECIAL)
  .required(PASSWORD_REQUIREMENTS.MESSAGES.REQUIRED);

export const confirmPasswordSchema = Yup.string()
  .oneOf([Yup.ref('password')], PASSWORD_REQUIREMENTS.MESSAGES.MATCH)
  .required(PASSWORD_REQUIREMENTS.MESSAGES.REQUIRED);
</file>

<file path="src/App.css">
@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme {
  --font-pong: 'Pong-Game';
  --font-face-src: url('./fonts/Pong-Game.ttf');
  --font-face-font-weight: normal;
  --font-face-font-style: normal;
}

/* @theme {
  --font-boogaloo: 'Boogaloo';
  --font-face-src: url('./fonts/Boogaloo-Regular.ttf');
  --font-face-font-weight: normal;
  --font-face-font-style: normal;
}  */

@theme {
  --font-pincuk: 'Pincuk';
  --font-face-src: url('./fonts/Pincuk.ttf');
  --font-face-font-weight: normal;
  --font-face-font-style: normal;
}

@theme inline {
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.145 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --secondary: oklch(0.97 0 0);
  --secondary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --accent: oklch(0.97 0 0);
  --accent-foreground: oklch(0.205 0 0);
  --destructive: oklch(0.577 0.245 27.325);
  --border: oklch(0.922 0 0);
  --input: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --card: oklch(0.205 0 0);
  --card-foreground: oklch(0.985 0 0);
  --popover: oklch(0.205 0 0);
  --popover-foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.269 0 0);
  --secondary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --accent: oklch(0.269 0 0);
  --accent-foreground: oklch(0.985 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 10%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

/* .dark {
  background-color: #111826 !important;
} */

@layer base {
  * {
    @apply border-border outline-ring/50;

    :root {
      --chart-1: 12 76% 61%;
      --chart-2: 173 58% 39%;
      --chart-3: 197 37% 24%;
      --chart-4: 43 74% 66%;
      --chart-5: 27 87% 67%;
    }

    .dark {
      --chart-1: 220 70% 50%;
      --chart-2: 160 60% 45%;
      --chart-3: 30 80% 55%;
      --chart-4: 280 65% 60%;
      --chart-5: 340 75% 55%;
    }
  }

  body {
    @apply bg-background text-foreground;
  }
}
</file>

<file path="src/App.tsx">
import './App.css'
import { BrowserRouter } from 'react-router-dom'
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import AppRoutes from './routing/routes'
import { AuthProvider } from './context/AuthContext'
import { Toaster } from 'sonner'

// Create a client
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60 * 5, // 5 minutes
      refetchOnWindowFocus: false,
    },
  },
})

const App: React.FC = () => {
  return (
    <QueryClientProvider client={queryClient}>
      <BrowserRouter>
        <AuthProvider>
          <div className='font-boogaloo'>
            <Toaster position="top-right" richColors />
            <AppRoutes />
          </div>
        </AuthProvider>
      </BrowserRouter>
    </QueryClientProvider>
  )
}

export default App;
</file>

<file path="src/index.css">
@import "tailwindcss";

@custom-variant dark (&:where(.dark, .dark *));

@font-face {
  font-family: 'Pong-Game';
  src: url('./fonts/Pong-Game.ttf'),
    /* font-weight: normal; */
    /* font-style: normal; */
    /* src: url('./fonts/Boogaloo-Regular.ttf'), */
    /* font-weight: normal; */
    /* font-style: normal; */
}

@font-face {
  font-family: 'Boogaloo';
  src: url('./fonts/Boogaloo-Regular.ttf'),
    /* font-weight: normal; */
    /* font-style: normal; */
}

@font-face {
  font-family: 'Pincuk';
  src: url('./fonts/Pincuk.ttf'),
}

@layer base {
  :root {
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
  }

  .dark {
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}



.font-boogaloo {
  font-family: 'Boogaloo', cursive;
}


.font-pincuk {
  font-family: 'Pincuk', cursive;
}

body {
  cursor: url('./assets/icn_hand.svg'), auto;
}

button,
[role="button"] {
  cursor: url('./assets/icn_hand.svg'), auto;
}

a,
.cursor-pointer {
  cursor: url('./assets/icn_hand.svg'), pointer;
}

img.cursor-pointer {
  cursor: url('./assets/icn_hand.svg'), pointer;
}

/* Override custom cursor for admin routes */
body.admin-route,
body.admin-route *,
body.admin-route button,
body.admin-route [role="button"],
body.admin-route a,
body.admin-route .cursor-pointer,
body.admin-route img.cursor-pointer {
  cursor: default !important;
}

body.admin-route a:hover,
body.admin-route button:hover,
body.admin-route [role="button"]:hover,
body.admin-route .cursor-pointer:hover {
  cursor: pointer !important;
}

/* Ensure input fields have text cursor in admin */
body.admin-route input[type="text"],
body.admin-route input[type="email"],
body.admin-route input[type="password"],
body.admin-route input[type="search"],
body.admin-route input[type="number"],
body.admin-route textarea {
  cursor: text !important;
}

/* card hover box shadow */
.gradient-shadow-hover {
  position: relative;
  border-radius: 20px;
  overflow: visible;
}

.gradient-shadow-hover:hover::after {
  opacity: 1;
  box-shadow: 0 10px 12px 0 rgba(217, 70, 239, 0.5);
  filter: blur(2px);
  /* mix-blend-mode: lighten; */
  /* filter: drop-shadow(8px 8px 10px #D946EF); */
  border-radius: 30px;
}

.gradient-shadow-hover::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s;
  filter: drop-shadow(8px 8px 10px #D946EF);
}


/* in your CSS */
.backdrop-blur-sm {
  backdrop-filter: blur(6px);
}

/* Hide scrollbar but allow scrolling */
.scrollbar-hide {
  -ms-overflow-style: none;
  /* IE and Edge */
  scrollbar-width: none;
  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;
  /* Chrome, Safari and Opera */
}

@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }

  100% {
    background-position: 1000px 0;
  }
}

.animate-shimmer {
  animation: shimmer 2s infinite linear;
  background-size: 1000px 100%;
}
</file>

<file path="src/main.tsx">
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App.tsx'

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <App />
  </StrictMode>,
)
</file>

<file path="src/vite-env.d.ts">
/// <reference types="vite/client" />
</file>

<file path=".env.example">
# API Configuration
VITE_API_URL=http://localhost:5000  # Backend API URL for development
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/App.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "iconLibrary": "lucide"
}
</file>

<file path="eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'

export default tseslint.config(
  { ignores: ['dist'] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ['**/*.{ts,tsx}'],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    plugins: {
      'react-hooks': reactHooks,
      'react-refresh': reactRefresh,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      'react-refresh/only-export-components': [
        'warn',
        { allowConstantExport: true },
      ],
    },
  },
)
</file>

<file path="index.html">
<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CHARELI</title>
</head>

<body class="">
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
</body>

</html>
</file>

<file path="package.json">
{
  "name": "client",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:run": "vitest run",
    "test:coverage": "vitest run --coverage"
  },
  "dependencies": {
    "@hookform/resolvers": "^5.0.1",
    "@radix-ui/react-alert-dialog": "^1.1.13",
    "@radix-ui/react-aspect-ratio": "^1.1.6",
    "@radix-ui/react-avatar": "^1.1.9",
    "@radix-ui/react-checkbox": "^1.3.1",
    "@radix-ui/react-collapsible": "^1.1.10",
    "@radix-ui/react-dialog": "^1.1.13",
    "@radix-ui/react-dropdown-menu": "^2.1.14",
    "@radix-ui/react-label": "^2.1.6",
    "@radix-ui/react-popover": "^1.1.13",
    "@radix-ui/react-progress": "^1.1.6",
    "@radix-ui/react-radio-group": "^1.3.6",
    "@radix-ui/react-scroll-area": "^1.2.8",
    "@radix-ui/react-select": "^2.2.4",
    "@radix-ui/react-separator": "^1.1.6",
    "@radix-ui/react-slider": "^1.3.4",
    "@radix-ui/react-slot": "^1.2.2",
    "@radix-ui/react-switch": "^1.2.4",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toggle": "^1.1.8",
    "@radix-ui/react-toggle-group": "^1.1.9",
    "@radix-ui/react-tooltip": "^1.2.6",
    "@reduxjs/toolkit": "^2.8.1",
    "@tailwindcss/vite": "^4.1.6",
    "@tanstack/react-query": "^5.76.0",
    "@types/pdfmake": "^0.2.11",
    "axios": "^1.9.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "country-data-list": "^1.4.1",
    "date-fns": "^4.1.0",
    "embla-carousel-react": "^8.6.0",
    "formik": "^2.4.6",
    "lucide-react": "^0.510.0",
    "next-themes": "^0.4.6",
    "pdfmake": "^0.2.20",
    "react": "^19.1.0",
    "react-circle-flags": "^0.0.23",
    "react-day-picker": "^9.6.7",
    "react-dom": "^19.1.0",
    "react-hook-form": "^7.56.3",
    "react-icons": "^5.5.0",
    "react-international-phone": "^4.5.0",
    "react-otp-input": "^3.1.1",
    "react-phone-input-2": "^2.15.1",
    "react-redux": "^9.2.0",
    "react-resizable-panels": "^3.0.1",
    "react-router-dom": "^7.6.0",
    "recharts": "^2.15.3",
    "sonner": "^2.0.3",
    "tailwind-merge": "^3.3.0",
    "tailwindcss": "^4.1.6",
    "xlsx": "^0.18.5",
    "yup": "^1.6.1",
    "zod": "^3.24.4"
  },
  "devDependencies": {
    "@eslint/js": "^9.25.0",
    "@testing-library/jest-dom": "^6.6.3",
    "@testing-library/react": "^16.3.0",
    "@testing-library/user-event": "^14.6.1",
    "@types/node": "^22.15.17",
    "@types/react": "^19.1.2",
    "@types/react-dom": "^19.1.2",
    "@vitejs/plugin-react": "^4.4.1",
    "@vitest/coverage-v8": "^3.2.3",
    "eslint": "^9.25.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.19",
    "globals": "^16.0.0",
    "happy-dom": "^17.6.3",
    "tw-animate-css": "^1.2.9",
    "typescript": "~5.8.3",
    "typescript-eslint": "^8.30.1",
    "vite": "^6.3.5",
    "vitest": "^3.2.3"
  }
}
</file>

<file path="README.md">
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default tseslint.config({
  extends: [
    // Remove ...tseslint.configs.recommended and replace with this
    ...tseslint.configs.recommendedTypeChecked,
    // Alternatively, use this for stricter rules
    ...tseslint.configs.strictTypeChecked,
    // Optionally, add this for stylistic rules
    ...tseslint.configs.stylisticTypeChecked,
  ],
  languageOptions: {
    // other options...
    parserOptions: {
      project: ['./tsconfig.node.json', './tsconfig.app.json'],
      tsconfigRootDir: import.meta.dirname,
    },
  },
})
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default tseslint.config({
  plugins: {
    // Add the react-x and react-dom plugins
    'react-x': reactX,
    'react-dom': reactDom,
  },
  rules: {
    // other rules...
    // Enable its recommended typescript rules
    ...reactX.configs['recommended-typescript'].rules,
    ...reactDom.configs.recommended.rules,
  },
})
```
</file>

<file path="tsconfig.app.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"],
  "baseUrl": ".",
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
}
</file>

<file path="tsconfig.json">
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ],
   "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
</file>

<file path="tsconfig.node.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="vite.config.ts">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import tailwindcss from '@tailwindcss/vite'
import path from 'path'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react(), tailwindcss()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src'),
    },
  },
})
</file>

<file path="vitest.config.ts">
import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    globals: true,
    environment: 'node',
  },
})
</file>

</files>
